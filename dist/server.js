/*!
 * Copyright (c) 2025 Augment
 * Proprietary and Confidential
 * Licensed for use only with Vim plugin - See LICENSE.md
 * Modification or reverse engineering prohibited
 */
"use strict";var eN=Object.create;var dc=Object.defineProperty;var tN=Object.getOwnPropertyDescriptor;var nN=Object.getOwnPropertyNames;var rN=Object.getPrototypeOf,iN=Object.prototype.hasOwnProperty;var F=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),oN=(e,t)=>{for(var n in t)dc(e,n,{get:t[n],enumerable:!0})},a_=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of nN(t))!iN.call(e,o)&&o!==n&&dc(e,o,{get:()=>t[o],enumerable:!(i=tN(t,o))||i.enumerable});return e};var kt=(e,t,n)=>(n=e!=null?eN(rN(e)):{},a_(t||!e||!e.__esModule?dc(n,"default",{value:e,enumerable:!0}):n,e)),sN=e=>a_(dc({},"__esModule",{value:!0}),e);var gc=F(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.thenable=It.typedArray=It.stringArray=It.array=It.func=It.error=It.number=It.string=It.boolean=void 0;function cN(e){return e===!0||e===!1}It.boolean=cN;function d_(e){return typeof e=="string"||e instanceof String}It.string=d_;function uN(e){return typeof e=="number"||e instanceof Number}It.number=uN;function lN(e){return e instanceof Error}It.error=lN;function f_(e){return typeof e=="function"}It.func=f_;function h_(e){return Array.isArray(e)}It.array=h_;function dN(e){return h_(e)&&e.every(t=>d_(t))}It.stringArray=dN;function fN(e,t){return Array.isArray(e)&&e.every(t)}It.typedArray=fN;function hN(e){return e&&f_(e.then)}It.thenable=hN});var oo=F(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.stringArray=Qt.array=Qt.func=Qt.error=Qt.number=Qt.string=Qt.boolean=void 0;function gN(e){return e===!0||e===!1}Qt.boolean=gN;function g_(e){return typeof e=="string"||e instanceof String}Qt.string=g_;function pN(e){return typeof e=="number"||e instanceof Number}Qt.number=pN;function mN(e){return e instanceof Error}Qt.error=mN;function bN(e){return typeof e=="function"}Qt.func=bN;function p_(e){return Array.isArray(e)}Qt.array=p_;function _N(e){return p_(e)&&e.every(t=>g_(t))}Qt.stringArray=_N});var Df=F(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.Message=ue.NotificationType9=ue.NotificationType8=ue.NotificationType7=ue.NotificationType6=ue.NotificationType5=ue.NotificationType4=ue.NotificationType3=ue.NotificationType2=ue.NotificationType1=ue.NotificationType0=ue.NotificationType=ue.RequestType9=ue.RequestType8=ue.RequestType7=ue.RequestType6=ue.RequestType5=ue.RequestType4=ue.RequestType3=ue.RequestType2=ue.RequestType1=ue.RequestType=ue.RequestType0=ue.AbstractMessageSignature=ue.ParameterStructures=ue.ResponseError=ue.ErrorCodes=void 0;var Ii=oo(),of;(function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3})(of||(ue.ErrorCodes=of={}));var sf=class e extends Error{constructor(t,n,i){super(n),this.code=Ii.number(t)?t:of.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,e.prototype)}toJson(){let t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),t}};ue.ResponseError=sf;var fn=class e{constructor(t){this.kind=t}static is(t){return t===e.auto||t===e.byName||t===e.byPosition}toString(){return this.kind}};ue.ParameterStructures=fn;fn.auto=new fn("auto");fn.byPosition=new fn("byPosition");fn.byName=new fn("byName");var ut=class{constructor(t,n){this.method=t,this.numberOfParams=n}get parameterStructures(){return fn.auto}};ue.AbstractMessageSignature=ut;var af=class extends ut{constructor(t){super(t,0)}};ue.RequestType0=af;var cf=class extends ut{constructor(t,n=fn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.RequestType=cf;var uf=class extends ut{constructor(t,n=fn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.RequestType1=uf;var lf=class extends ut{constructor(t){super(t,2)}};ue.RequestType2=lf;var df=class extends ut{constructor(t){super(t,3)}};ue.RequestType3=df;var ff=class extends ut{constructor(t){super(t,4)}};ue.RequestType4=ff;var hf=class extends ut{constructor(t){super(t,5)}};ue.RequestType5=hf;var gf=class extends ut{constructor(t){super(t,6)}};ue.RequestType6=gf;var pf=class extends ut{constructor(t){super(t,7)}};ue.RequestType7=pf;var mf=class extends ut{constructor(t){super(t,8)}};ue.RequestType8=mf;var bf=class extends ut{constructor(t){super(t,9)}};ue.RequestType9=bf;var _f=class extends ut{constructor(t,n=fn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.NotificationType=_f;var vf=class extends ut{constructor(t){super(t,0)}};ue.NotificationType0=vf;var yf=class extends ut{constructor(t,n=fn.auto){super(t,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.NotificationType1=yf;var xf=class extends ut{constructor(t){super(t,2)}};ue.NotificationType2=xf;var wf=class extends ut{constructor(t){super(t,3)}};ue.NotificationType3=wf;var Pf=class extends ut{constructor(t){super(t,4)}};ue.NotificationType4=Pf;var Sf=class extends ut{constructor(t){super(t,5)}};ue.NotificationType5=Sf;var Cf=class extends ut{constructor(t){super(t,6)}};ue.NotificationType6=Cf;var kf=class extends ut{constructor(t){super(t,7)}};ue.NotificationType7=kf;var Rf=class extends ut{constructor(t){super(t,8)}};ue.NotificationType8=Rf;var Tf=class extends ut{constructor(t){super(t,9)}};ue.NotificationType9=Tf;var m_;(function(e){function t(o){let c=o;return c&&Ii.string(c.method)&&(Ii.string(c.id)||Ii.number(c.id))}e.isRequest=t;function n(o){let c=o;return c&&Ii.string(c.method)&&o.id===void 0}e.isNotification=n;function i(o){let c=o;return c&&(c.result!==void 0||!!c.error)&&(Ii.string(c.id)||Ii.number(c.id)||c.id===null)}e.isResponse=i})(m_||(ue.Message=m_={}))});var If=F(ti=>{"use strict";var b_;Object.defineProperty(ti,"__esModule",{value:!0});ti.LRUCache=ti.LinkedMap=ti.Touch=void 0;var Jt;(function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last})(Jt||(ti.Touch=Jt={}));var pc=class{constructor(){this[b_]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(t){return this._map.has(t)}get(t,n=Jt.None){let i=this._map.get(t);if(i)return n!==Jt.None&&this.touch(i,n),i.value}set(t,n,i=Jt.None){let o=this._map.get(t);if(o)o.value=n,i!==Jt.None&&this.touch(o,i);else{switch(o={key:t,value:n,next:void 0,previous:void 0},i){case Jt.None:this.addItemLast(o);break;case Jt.First:this.addItemFirst(o);break;case Jt.Last:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(t,o),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){let n=this._map.get(t);if(n)return this._map.delete(t),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,n){let i=this._state,o=this._head;for(;o;){if(n?t.bind(n)(o.value,o.key,this):t(o.value,o.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let t=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let t=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let t=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(b_=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let n=this._head,i=this.size;for(;n&&i>t;)this._map.delete(n.key),n=n.next,i--;this._head=n,this._size=i,n&&(n.previous=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{let n=t.next,i=t.previous;if(!n||!i)throw new Error("Invalid list");n.previous=i,i.next=n}t.next=void 0,t.previous=void 0,this._state++}touch(t,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Jt.First&&n!==Jt.Last)){if(n===Jt.First){if(t===this._head)return;let i=t.next,o=t.previous;t===this._tail?(o.next=void 0,this._tail=o):(i.previous=o,o.next=i),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(n===Jt.Last){if(t===this._tail)return;let i=t.next,o=t.previous;t===this._head?(i.previous=void 0,this._head=i):(i.previous=o,o.next=i),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){let t=[];return this.forEach((n,i)=>{t.push([i,n])}),t}fromJSON(t){this.clear();for(let[n,i]of t)this.set(n,i)}};ti.LinkedMap=pc;var Ef=class extends pc{constructor(t,n=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,n=Jt.AsNew){return super.get(t,n)}peek(t){return super.get(t,Jt.None)}set(t,n){return super.set(t,n,Jt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};ti.LRUCache=Ef});var v_=F(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.Disposable=void 0;var __;(function(e){function t(n){return{dispose:n}}e.create=t})(__||(mc.Disposable=__={}))});var ni=F(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});var Ff;function Af(){if(Ff===void 0)throw new Error("No runtime abstraction layer installed");return Ff}(function(e){function t(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");Ff=n}e.install=t})(Af||(Af={}));Mf.default=Af});var ao=F(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});so.Emitter=so.Event=void 0;var vN=ni(),y_;(function(e){let t={dispose(){}};e.None=function(){return t}})(y_||(so.Event=y_={}));var Nf=class{add(t,n=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(t),this._contexts.push(n),Array.isArray(i)&&i.push({dispose:()=>this.remove(t,n)})}remove(t,n=null){if(!this._callbacks)return;let i=!1;for(let o=0,c=this._callbacks.length;o<c;o++)if(this._callbacks[o]===t)if(this._contexts[o]===n){this._callbacks.splice(o,1),this._contexts.splice(o,1);return}else i=!0;if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...t){if(!this._callbacks)return[];let n=[],i=this._callbacks.slice(0),o=this._contexts.slice(0);for(let c=0,u=i.length;c<u;c++)try{n.push(i[c].apply(o[c],t))}catch(f){(0,vN.default)().console.error(f)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},bc=class e{constructor(t){this._options=t}get event(){return this._event||(this._event=(t,n,i)=>{this._callbacks||(this._callbacks=new Nf),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(t,n);let o={dispose:()=>{this._callbacks&&(this._callbacks.remove(t,n),o.dispose=e._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(o),o}),this._event}fire(t){this._callbacks&&this._callbacks.invoke.call(this._callbacks,t)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};so.Emitter=bc;bc._noop=function(){}});var yc=F(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.CancellationTokenSource=co.CancellationToken=void 0;var yN=ni(),xN=oo(),qf=ao(),_c;(function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:qf.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:qf.Event.None});function t(n){let i=n;return i&&(i===e.None||i===e.Cancelled||xN.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}e.is=t})(_c||(co.CancellationToken=_c={}));var wN=Object.freeze(function(e,t){let n=(0,yN.default)().timer.setTimeout(e.bind(t),0);return{dispose(){n.dispose()}}}),vc=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?wN:(this._emitter||(this._emitter=new qf.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Lf=class{get token(){return this._token||(this._token=new vc),this._token}cancel(){this._token?this._token.cancel():this._token=_c.Cancelled}dispose(){this._token?this._token instanceof vc&&this._token.dispose():this._token=_c.None}};co.CancellationTokenSource=Lf});var x_=F(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.SharedArrayReceiverStrategy=uo.SharedArraySenderStrategy=void 0;var PN=yc(),ys;(function(e){e.Continue=0,e.Cancelled=1})(ys||(ys={}));var Of=class{constructor(){this.buffers=new Map}enableCancellation(t){if(t.id===null)return;let n=new SharedArrayBuffer(4),i=new Int32Array(n,0,1);i[0]=ys.Continue,this.buffers.set(t.id,n),t.$cancellationData=n}async sendCancellation(t,n){let i=this.buffers.get(n);if(i===void 0)return;let o=new Int32Array(i,0,1);Atomics.store(o,0,ys.Cancelled)}cleanup(t){this.buffers.delete(t)}dispose(){this.buffers.clear()}};uo.SharedArraySenderStrategy=Of;var Bf=class{constructor(t){this.data=new Int32Array(t,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===ys.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Uf=class{constructor(t){this.token=new Bf(t)}cancel(){}dispose(){}},$f=class{constructor(){this.kind="request"}createCancellationTokenSource(t){let n=t.$cancellationData;return n===void 0?new PN.CancellationTokenSource:new Uf(n)}};uo.SharedArrayReceiverStrategy=$f});var jf=F(xc=>{"use strict";Object.defineProperty(xc,"__esModule",{value:!0});xc.Semaphore=void 0;var SN=ni(),Wf=class{constructor(t=1){if(t<=0)throw new Error("Capacity must be greater than 0");this._capacity=t,this._active=0,this._waiting=[]}lock(t){return new Promise((n,i)=>{this._waiting.push({thunk:t,resolve:n,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,SN.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let t=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=t.thunk();n instanceof Promise?n.then(i=>{this._active--,t.resolve(i),this.runNext()},i=>{this._active--,t.reject(i),this.runNext()}):(this._active--,t.resolve(n),this.runNext())}catch(n){this._active--,t.reject(n),this.runNext()}}};xc.Semaphore=Wf});var P_=F(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.ReadableStreamMessageReader=ri.AbstractMessageReader=ri.MessageReader=void 0;var Hf=ni(),lo=oo(),zf=ao(),CN=jf(),w_;(function(e){function t(n){let i=n;return i&&lo.func(i.listen)&&lo.func(i.dispose)&&lo.func(i.onError)&&lo.func(i.onClose)&&lo.func(i.onPartialMessage)}e.is=t})(w_||(ri.MessageReader=w_={}));var wc=class{constructor(){this.errorEmitter=new zf.Emitter,this.closeEmitter=new zf.Emitter,this.partialMessageEmitter=new zf.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t){this.errorEmitter.fire(this.asError(t))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(t){this.partialMessageEmitter.fire(t)}asError(t){return t instanceof Error?t:new Error(`Reader received error. Reason: ${lo.string(t.message)?t.message:"unknown"}`)}};ri.AbstractMessageReader=wc;var Vf;(function(e){function t(n){let i,o,c,u=new Map,f,g=new Map;if(n===void 0||typeof n=="string")i=n??"utf-8";else{if(i=n.charset??"utf-8",n.contentDecoder!==void 0&&(c=n.contentDecoder,u.set(c.name,c)),n.contentDecoders!==void 0)for(let b of n.contentDecoders)u.set(b.name,b);if(n.contentTypeDecoder!==void 0&&(f=n.contentTypeDecoder,g.set(f.name,f)),n.contentTypeDecoders!==void 0)for(let b of n.contentTypeDecoders)g.set(b.name,b)}return f===void 0&&(f=(0,Hf.default)().applicationJson.decoder,g.set(f.name,f)),{charset:i,contentDecoder:c,contentDecoders:u,contentTypeDecoder:f,contentTypeDecoders:g}}e.fromOptions=t})(Vf||(Vf={}));var Gf=class extends wc{constructor(t,n){super(),this.readable=t,this.options=Vf.fromOptions(n),this.buffer=(0,Hf.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new CN.Semaphore(1)}set partialMessageTimeout(t){this._partialMessageTimeout=t}get partialMessageTimeout(){return this._partialMessageTimeout}listen(t){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=t;let n=this.readable.onData(i=>{this.onData(i)});return this.readable.onError(i=>this.fireError(i)),this.readable.onClose(()=>this.fireClose()),n}onData(t){try{for(this.buffer.append(t);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders(!0);if(!i)return;let o=i.get("content-length");if(!o){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(i))}`));return}let c=parseInt(o);if(isNaN(c)){this.fireError(new Error(`Content-Length value must be a number. Got ${o}`));return}this.nextMessageLength=c}let n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let i=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,o=await this.options.contentTypeDecoder.decode(i,this.options);this.callback(o)}).catch(i=>{this.fireError(i)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Hf.default)().timer.setTimeout((t,n)=>{this.partialMessageTimer=void 0,t===this.messageToken&&(this.firePartialMessage({messageToken:t,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};ri.ReadableStreamMessageReader=Gf});var T_=F(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.WriteableStreamMessageWriter=ii.AbstractMessageWriter=ii.MessageWriter=void 0;var S_=ni(),xs=oo(),kN=jf(),C_=ao(),RN="Content-Length: ",k_=`\r
`,R_;(function(e){function t(n){let i=n;return i&&xs.func(i.dispose)&&xs.func(i.onClose)&&xs.func(i.onError)&&xs.func(i.write)}e.is=t})(R_||(ii.MessageWriter=R_={}));var Pc=class{constructor(){this.errorEmitter=new C_.Emitter,this.closeEmitter=new C_.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t,n,i){this.errorEmitter.fire([this.asError(t),n,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(t){return t instanceof Error?t:new Error(`Writer received error. Reason: ${xs.string(t.message)?t.message:"unknown"}`)}};ii.AbstractMessageWriter=Pc;var Qf;(function(e){function t(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,S_.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,S_.default)().applicationJson.encoder}}e.fromOptions=t})(Qf||(Qf={}));var Jf=class extends Pc{constructor(t,n){super(),this.writable=t,this.options=Qf.fromOptions(n),this.errorCount=0,this.writeSemaphore=new kN.Semaphore(1),this.writable.onError(i=>this.fireError(i)),this.writable.onClose(()=>this.fireClose())}async write(t){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(t,this.options).then(i=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(i):i).then(i=>{let o=[];return o.push(RN,i.byteLength.toString(),k_),o.push(k_),this.doWrite(t,o,i)},i=>{throw this.fireError(i),i}))}async doWrite(t,n,i){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(i)}catch(o){return this.handleError(o,t),Promise.reject(o)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){this.writable.end()}};ii.WriteableStreamMessageWriter=Jf});var D_=F(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.AbstractMessageBuffer=void 0;var TN=13,DN=10,EN=`\r
`,Xf=class{constructor(t="utf-8"){this._encoding=t,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(t){let n=typeof t=="string"?this.fromString(t,this._encoding):t;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(t=!1){if(this._chunks.length===0)return;let n=0,i=0,o=0,c=0;e:for(;i<this._chunks.length;){let b=this._chunks[i];for(o=0;o<b.length;){switch(b[o]){case TN:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case DN:switch(n){case 1:n=2;break;case 3:n=4,o++;break e;default:n=0}break;default:n=0}o++}c+=b.byteLength,i++}if(n!==4)return;let u=this._read(c+o),f=new Map,g=this.toString(u,"ascii").split(EN);if(g.length<2)return f;for(let b=0;b<g.length-2;b++){let x=g[b],k=x.indexOf(":");if(k===-1)throw new Error(`Message header must separate key and value using ':'
${x}`);let I=x.substr(0,k),M=x.substr(k+1).trim();f.set(t?I.toLowerCase():I,M)}return f}tryReadBody(t){if(!(this._totalLength<t))return this._read(t)}get numberOfBytes(){return this._totalLength}_read(t){if(t===0)return this.emptyBuffer();if(t>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===t){let c=this._chunks[0];return this._chunks.shift(),this._totalLength-=t,this.asNative(c)}if(this._chunks[0].byteLength>t){let c=this._chunks[0],u=this.asNative(c,t);return this._chunks[0]=c.slice(t),this._totalLength-=t,u}let n=this.allocNative(t),i=0,o=0;for(;t>0;){let c=this._chunks[o];if(c.byteLength>t){let u=c.slice(0,t);n.set(u,i),i+=t,this._chunks[o]=c.slice(t),this._totalLength-=t,t-=t}else n.set(c,i),i+=c.byteLength,this._chunks.shift(),this._totalLength-=c.byteLength,t-=c.byteLength}return n}};Sc.AbstractMessageBuffer=Xf});var M_=F(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.createMessageConnection=Pe.ConnectionOptions=Pe.MessageStrategy=Pe.CancellationStrategy=Pe.CancellationSenderStrategy=Pe.CancellationReceiverStrategy=Pe.RequestCancellationReceiverStrategy=Pe.IdCancellationReceiverStrategy=Pe.ConnectionStrategy=Pe.ConnectionError=Pe.ConnectionErrors=Pe.LogTraceNotification=Pe.SetTraceNotification=Pe.TraceFormat=Pe.TraceValues=Pe.Trace=Pe.NullLogger=Pe.ProgressType=Pe.ProgressToken=void 0;var E_=ni(),vt=oo(),he=Df(),I_=If(),ws=ao(),Kf=yc(),Cs;(function(e){e.type=new he.NotificationType("$/cancelRequest")})(Cs||(Cs={}));var Yf;(function(e){function t(n){return typeof n=="string"||typeof n=="number"}e.is=t})(Yf||(Pe.ProgressToken=Yf={}));var Ps;(function(e){e.type=new he.NotificationType("$/progress")})(Ps||(Ps={}));var Zf=class{constructor(){}};Pe.ProgressType=Zf;var eh;(function(e){function t(n){return vt.func(n)}e.is=t})(eh||(eh={}));Pe.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Ve;(function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"})(Ve||(Pe.Trace=Ve={}));var F_;(function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"})(F_||(Pe.TraceValues=F_={}));(function(e){function t(i){if(!vt.string(i))return e.Off;switch(i=i.toLowerCase(),i){case"off":return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose;default:return e.Off}}e.fromString=t;function n(i){switch(i){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}e.toString=n})(Ve||(Pe.Trace=Ve={}));var Rn;(function(e){e.Text="text",e.JSON="json"})(Rn||(Pe.TraceFormat=Rn={}));(function(e){function t(n){return vt.string(n)?(n=n.toLowerCase(),n==="json"?e.JSON:e.Text):e.Text}e.fromString=t})(Rn||(Pe.TraceFormat=Rn={}));var th;(function(e){e.type=new he.NotificationType("$/setTrace")})(th||(Pe.SetTraceNotification=th={}));var Cc;(function(e){e.type=new he.NotificationType("$/logTrace")})(Cc||(Pe.LogTraceNotification=Cc={}));var Ss;(function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"})(Ss||(Pe.ConnectionErrors=Ss={}));var fo=class e extends Error{constructor(t,n){super(n),this.code=t,Object.setPrototypeOf(this,e.prototype)}};Pe.ConnectionError=fo;var nh;(function(e){function t(n){let i=n;return i&&vt.func(i.cancelUndispatched)}e.is=t})(nh||(Pe.ConnectionStrategy=nh={}));var kc;(function(e){function t(n){let i=n;return i&&(i.kind===void 0||i.kind==="id")&&vt.func(i.createCancellationTokenSource)&&(i.dispose===void 0||vt.func(i.dispose))}e.is=t})(kc||(Pe.IdCancellationReceiverStrategy=kc={}));var rh;(function(e){function t(n){let i=n;return i&&i.kind==="request"&&vt.func(i.createCancellationTokenSource)&&(i.dispose===void 0||vt.func(i.dispose))}e.is=t})(rh||(Pe.RequestCancellationReceiverStrategy=rh={}));var Rc;(function(e){e.Message=Object.freeze({createCancellationTokenSource(n){return new Kf.CancellationTokenSource}});function t(n){return kc.is(n)||rh.is(n)}e.is=t})(Rc||(Pe.CancellationReceiverStrategy=Rc={}));var Tc;(function(e){e.Message=Object.freeze({sendCancellation(n,i){return n.sendNotification(Cs.type,{id:i})},cleanup(n){}});function t(n){let i=n;return i&&vt.func(i.sendCancellation)&&vt.func(i.cleanup)}e.is=t})(Tc||(Pe.CancellationSenderStrategy=Tc={}));var Dc;(function(e){e.Message=Object.freeze({receiver:Rc.Message,sender:Tc.Message});function t(n){let i=n;return i&&Rc.is(i.receiver)&&Tc.is(i.sender)}e.is=t})(Dc||(Pe.CancellationStrategy=Dc={}));var Ec;(function(e){function t(n){let i=n;return i&&vt.func(i.handleMessage)}e.is=t})(Ec||(Pe.MessageStrategy=Ec={}));var A_;(function(e){function t(n){let i=n;return i&&(Dc.is(i.cancellationStrategy)||nh.is(i.connectionStrategy)||Ec.is(i.messageStrategy))}e.is=t})(A_||(Pe.ConnectionOptions=A_={}));var Zn;(function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"})(Zn||(Zn={}));function IN(e,t,n,i){let o=n!==void 0?n:Pe.NullLogger,c=0,u=0,f=0,g="2.0",b,x=new Map,k,I=new Map,M=new Map,N,B=new I_.LinkedMap,W=new Map,X=new Set,D=new Map,P=Ve.Off,U=Rn.Text,ne,_e=Zn.New,Ue=new ws.Emitter,Ke=new ws.Emitter,Dt=new ws.Emitter,xe=new ws.Emitter,Y=new ws.Emitter,H=i&&i.cancellationStrategy?i.cancellationStrategy:Dc.Message;function ae(S){if(S===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+S.toString()}function ie(S){return S===null?"res-unknown-"+(++f).toString():"res-"+S.toString()}function ke(){return"not-"+(++u).toString()}function ge(S,V){he.Message.isRequest(V)?S.set(ae(V.id),V):he.Message.isResponse(V)?S.set(ie(V.id),V):S.set(ke(),V)}function pe(S){}function wt(){return _e===Zn.Listening}function je(){return _e===Zn.Closed}function ze(){return _e===Zn.Disposed}function bn(){(_e===Zn.New||_e===Zn.Listening)&&(_e=Zn.Closed,Ke.fire(void 0))}function xr(S){Ue.fire([S,void 0,void 0])}function Vn(S){Ue.fire(S)}e.onClose(bn),e.onError(xr),t.onClose(bn),t.onError(Vn);function ur(){N||B.size===0||(N=(0,E_.default)().timer.setImmediate(()=>{N=void 0,lr()}))}function vi(S){he.Message.isRequest(S)?$i(S):he.Message.isNotification(S)?Pr(S):he.Message.isResponse(S)?wr(S):Sr(S)}function lr(){if(B.size===0)return;let S=B.shift();try{let V=i?.messageStrategy;Ec.is(V)?V.handleMessage(S,vi):vi(S)}finally{ur()}}let dr=S=>{try{if(he.Message.isNotification(S)&&S.method===Cs.type.method){let V=S.params.id,ee=ae(V),oe=B.get(ee);if(he.Message.isRequest(oe)){let Be=i?.connectionStrategy,Qe=Be&&Be.cancelUndispatched?Be.cancelUndispatched(oe,pe):void 0;if(Qe&&(Qe.error!==void 0||Qe.result!==void 0)){B.delete(ee),D.delete(V),Qe.id=oe.id,Ut(Qe,S.method,Date.now()),t.write(Qe).catch(()=>o.error("Sending response for canceled message failed."));return}}let $e=D.get(V);if($e!==void 0){$e.cancel(),jr(S);return}else X.add(V)}ge(B,S)}finally{ur()}};function $i(S){if(ze())return;function V(Re,Je,qe){let at={jsonrpc:g,id:S.id};Re instanceof he.ResponseError?at.error=Re.toJson():at.result=Re===void 0?null:Re,Ut(at,Je,qe),t.write(at).catch(()=>o.error("Sending response failed."))}function ee(Re,Je,qe){let at={jsonrpc:g,id:S.id,error:Re.toJson()};Ut(at,Je,qe),t.write(at).catch(()=>o.error("Sending response failed."))}function oe(Re,Je,qe){Re===void 0&&(Re=null);let at={jsonrpc:g,id:S.id,result:Re};Ut(at,Je,qe),t.write(at).catch(()=>o.error("Sending response failed."))}yi(S);let $e=x.get(S.method),Be,Qe;$e&&(Be=$e.type,Qe=$e.handler);let nt=Date.now();if(Qe||b){let Re=S.id??String(Date.now()),Je=kc.is(H.receiver)?H.receiver.createCancellationTokenSource(Re):H.receiver.createCancellationTokenSource(S);S.id!==null&&X.has(S.id)&&Je.cancel(),S.id!==null&&D.set(Re,Je);try{let qe;if(Qe)if(S.params===void 0){if(Be!==void 0&&Be.numberOfParams!==0){ee(new he.ResponseError(he.ErrorCodes.InvalidParams,`Request ${S.method} defines ${Be.numberOfParams} params but received none.`),S.method,nt);return}qe=Qe(Je.token)}else if(Array.isArray(S.params)){if(Be!==void 0&&Be.parameterStructures===he.ParameterStructures.byName){ee(new he.ResponseError(he.ErrorCodes.InvalidParams,`Request ${S.method} defines parameters by name but received parameters by position`),S.method,nt);return}qe=Qe(...S.params,Je.token)}else{if(Be!==void 0&&Be.parameterStructures===he.ParameterStructures.byPosition){ee(new he.ResponseError(he.ErrorCodes.InvalidParams,`Request ${S.method} defines parameters by position but received parameters by name`),S.method,nt);return}qe=Qe(S.params,Je.token)}else b&&(qe=b(S.method,S.params,Je.token));let at=qe;qe?at.then?at.then(Et=>{D.delete(Re),V(Et,S.method,nt)},Et=>{D.delete(Re),Et instanceof he.ResponseError?ee(Et,S.method,nt):Et&&vt.string(Et.message)?ee(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed with message: ${Et.message}`),S.method,nt):ee(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed unexpectedly without providing any details.`),S.method,nt)}):(D.delete(Re),V(qe,S.method,nt)):(D.delete(Re),oe(qe,S.method,nt))}catch(qe){D.delete(Re),qe instanceof he.ResponseError?V(qe,S.method,nt):qe&&vt.string(qe.message)?ee(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed with message: ${qe.message}`),S.method,nt):ee(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed unexpectedly without providing any details.`),S.method,nt)}}else ee(new he.ResponseError(he.ErrorCodes.MethodNotFound,`Unhandled method ${S.method}`),S.method,nt)}function wr(S){if(!ze())if(S.id===null)S.error?o.error(`Received response message without id: Error is: 
${JSON.stringify(S.error,void 0,4)}`):o.error("Received response message without id. No further error information provided.");else{let V=S.id,ee=W.get(V);if(hr(S,ee),ee!==void 0){W.delete(V);try{if(S.error){let oe=S.error;ee.reject(new he.ResponseError(oe.code,oe.message,oe.data))}else if(S.result!==void 0)ee.resolve(S.result);else throw new Error("Should never happen.")}catch(oe){oe.message?o.error(`Response handler '${ee.method}' failed with message: ${oe.message}`):o.error(`Response handler '${ee.method}' failed unexpectedly.`)}}}}function Pr(S){if(ze())return;let V,ee;if(S.method===Cs.type.method){let oe=S.params.id;X.delete(oe),jr(S);return}else{let oe=I.get(S.method);oe&&(ee=oe.handler,V=oe.type)}if(ee||k)try{if(jr(S),ee)if(S.params===void 0)V!==void 0&&V.numberOfParams!==0&&V.parameterStructures!==he.ParameterStructures.byName&&o.error(`Notification ${S.method} defines ${V.numberOfParams} params but received none.`),ee();else if(Array.isArray(S.params)){let oe=S.params;S.method===Ps.type.method&&oe.length===2&&Yf.is(oe[0])?ee({token:oe[0],value:oe[1]}):(V!==void 0&&(V.parameterStructures===he.ParameterStructures.byName&&o.error(`Notification ${S.method} defines parameters by name but received parameters by position`),V.numberOfParams!==S.params.length&&o.error(`Notification ${S.method} defines ${V.numberOfParams} params but received ${oe.length} arguments`)),ee(...oe))}else V!==void 0&&V.parameterStructures===he.ParameterStructures.byPosition&&o.error(`Notification ${S.method} defines parameters by position but received parameters by name`),ee(S.params);else k&&k(S.method,S.params)}catch(oe){oe.message?o.error(`Notification handler '${S.method}' failed with message: ${oe.message}`):o.error(`Notification handler '${S.method}' failed unexpectedly.`)}else Dt.fire(S)}function Sr(S){if(!S){o.error("Received empty message.");return}o.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(S,null,4)}`);let V=S;if(vt.string(V.id)||vt.number(V.id)){let ee=V.id,oe=W.get(ee);oe&&oe.reject(new Error("The received response has neither a result nor an error property."))}}function bt(S){if(S!=null)switch(P){case Ve.Verbose:return JSON.stringify(S,null,4);case Ve.Compact:return JSON.stringify(S);default:return}}function fr(S){if(!(P===Ve.Off||!ne))if(U===Rn.Text){let V;(P===Ve.Verbose||P===Ve.Compact)&&S.params&&(V=`Params: ${bt(S.params)}

`),ne.log(`Sending request '${S.method} - (${S.id})'.`,V)}else Pt("send-request",S)}function Wi(S){if(!(P===Ve.Off||!ne))if(U===Rn.Text){let V;(P===Ve.Verbose||P===Ve.Compact)&&(S.params?V=`Params: ${bt(S.params)}

`:V=`No parameters provided.

`),ne.log(`Sending notification '${S.method}'.`,V)}else Pt("send-notification",S)}function Ut(S,V,ee){if(!(P===Ve.Off||!ne))if(U===Rn.Text){let oe;(P===Ve.Verbose||P===Ve.Compact)&&(S.error&&S.error.data?oe=`Error data: ${bt(S.error.data)}

`:S.result?oe=`Result: ${bt(S.result)}

`:S.error===void 0&&(oe=`No result returned.

`)),ne.log(`Sending response '${V} - (${S.id})'. Processing request took ${Date.now()-ee}ms`,oe)}else Pt("send-response",S)}function yi(S){if(!(P===Ve.Off||!ne))if(U===Rn.Text){let V;(P===Ve.Verbose||P===Ve.Compact)&&S.params&&(V=`Params: ${bt(S.params)}

`),ne.log(`Received request '${S.method} - (${S.id})'.`,V)}else Pt("receive-request",S)}function jr(S){if(!(P===Ve.Off||!ne||S.method===Cc.type.method))if(U===Rn.Text){let V;(P===Ve.Verbose||P===Ve.Compact)&&(S.params?V=`Params: ${bt(S.params)}

`:V=`No parameters provided.

`),ne.log(`Received notification '${S.method}'.`,V)}else Pt("receive-notification",S)}function hr(S,V){if(!(P===Ve.Off||!ne))if(U===Rn.Text){let ee;if((P===Ve.Verbose||P===Ve.Compact)&&(S.error&&S.error.data?ee=`Error data: ${bt(S.error.data)}

`:S.result?ee=`Result: ${bt(S.result)}

`:S.error===void 0&&(ee=`No result returned.

`)),V){let oe=S.error?` Request failed: ${S.error.message} (${S.error.code}).`:"";ne.log(`Received response '${V.method} - (${S.id})' in ${Date.now()-V.timerStart}ms.${oe}`,ee)}else ne.log(`Received response ${S.id} without active response promise.`,ee)}else Pt("receive-response",S)}function Pt(S,V){if(!ne||P===Ve.Off)return;let ee={isLSPMessage:!0,type:S,message:V,timestamp:Date.now()};ne.log(ee)}function sn(){if(je())throw new fo(Ss.Closed,"Connection is closed.");if(ze())throw new fo(Ss.Disposed,"Connection is disposed.")}function Cr(){if(wt())throw new fo(Ss.AlreadyListening,"Connection is already listening")}function ji(){if(!wt())throw new Error("Call listen() first.")}function Ht(S){return S===void 0?null:S}function xi(S){if(S!==null)return S}function Gn(S){return S!=null&&!Array.isArray(S)&&typeof S=="object"}function _n(S,V){switch(S){case he.ParameterStructures.auto:return Gn(V)?xi(V):[Ht(V)];case he.ParameterStructures.byName:if(!Gn(V))throw new Error("Received parameters by name but param is not an object literal.");return xi(V);case he.ParameterStructures.byPosition:return[Ht(V)];default:throw new Error(`Unknown parameter structure ${S.toString()}`)}}function kr(S,V){let ee,oe=S.numberOfParams;switch(oe){case 0:ee=void 0;break;case 1:ee=_n(S.parameterStructures,V[0]);break;default:ee=[];for(let $e=0;$e<V.length&&$e<oe;$e++)ee.push(Ht(V[$e]));if(V.length<oe)for(let $e=V.length;$e<oe;$e++)ee.push(null);break}return ee}let vn={sendNotification:(S,...V)=>{sn();let ee,oe;if(vt.string(S)){ee=S;let Be=V[0],Qe=0,nt=he.ParameterStructures.auto;he.ParameterStructures.is(Be)&&(Qe=1,nt=Be);let Re=V.length,Je=Re-Qe;switch(Je){case 0:oe=void 0;break;case 1:oe=_n(nt,V[Qe]);break;default:if(nt===he.ParameterStructures.byName)throw new Error(`Received ${Je} parameters for 'by Name' notification parameter structure.`);oe=V.slice(Qe,Re).map(qe=>Ht(qe));break}}else{let Be=V;ee=S.method,oe=kr(S,Be)}let $e={jsonrpc:g,method:ee,params:oe};return Wi($e),t.write($e).catch(Be=>{throw o.error("Sending notification failed."),Be})},onNotification:(S,V)=>{sn();let ee;return vt.func(S)?k=S:V&&(vt.string(S)?(ee=S,I.set(S,{type:void 0,handler:V})):(ee=S.method,I.set(S.method,{type:S,handler:V}))),{dispose:()=>{ee!==void 0?I.delete(ee):k=void 0}}},onProgress:(S,V,ee)=>{if(M.has(V))throw new Error(`Progress handler for token ${V} already registered`);return M.set(V,ee),{dispose:()=>{M.delete(V)}}},sendProgress:(S,V,ee)=>vn.sendNotification(Ps.type,{token:V,value:ee}),onUnhandledProgress:xe.event,sendRequest:(S,...V)=>{sn(),ji();let ee,oe,$e;if(vt.string(S)){ee=S;let Re=V[0],Je=V[V.length-1],qe=0,at=he.ParameterStructures.auto;he.ParameterStructures.is(Re)&&(qe=1,at=Re);let Et=V.length;Kf.CancellationToken.is(Je)&&(Et=Et-1,$e=Je);let Zt=Et-qe;switch(Zt){case 0:oe=void 0;break;case 1:oe=_n(at,V[qe]);break;default:if(at===he.ParameterStructures.byName)throw new Error(`Received ${Zt} parameters for 'by Name' request parameter structure.`);oe=V.slice(qe,Et).map(zi=>Ht(zi));break}}else{let Re=V;ee=S.method,oe=kr(S,Re);let Je=S.numberOfParams;$e=Kf.CancellationToken.is(Re[Je])?Re[Je]:void 0}let Be=c++,Qe;$e&&(Qe=$e.onCancellationRequested(()=>{let Re=H.sender.sendCancellation(vn,Be);return Re===void 0?(o.log(`Received no promise from cancellation strategy when cancelling id ${Be}`),Promise.resolve()):Re.catch(()=>{o.log(`Sending cancellation messages for id ${Be} failed`)})}));let nt={jsonrpc:g,id:Be,method:ee,params:oe};return fr(nt),typeof H.sender.enableCancellation=="function"&&H.sender.enableCancellation(nt),new Promise(async(Re,Je)=>{let qe=Zt=>{Re(Zt),H.sender.cleanup(Be),Qe?.dispose()},at=Zt=>{Je(Zt),H.sender.cleanup(Be),Qe?.dispose()},Et={method:ee,timerStart:Date.now(),resolve:qe,reject:at};try{await t.write(nt),W.set(Be,Et)}catch(Zt){throw o.error("Sending request failed."),Et.reject(new he.ResponseError(he.ErrorCodes.MessageWriteError,Zt.message?Zt.message:"Unknown reason")),Zt}})},onRequest:(S,V)=>{sn();let ee=null;return eh.is(S)?(ee=void 0,b=S):vt.string(S)?(ee=null,V!==void 0&&(ee=S,x.set(S,{handler:V,type:void 0}))):V!==void 0&&(ee=S.method,x.set(S.method,{type:S,handler:V})),{dispose:()=>{ee!==null&&(ee!==void 0?x.delete(ee):b=void 0)}}},hasPendingResponse:()=>W.size>0,trace:async(S,V,ee)=>{let oe=!1,$e=Rn.Text;ee!==void 0&&(vt.boolean(ee)?oe=ee:(oe=ee.sendNotification||!1,$e=ee.traceFormat||Rn.Text)),P=S,U=$e,P===Ve.Off?ne=void 0:ne=V,oe&&!je()&&!ze()&&await vn.sendNotification(th.type,{value:Ve.toString(S)})},onError:Ue.event,onClose:Ke.event,onUnhandledNotification:Dt.event,onDispose:Y.event,end:()=>{t.end()},dispose:()=>{if(ze())return;_e=Zn.Disposed,Y.fire(void 0);let S=new he.ResponseError(he.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let V of W.values())V.reject(S);W=new Map,D=new Map,X=new Set,B=new I_.LinkedMap,vt.func(t.dispose)&&t.dispose(),vt.func(e.dispose)&&e.dispose()},listen:()=>{sn(),Cr(),_e=Zn.Listening,e.listen(dr)},inspect:()=>{(0,E_.default)().console.log("inspect")}};return vn.onNotification(Cc.type,S=>{if(P===Ve.Off||!ne)return;let V=P===Ve.Verbose||P===Ve.Compact;ne.log(S.message,V?S.verbose:void 0)}),vn.onNotification(Ps.type,S=>{let V=M.get(S.token);V?V(S.value):xe.fire(S)}),vn}Pe.createMessageConnection=IN});var Ic=F(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.ProgressType=z.ProgressToken=z.createMessageConnection=z.NullLogger=z.ConnectionOptions=z.ConnectionStrategy=z.AbstractMessageBuffer=z.WriteableStreamMessageWriter=z.AbstractMessageWriter=z.MessageWriter=z.ReadableStreamMessageReader=z.AbstractMessageReader=z.MessageReader=z.SharedArrayReceiverStrategy=z.SharedArraySenderStrategy=z.CancellationToken=z.CancellationTokenSource=z.Emitter=z.Event=z.Disposable=z.LRUCache=z.Touch=z.LinkedMap=z.ParameterStructures=z.NotificationType9=z.NotificationType8=z.NotificationType7=z.NotificationType6=z.NotificationType5=z.NotificationType4=z.NotificationType3=z.NotificationType2=z.NotificationType1=z.NotificationType0=z.NotificationType=z.ErrorCodes=z.ResponseError=z.RequestType9=z.RequestType8=z.RequestType7=z.RequestType6=z.RequestType5=z.RequestType4=z.RequestType3=z.RequestType2=z.RequestType1=z.RequestType0=z.RequestType=z.Message=z.RAL=void 0;z.MessageStrategy=z.CancellationStrategy=z.CancellationSenderStrategy=z.CancellationReceiverStrategy=z.ConnectionError=z.ConnectionErrors=z.LogTraceNotification=z.SetTraceNotification=z.TraceFormat=z.TraceValues=z.Trace=void 0;var it=Df();Object.defineProperty(z,"Message",{enumerable:!0,get:function(){return it.Message}});Object.defineProperty(z,"RequestType",{enumerable:!0,get:function(){return it.RequestType}});Object.defineProperty(z,"RequestType0",{enumerable:!0,get:function(){return it.RequestType0}});Object.defineProperty(z,"RequestType1",{enumerable:!0,get:function(){return it.RequestType1}});Object.defineProperty(z,"RequestType2",{enumerable:!0,get:function(){return it.RequestType2}});Object.defineProperty(z,"RequestType3",{enumerable:!0,get:function(){return it.RequestType3}});Object.defineProperty(z,"RequestType4",{enumerable:!0,get:function(){return it.RequestType4}});Object.defineProperty(z,"RequestType5",{enumerable:!0,get:function(){return it.RequestType5}});Object.defineProperty(z,"RequestType6",{enumerable:!0,get:function(){return it.RequestType6}});Object.defineProperty(z,"RequestType7",{enumerable:!0,get:function(){return it.RequestType7}});Object.defineProperty(z,"RequestType8",{enumerable:!0,get:function(){return it.RequestType8}});Object.defineProperty(z,"RequestType9",{enumerable:!0,get:function(){return it.RequestType9}});Object.defineProperty(z,"ResponseError",{enumerable:!0,get:function(){return it.ResponseError}});Object.defineProperty(z,"ErrorCodes",{enumerable:!0,get:function(){return it.ErrorCodes}});Object.defineProperty(z,"NotificationType",{enumerable:!0,get:function(){return it.NotificationType}});Object.defineProperty(z,"NotificationType0",{enumerable:!0,get:function(){return it.NotificationType0}});Object.defineProperty(z,"NotificationType1",{enumerable:!0,get:function(){return it.NotificationType1}});Object.defineProperty(z,"NotificationType2",{enumerable:!0,get:function(){return it.NotificationType2}});Object.defineProperty(z,"NotificationType3",{enumerable:!0,get:function(){return it.NotificationType3}});Object.defineProperty(z,"NotificationType4",{enumerable:!0,get:function(){return it.NotificationType4}});Object.defineProperty(z,"NotificationType5",{enumerable:!0,get:function(){return it.NotificationType5}});Object.defineProperty(z,"NotificationType6",{enumerable:!0,get:function(){return it.NotificationType6}});Object.defineProperty(z,"NotificationType7",{enumerable:!0,get:function(){return it.NotificationType7}});Object.defineProperty(z,"NotificationType8",{enumerable:!0,get:function(){return it.NotificationType8}});Object.defineProperty(z,"NotificationType9",{enumerable:!0,get:function(){return it.NotificationType9}});Object.defineProperty(z,"ParameterStructures",{enumerable:!0,get:function(){return it.ParameterStructures}});var ih=If();Object.defineProperty(z,"LinkedMap",{enumerable:!0,get:function(){return ih.LinkedMap}});Object.defineProperty(z,"LRUCache",{enumerable:!0,get:function(){return ih.LRUCache}});Object.defineProperty(z,"Touch",{enumerable:!0,get:function(){return ih.Touch}});var FN=v_();Object.defineProperty(z,"Disposable",{enumerable:!0,get:function(){return FN.Disposable}});var N_=ao();Object.defineProperty(z,"Event",{enumerable:!0,get:function(){return N_.Event}});Object.defineProperty(z,"Emitter",{enumerable:!0,get:function(){return N_.Emitter}});var q_=yc();Object.defineProperty(z,"CancellationTokenSource",{enumerable:!0,get:function(){return q_.CancellationTokenSource}});Object.defineProperty(z,"CancellationToken",{enumerable:!0,get:function(){return q_.CancellationToken}});var L_=x_();Object.defineProperty(z,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return L_.SharedArraySenderStrategy}});Object.defineProperty(z,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return L_.SharedArrayReceiverStrategy}});var oh=P_();Object.defineProperty(z,"MessageReader",{enumerable:!0,get:function(){return oh.MessageReader}});Object.defineProperty(z,"AbstractMessageReader",{enumerable:!0,get:function(){return oh.AbstractMessageReader}});Object.defineProperty(z,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return oh.ReadableStreamMessageReader}});var sh=T_();Object.defineProperty(z,"MessageWriter",{enumerable:!0,get:function(){return sh.MessageWriter}});Object.defineProperty(z,"AbstractMessageWriter",{enumerable:!0,get:function(){return sh.AbstractMessageWriter}});Object.defineProperty(z,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return sh.WriteableStreamMessageWriter}});var AN=D_();Object.defineProperty(z,"AbstractMessageBuffer",{enumerable:!0,get:function(){return AN.AbstractMessageBuffer}});var Wt=M_();Object.defineProperty(z,"ConnectionStrategy",{enumerable:!0,get:function(){return Wt.ConnectionStrategy}});Object.defineProperty(z,"ConnectionOptions",{enumerable:!0,get:function(){return Wt.ConnectionOptions}});Object.defineProperty(z,"NullLogger",{enumerable:!0,get:function(){return Wt.NullLogger}});Object.defineProperty(z,"createMessageConnection",{enumerable:!0,get:function(){return Wt.createMessageConnection}});Object.defineProperty(z,"ProgressToken",{enumerable:!0,get:function(){return Wt.ProgressToken}});Object.defineProperty(z,"ProgressType",{enumerable:!0,get:function(){return Wt.ProgressType}});Object.defineProperty(z,"Trace",{enumerable:!0,get:function(){return Wt.Trace}});Object.defineProperty(z,"TraceValues",{enumerable:!0,get:function(){return Wt.TraceValues}});Object.defineProperty(z,"TraceFormat",{enumerable:!0,get:function(){return Wt.TraceFormat}});Object.defineProperty(z,"SetTraceNotification",{enumerable:!0,get:function(){return Wt.SetTraceNotification}});Object.defineProperty(z,"LogTraceNotification",{enumerable:!0,get:function(){return Wt.LogTraceNotification}});Object.defineProperty(z,"ConnectionErrors",{enumerable:!0,get:function(){return Wt.ConnectionErrors}});Object.defineProperty(z,"ConnectionError",{enumerable:!0,get:function(){return Wt.ConnectionError}});Object.defineProperty(z,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Wt.CancellationReceiverStrategy}});Object.defineProperty(z,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Wt.CancellationSenderStrategy}});Object.defineProperty(z,"CancellationStrategy",{enumerable:!0,get:function(){return Wt.CancellationStrategy}});Object.defineProperty(z,"MessageStrategy",{enumerable:!0,get:function(){return Wt.MessageStrategy}});var MN=ni();z.RAL=MN.default});var U_=F(lh=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0});var O_=require("util"),qr=Ic(),Fc=class e extends qr.AbstractMessageBuffer{constructor(t="utf-8"){super(t)}emptyBuffer(){return e.emptyBuffer}fromString(t,n){return Buffer.from(t,n)}toString(t,n){return t instanceof Buffer?t.toString(n):new O_.TextDecoder(n).decode(t)}asNative(t,n){return n===void 0?t instanceof Buffer?t:Buffer.from(t):t instanceof Buffer?t.slice(0,n):Buffer.from(t,0,n)}allocNative(t){return Buffer.allocUnsafe(t)}};Fc.emptyBuffer=Buffer.allocUnsafe(0);var ah=class{constructor(t){this.stream=t}onClose(t){return this.stream.on("close",t),qr.Disposable.create(()=>this.stream.off("close",t))}onError(t){return this.stream.on("error",t),qr.Disposable.create(()=>this.stream.off("error",t))}onEnd(t){return this.stream.on("end",t),qr.Disposable.create(()=>this.stream.off("end",t))}onData(t){return this.stream.on("data",t),qr.Disposable.create(()=>this.stream.off("data",t))}},ch=class{constructor(t){this.stream=t}onClose(t){return this.stream.on("close",t),qr.Disposable.create(()=>this.stream.off("close",t))}onError(t){return this.stream.on("error",t),qr.Disposable.create(()=>this.stream.off("error",t))}onEnd(t){return this.stream.on("end",t),qr.Disposable.create(()=>this.stream.off("end",t))}write(t,n){return new Promise((i,o)=>{let c=u=>{u==null?i():o(u)};typeof t=="string"?this.stream.write(t,n,c):this.stream.write(t,c)})}end(){this.stream.end()}},B_=Object.freeze({messageBuffer:Object.freeze({create:e=>new Fc(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(n){return Promise.reject(n)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new O_.TextDecoder(t.charset).decode(e)))}catch(n){return Promise.reject(n)}}})}),stream:Object.freeze({asReadableStream:e=>new ah(e),asWritableStream:e=>new ch(e)}),console,timer:Object.freeze({setTimeout(e,t,...n){let i=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(e,...t){let n=setImmediate(e,...t);return{dispose:()=>clearImmediate(n)}},setInterval(e,t,...n){let i=setInterval(e,t,...n);return{dispose:()=>clearInterval(i)}}})});function uh(){return B_}(function(e){function t(){qr.RAL.install(B_)}e.install=t})(uh||(uh={}));lh.default=uh});var Mi=F(Oe=>{"use strict";var NN=Oe&&Oe.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),qN=Oe&&Oe.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&NN(t,e,n)};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.createMessageConnection=Oe.createServerSocketTransport=Oe.createClientSocketTransport=Oe.createServerPipeTransport=Oe.createClientPipeTransport=Oe.generateRandomPipeName=Oe.StreamMessageWriter=Oe.StreamMessageReader=Oe.SocketMessageWriter=Oe.SocketMessageReader=Oe.PortMessageWriter=Oe.PortMessageReader=Oe.IPCMessageWriter=Oe.IPCMessageReader=void 0;var ho=U_();ho.default.install();var $_=require("path"),LN=require("os"),ON=require("crypto"),Nc=require("net"),Tn=Ic();qN(Ic(),Oe);var dh=class extends Tn.AbstractMessageReader{constructor(t){super(),this.process=t;let n=this.process;n.on("error",i=>this.fireError(i)),n.on("close",()=>this.fireClose())}listen(t){return this.process.on("message",t),Tn.Disposable.create(()=>this.process.off("message",t))}};Oe.IPCMessageReader=dh;var fh=class extends Tn.AbstractMessageWriter{constructor(t){super(),this.process=t,this.errorCount=0;let n=this.process;n.on("error",i=>this.fireError(i)),n.on("close",()=>this.fireClose)}write(t){try{return typeof this.process.send=="function"&&this.process.send(t,void 0,void 0,n=>{n?(this.errorCount++,this.handleError(n,t)):this.errorCount=0}),Promise.resolve()}catch(n){return this.handleError(n,t),Promise.reject(n)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){}};Oe.IPCMessageWriter=fh;var hh=class extends Tn.AbstractMessageReader{constructor(t){super(),this.onData=new Tn.Emitter,t.on("close",()=>this.fireClose),t.on("error",n=>this.fireError(n)),t.on("message",n=>{this.onData.fire(n)})}listen(t){return this.onData.event(t)}};Oe.PortMessageReader=hh;var gh=class extends Tn.AbstractMessageWriter{constructor(t){super(),this.port=t,this.errorCount=0,t.on("close",()=>this.fireClose()),t.on("error",n=>this.fireError(n))}write(t){try{return this.port.postMessage(t),Promise.resolve()}catch(n){return this.handleError(n,t),Promise.reject(n)}}handleError(t,n){this.errorCount++,this.fireError(t,n,this.errorCount)}end(){}};Oe.PortMessageWriter=gh;var Fi=class extends Tn.ReadableStreamMessageReader{constructor(t,n="utf-8"){super((0,ho.default)().stream.asReadableStream(t),n)}};Oe.SocketMessageReader=Fi;var Ai=class extends Tn.WriteableStreamMessageWriter{constructor(t,n){super((0,ho.default)().stream.asWritableStream(t),n),this.socket=t}dispose(){super.dispose(),this.socket.destroy()}};Oe.SocketMessageWriter=Ai;var Ac=class extends Tn.ReadableStreamMessageReader{constructor(t,n){super((0,ho.default)().stream.asReadableStream(t),n)}};Oe.StreamMessageReader=Ac;var Mc=class extends Tn.WriteableStreamMessageWriter{constructor(t,n){super((0,ho.default)().stream.asWritableStream(t),n)}};Oe.StreamMessageWriter=Mc;var W_=process.env.XDG_RUNTIME_DIR,BN=new Map([["linux",107],["darwin",103]]);function UN(){let e=(0,ON.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;W_?t=$_.join(W_,`vscode-ipc-${e}.sock`):t=$_.join(LN.tmpdir(),`vscode-${e}.sock`);let n=BN.get(process.platform);return n!==void 0&&t.length>n&&(0,ho.default)().console.warn(`WARNING: IPC handle "${t}" is longer than ${n} characters.`),t}Oe.generateRandomPipeName=UN;function $N(e,t="utf-8"){let n,i=new Promise((o,c)=>{n=o});return new Promise((o,c)=>{let u=(0,Nc.createServer)(f=>{u.close(),n([new Fi(f,t),new Ai(f,t)])});u.on("error",c),u.listen(e,()=>{u.removeListener("error",c),o({onConnected:()=>i})})})}Oe.createClientPipeTransport=$N;function WN(e,t="utf-8"){let n=(0,Nc.createConnection)(e);return[new Fi(n,t),new Ai(n,t)]}Oe.createServerPipeTransport=WN;function jN(e,t="utf-8"){let n,i=new Promise((o,c)=>{n=o});return new Promise((o,c)=>{let u=(0,Nc.createServer)(f=>{u.close(),n([new Fi(f,t),new Ai(f,t)])});u.on("error",c),u.listen(e,"127.0.0.1",()=>{u.removeListener("error",c),o({onConnected:()=>i})})})}Oe.createClientSocketTransport=jN;function zN(e,t="utf-8"){let n=(0,Nc.createConnection)(e,"127.0.0.1");return[new Fi(n,t),new Ai(n,t)]}Oe.createServerSocketTransport=zN;function HN(e){let t=e;return t.read!==void 0&&t.addListener!==void 0}function VN(e){let t=e;return t.write!==void 0&&t.addListener!==void 0}function GN(e,t,n,i){n||(n=Tn.NullLogger);let o=HN(e)?new Ac(e):e,c=VN(t)?new Mc(t):t;return Tn.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,Tn.createMessageConnection)(o,c,n,i)}Oe.createMessageConnection=GN});var ph=F((yz,j_)=>{"use strict";j_.exports=Mi()});var Lc=F((z_,qc)=>{"use strict";(function(e){if(typeof qc=="object"&&typeof qc.exports=="object"){var t=e(require,z_);t!==void 0&&(qc.exports=t)}else typeof define=="function"&&define.amd&&define(["require","exports"],e)})(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=t.EOL=t.WorkspaceFolder=t.InlineCompletionContext=t.SelectedCompletionInfo=t.InlineCompletionTriggerKind=t.InlineCompletionList=t.InlineCompletionItem=t.StringValue=t.InlayHint=t.InlayHintLabelPart=t.InlayHintKind=t.InlineValueContext=t.InlineValueEvaluatableExpression=t.InlineValueVariableLookup=t.InlineValueText=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.SelectionRange=t.DocumentLink=t.FormattingOptions=t.CodeLens=t.CodeAction=t.CodeActionContext=t.CodeActionTriggerKind=t.CodeActionKind=t.DocumentSymbol=t.WorkspaceSymbol=t.SymbolInformation=t.SymbolTag=t.SymbolKind=t.DocumentHighlight=t.DocumentHighlightKind=t.SignatureInformation=t.ParameterInformation=t.Hover=t.MarkedString=t.CompletionList=t.CompletionItem=t.CompletionItemLabelDetails=t.InsertTextMode=t.InsertReplaceEdit=t.CompletionItemTag=t.InsertTextFormat=t.CompletionItemKind=t.MarkupContent=t.MarkupKind=t.TextDocumentItem=t.OptionalVersionedTextDocumentIdentifier=t.VersionedTextDocumentIdentifier=t.TextDocumentIdentifier=t.WorkspaceChange=t.WorkspaceEdit=t.DeleteFile=t.RenameFile=t.CreateFile=t.TextDocumentEdit=t.AnnotatedTextEdit=t.ChangeAnnotationIdentifier=t.ChangeAnnotation=t.TextEdit=t.Command=t.Diagnostic=t.CodeDescription=t.DiagnosticTag=t.DiagnosticSeverity=t.DiagnosticRelatedInformation=t.FoldingRange=t.FoldingRangeKind=t.ColorPresentation=t.ColorInformation=t.Color=t.LocationLink=t.Location=t.Range=t.Position=t.uinteger=t.integer=t.URI=t.DocumentUri=void 0;var n;(function(p){function C(T){return typeof T=="string"}p.is=C})(n||(t.DocumentUri=n={}));var i;(function(p){function C(T){return typeof T=="string"}p.is=C})(i||(t.URI=i={}));var o;(function(p){p.MIN_VALUE=-2147483648,p.MAX_VALUE=2147483647;function C(T){return typeof T=="number"&&p.MIN_VALUE<=T&&T<=p.MAX_VALUE}p.is=C})(o||(t.integer=o={}));var c;(function(p){p.MIN_VALUE=0,p.MAX_VALUE=2147483647;function C(T){return typeof T=="number"&&p.MIN_VALUE<=T&&T<=p.MAX_VALUE}p.is=C})(c||(t.uinteger=c={}));var u;(function(p){function C(v,h){return v===Number.MAX_VALUE&&(v=c.MAX_VALUE),h===Number.MAX_VALUE&&(h=c.MAX_VALUE),{line:v,character:h}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&q.uinteger(h.line)&&q.uinteger(h.character)}p.is=T})(u||(t.Position=u={}));var f;(function(p){function C(v,h,L,Q){if(q.uinteger(v)&&q.uinteger(h)&&q.uinteger(L)&&q.uinteger(Q))return{start:u.create(v,h),end:u.create(L,Q)};if(u.is(v)&&u.is(h))return{start:v,end:h};throw new Error("Range#create called with invalid arguments[".concat(v,", ").concat(h,", ").concat(L,", ").concat(Q,"]"))}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&u.is(h.start)&&u.is(h.end)}p.is=T})(f||(t.Range=f={}));var g;(function(p){function C(v,h){return{uri:v,range:h}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&f.is(h.range)&&(q.string(h.uri)||q.undefined(h.uri))}p.is=T})(g||(t.Location=g={}));var b;(function(p){function C(v,h,L,Q){return{targetUri:v,targetRange:h,targetSelectionRange:L,originSelectionRange:Q}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&f.is(h.targetRange)&&q.string(h.targetUri)&&f.is(h.targetSelectionRange)&&(f.is(h.originSelectionRange)||q.undefined(h.originSelectionRange))}p.is=T})(b||(t.LocationLink=b={}));var x;(function(p){function C(v,h,L,Q){return{red:v,green:h,blue:L,alpha:Q}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&q.numberRange(h.red,0,1)&&q.numberRange(h.green,0,1)&&q.numberRange(h.blue,0,1)&&q.numberRange(h.alpha,0,1)}p.is=T})(x||(t.Color=x={}));var k;(function(p){function C(v,h){return{range:v,color:h}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&f.is(h.range)&&x.is(h.color)}p.is=T})(k||(t.ColorInformation=k={}));var I;(function(p){function C(v,h,L){return{label:v,textEdit:h,additionalTextEdits:L}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&q.string(h.label)&&(q.undefined(h.textEdit)||ne.is(h))&&(q.undefined(h.additionalTextEdits)||q.typedArray(h.additionalTextEdits,ne.is))}p.is=T})(I||(t.ColorPresentation=I={}));var M;(function(p){p.Comment="comment",p.Imports="imports",p.Region="region"})(M||(t.FoldingRangeKind=M={}));var N;(function(p){function C(v,h,L,Q,be,ht){var Ye={startLine:v,endLine:h};return q.defined(L)&&(Ye.startCharacter=L),q.defined(Q)&&(Ye.endCharacter=Q),q.defined(be)&&(Ye.kind=be),q.defined(ht)&&(Ye.collapsedText=ht),Ye}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&q.uinteger(h.startLine)&&q.uinteger(h.startLine)&&(q.undefined(h.startCharacter)||q.uinteger(h.startCharacter))&&(q.undefined(h.endCharacter)||q.uinteger(h.endCharacter))&&(q.undefined(h.kind)||q.string(h.kind))}p.is=T})(N||(t.FoldingRange=N={}));var B;(function(p){function C(v,h){return{location:v,message:h}}p.create=C;function T(v){var h=v;return q.defined(h)&&g.is(h.location)&&q.string(h.message)}p.is=T})(B||(t.DiagnosticRelatedInformation=B={}));var W;(function(p){p.Error=1,p.Warning=2,p.Information=3,p.Hint=4})(W||(t.DiagnosticSeverity=W={}));var X;(function(p){p.Unnecessary=1,p.Deprecated=2})(X||(t.DiagnosticTag=X={}));var D;(function(p){function C(T){var v=T;return q.objectLiteral(v)&&q.string(v.href)}p.is=C})(D||(t.CodeDescription=D={}));var P;(function(p){function C(v,h,L,Q,be,ht){var Ye={range:v,message:h};return q.defined(L)&&(Ye.severity=L),q.defined(Q)&&(Ye.code=Q),q.defined(be)&&(Ye.source=be),q.defined(ht)&&(Ye.relatedInformation=ht),Ye}p.create=C;function T(v){var h,L=v;return q.defined(L)&&f.is(L.range)&&q.string(L.message)&&(q.number(L.severity)||q.undefined(L.severity))&&(q.integer(L.code)||q.string(L.code)||q.undefined(L.code))&&(q.undefined(L.codeDescription)||q.string((h=L.codeDescription)===null||h===void 0?void 0:h.href))&&(q.string(L.source)||q.undefined(L.source))&&(q.undefined(L.relatedInformation)||q.typedArray(L.relatedInformation,B.is))}p.is=T})(P||(t.Diagnostic=P={}));var U;(function(p){function C(v,h){for(var L=[],Q=2;Q<arguments.length;Q++)L[Q-2]=arguments[Q];var be={title:v,command:h};return q.defined(L)&&L.length>0&&(be.arguments=L),be}p.create=C;function T(v){var h=v;return q.defined(h)&&q.string(h.title)&&q.string(h.command)}p.is=T})(U||(t.Command=U={}));var ne;(function(p){function C(L,Q){return{range:L,newText:Q}}p.replace=C;function T(L,Q){return{range:{start:L,end:L},newText:Q}}p.insert=T;function v(L){return{range:L,newText:""}}p.del=v;function h(L){var Q=L;return q.objectLiteral(Q)&&q.string(Q.newText)&&f.is(Q.range)}p.is=h})(ne||(t.TextEdit=ne={}));var _e;(function(p){function C(v,h,L){var Q={label:v};return h!==void 0&&(Q.needsConfirmation=h),L!==void 0&&(Q.description=L),Q}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&q.string(h.label)&&(q.boolean(h.needsConfirmation)||h.needsConfirmation===void 0)&&(q.string(h.description)||h.description===void 0)}p.is=T})(_e||(t.ChangeAnnotation=_e={}));var Ue;(function(p){function C(T){var v=T;return q.string(v)}p.is=C})(Ue||(t.ChangeAnnotationIdentifier=Ue={}));var Ke;(function(p){function C(L,Q,be){return{range:L,newText:Q,annotationId:be}}p.replace=C;function T(L,Q,be){return{range:{start:L,end:L},newText:Q,annotationId:be}}p.insert=T;function v(L,Q){return{range:L,newText:"",annotationId:Q}}p.del=v;function h(L){var Q=L;return ne.is(Q)&&(_e.is(Q.annotationId)||Ue.is(Q.annotationId))}p.is=h})(Ke||(t.AnnotatedTextEdit=Ke={}));var Dt;(function(p){function C(v,h){return{textDocument:v,edits:h}}p.create=C;function T(v){var h=v;return q.defined(h)&&je.is(h.textDocument)&&Array.isArray(h.edits)}p.is=T})(Dt||(t.TextDocumentEdit=Dt={}));var xe;(function(p){function C(v,h,L){var Q={kind:"create",uri:v};return h!==void 0&&(h.overwrite!==void 0||h.ignoreIfExists!==void 0)&&(Q.options=h),L!==void 0&&(Q.annotationId=L),Q}p.create=C;function T(v){var h=v;return h&&h.kind==="create"&&q.string(h.uri)&&(h.options===void 0||(h.options.overwrite===void 0||q.boolean(h.options.overwrite))&&(h.options.ignoreIfExists===void 0||q.boolean(h.options.ignoreIfExists)))&&(h.annotationId===void 0||Ue.is(h.annotationId))}p.is=T})(xe||(t.CreateFile=xe={}));var Y;(function(p){function C(v,h,L,Q){var be={kind:"rename",oldUri:v,newUri:h};return L!==void 0&&(L.overwrite!==void 0||L.ignoreIfExists!==void 0)&&(be.options=L),Q!==void 0&&(be.annotationId=Q),be}p.create=C;function T(v){var h=v;return h&&h.kind==="rename"&&q.string(h.oldUri)&&q.string(h.newUri)&&(h.options===void 0||(h.options.overwrite===void 0||q.boolean(h.options.overwrite))&&(h.options.ignoreIfExists===void 0||q.boolean(h.options.ignoreIfExists)))&&(h.annotationId===void 0||Ue.is(h.annotationId))}p.is=T})(Y||(t.RenameFile=Y={}));var H;(function(p){function C(v,h,L){var Q={kind:"delete",uri:v};return h!==void 0&&(h.recursive!==void 0||h.ignoreIfNotExists!==void 0)&&(Q.options=h),L!==void 0&&(Q.annotationId=L),Q}p.create=C;function T(v){var h=v;return h&&h.kind==="delete"&&q.string(h.uri)&&(h.options===void 0||(h.options.recursive===void 0||q.boolean(h.options.recursive))&&(h.options.ignoreIfNotExists===void 0||q.boolean(h.options.ignoreIfNotExists)))&&(h.annotationId===void 0||Ue.is(h.annotationId))}p.is=T})(H||(t.DeleteFile=H={}));var ae;(function(p){function C(T){var v=T;return v&&(v.changes!==void 0||v.documentChanges!==void 0)&&(v.documentChanges===void 0||v.documentChanges.every(function(h){return q.string(h.kind)?xe.is(h)||Y.is(h)||H.is(h):Dt.is(h)}))}p.is=C})(ae||(t.WorkspaceEdit=ae={}));var ie=function(){function p(C,T){this.edits=C,this.changeAnnotations=T}return p.prototype.insert=function(C,T,v){var h,L;if(v===void 0?h=ne.insert(C,T):Ue.is(v)?(L=v,h=Ke.insert(C,T,v)):(this.assertChangeAnnotations(this.changeAnnotations),L=this.changeAnnotations.manage(v),h=Ke.insert(C,T,L)),this.edits.push(h),L!==void 0)return L},p.prototype.replace=function(C,T,v){var h,L;if(v===void 0?h=ne.replace(C,T):Ue.is(v)?(L=v,h=Ke.replace(C,T,v)):(this.assertChangeAnnotations(this.changeAnnotations),L=this.changeAnnotations.manage(v),h=Ke.replace(C,T,L)),this.edits.push(h),L!==void 0)return L},p.prototype.delete=function(C,T){var v,h;if(T===void 0?v=ne.del(C):Ue.is(T)?(h=T,v=Ke.del(C,T)):(this.assertChangeAnnotations(this.changeAnnotations),h=this.changeAnnotations.manage(T),v=Ke.del(C,h)),this.edits.push(v),h!==void 0)return h},p.prototype.add=function(C){this.edits.push(C)},p.prototype.all=function(){return this.edits},p.prototype.clear=function(){this.edits.splice(0,this.edits.length)},p.prototype.assertChangeAnnotations=function(C){if(C===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},p}(),ke=function(){function p(C){this._annotations=C===void 0?Object.create(null):C,this._counter=0,this._size=0}return p.prototype.all=function(){return this._annotations},Object.defineProperty(p.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),p.prototype.manage=function(C,T){var v;if(Ue.is(C)?v=C:(v=this.nextId(),T=C),this._annotations[v]!==void 0)throw new Error("Id ".concat(v," is already in use."));if(T===void 0)throw new Error("No annotation provided for id ".concat(v));return this._annotations[v]=T,this._size++,v},p.prototype.nextId=function(){return this._counter++,this._counter.toString()},p}(),ge=function(){function p(C){var T=this;this._textEditChanges=Object.create(null),C!==void 0?(this._workspaceEdit=C,C.documentChanges?(this._changeAnnotations=new ke(C.changeAnnotations),C.changeAnnotations=this._changeAnnotations.all(),C.documentChanges.forEach(function(v){if(Dt.is(v)){var h=new ie(v.edits,T._changeAnnotations);T._textEditChanges[v.textDocument.uri]=h}})):C.changes&&Object.keys(C.changes).forEach(function(v){var h=new ie(C.changes[v]);T._textEditChanges[v]=h})):this._workspaceEdit={}}return Object.defineProperty(p.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),p.prototype.getTextEditChange=function(C){if(je.is(C)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T={uri:C.uri,version:C.version},v=this._textEditChanges[T.uri];if(!v){var h=[],L={textDocument:T,edits:h};this._workspaceEdit.documentChanges.push(L),v=new ie(h,this._changeAnnotations),this._textEditChanges[T.uri]=v}return v}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var v=this._textEditChanges[C];if(!v){var h=[];this._workspaceEdit.changes[C]=h,v=new ie(h),this._textEditChanges[C]=v}return v}},p.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new ke,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},p.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},p.prototype.createFile=function(C,T,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var h;_e.is(T)||Ue.is(T)?h=T:v=T;var L,Q;if(h===void 0?L=xe.create(C,v):(Q=Ue.is(h)?h:this._changeAnnotations.manage(h),L=xe.create(C,v,Q)),this._workspaceEdit.documentChanges.push(L),Q!==void 0)return Q},p.prototype.renameFile=function(C,T,v,h){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var L;_e.is(v)||Ue.is(v)?L=v:h=v;var Q,be;if(L===void 0?Q=Y.create(C,T,h):(be=Ue.is(L)?L:this._changeAnnotations.manage(L),Q=Y.create(C,T,h,be)),this._workspaceEdit.documentChanges.push(Q),be!==void 0)return be},p.prototype.deleteFile=function(C,T,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var h;_e.is(T)||Ue.is(T)?h=T:v=T;var L,Q;if(h===void 0?L=H.create(C,v):(Q=Ue.is(h)?h:this._changeAnnotations.manage(h),L=H.create(C,v,Q)),this._workspaceEdit.documentChanges.push(L),Q!==void 0)return Q},p}();t.WorkspaceChange=ge;var pe;(function(p){function C(v){return{uri:v}}p.create=C;function T(v){var h=v;return q.defined(h)&&q.string(h.uri)}p.is=T})(pe||(t.TextDocumentIdentifier=pe={}));var wt;(function(p){function C(v,h){return{uri:v,version:h}}p.create=C;function T(v){var h=v;return q.defined(h)&&q.string(h.uri)&&q.integer(h.version)}p.is=T})(wt||(t.VersionedTextDocumentIdentifier=wt={}));var je;(function(p){function C(v,h){return{uri:v,version:h}}p.create=C;function T(v){var h=v;return q.defined(h)&&q.string(h.uri)&&(h.version===null||q.integer(h.version))}p.is=T})(je||(t.OptionalVersionedTextDocumentIdentifier=je={}));var ze;(function(p){function C(v,h,L,Q){return{uri:v,languageId:h,version:L,text:Q}}p.create=C;function T(v){var h=v;return q.defined(h)&&q.string(h.uri)&&q.string(h.languageId)&&q.integer(h.version)&&q.string(h.text)}p.is=T})(ze||(t.TextDocumentItem=ze={}));var bn;(function(p){p.PlainText="plaintext",p.Markdown="markdown";function C(T){var v=T;return v===p.PlainText||v===p.Markdown}p.is=C})(bn||(t.MarkupKind=bn={}));var xr;(function(p){function C(T){var v=T;return q.objectLiteral(T)&&bn.is(v.kind)&&q.string(v.value)}p.is=C})(xr||(t.MarkupContent=xr={}));var Vn;(function(p){p.Text=1,p.Method=2,p.Function=3,p.Constructor=4,p.Field=5,p.Variable=6,p.Class=7,p.Interface=8,p.Module=9,p.Property=10,p.Unit=11,p.Value=12,p.Enum=13,p.Keyword=14,p.Snippet=15,p.Color=16,p.File=17,p.Reference=18,p.Folder=19,p.EnumMember=20,p.Constant=21,p.Struct=22,p.Event=23,p.Operator=24,p.TypeParameter=25})(Vn||(t.CompletionItemKind=Vn={}));var ur;(function(p){p.PlainText=1,p.Snippet=2})(ur||(t.InsertTextFormat=ur={}));var vi;(function(p){p.Deprecated=1})(vi||(t.CompletionItemTag=vi={}));var lr;(function(p){function C(v,h,L){return{newText:v,insert:h,replace:L}}p.create=C;function T(v){var h=v;return h&&q.string(h.newText)&&f.is(h.insert)&&f.is(h.replace)}p.is=T})(lr||(t.InsertReplaceEdit=lr={}));var dr;(function(p){p.asIs=1,p.adjustIndentation=2})(dr||(t.InsertTextMode=dr={}));var $i;(function(p){function C(T){var v=T;return v&&(q.string(v.detail)||v.detail===void 0)&&(q.string(v.description)||v.description===void 0)}p.is=C})($i||(t.CompletionItemLabelDetails=$i={}));var wr;(function(p){function C(T){return{label:T}}p.create=C})(wr||(t.CompletionItem=wr={}));var Pr;(function(p){function C(T,v){return{items:T||[],isIncomplete:!!v}}p.create=C})(Pr||(t.CompletionList=Pr={}));var Sr;(function(p){function C(v){return v.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}p.fromPlainText=C;function T(v){var h=v;return q.string(h)||q.objectLiteral(h)&&q.string(h.language)&&q.string(h.value)}p.is=T})(Sr||(t.MarkedString=Sr={}));var bt;(function(p){function C(T){var v=T;return!!v&&q.objectLiteral(v)&&(xr.is(v.contents)||Sr.is(v.contents)||q.typedArray(v.contents,Sr.is))&&(T.range===void 0||f.is(T.range))}p.is=C})(bt||(t.Hover=bt={}));var fr;(function(p){function C(T,v){return v?{label:T,documentation:v}:{label:T}}p.create=C})(fr||(t.ParameterInformation=fr={}));var Wi;(function(p){function C(T,v){for(var h=[],L=2;L<arguments.length;L++)h[L-2]=arguments[L];var Q={label:T};return q.defined(v)&&(Q.documentation=v),q.defined(h)?Q.parameters=h:Q.parameters=[],Q}p.create=C})(Wi||(t.SignatureInformation=Wi={}));var Ut;(function(p){p.Text=1,p.Read=2,p.Write=3})(Ut||(t.DocumentHighlightKind=Ut={}));var yi;(function(p){function C(T,v){var h={range:T};return q.number(v)&&(h.kind=v),h}p.create=C})(yi||(t.DocumentHighlight=yi={}));var jr;(function(p){p.File=1,p.Module=2,p.Namespace=3,p.Package=4,p.Class=5,p.Method=6,p.Property=7,p.Field=8,p.Constructor=9,p.Enum=10,p.Interface=11,p.Function=12,p.Variable=13,p.Constant=14,p.String=15,p.Number=16,p.Boolean=17,p.Array=18,p.Object=19,p.Key=20,p.Null=21,p.EnumMember=22,p.Struct=23,p.Event=24,p.Operator=25,p.TypeParameter=26})(jr||(t.SymbolKind=jr={}));var hr;(function(p){p.Deprecated=1})(hr||(t.SymbolTag=hr={}));var Pt;(function(p){function C(T,v,h,L,Q){var be={name:T,kind:v,location:{uri:L,range:h}};return Q&&(be.containerName=Q),be}p.create=C})(Pt||(t.SymbolInformation=Pt={}));var sn;(function(p){function C(T,v,h,L){return L!==void 0?{name:T,kind:v,location:{uri:h,range:L}}:{name:T,kind:v,location:{uri:h}}}p.create=C})(sn||(t.WorkspaceSymbol=sn={}));var Cr;(function(p){function C(v,h,L,Q,be,ht){var Ye={name:v,detail:h,kind:L,range:Q,selectionRange:be};return ht!==void 0&&(Ye.children=ht),Ye}p.create=C;function T(v){var h=v;return h&&q.string(h.name)&&q.number(h.kind)&&f.is(h.range)&&f.is(h.selectionRange)&&(h.detail===void 0||q.string(h.detail))&&(h.deprecated===void 0||q.boolean(h.deprecated))&&(h.children===void 0||Array.isArray(h.children))&&(h.tags===void 0||Array.isArray(h.tags))}p.is=T})(Cr||(t.DocumentSymbol=Cr={}));var ji;(function(p){p.Empty="",p.QuickFix="quickfix",p.Refactor="refactor",p.RefactorExtract="refactor.extract",p.RefactorInline="refactor.inline",p.RefactorRewrite="refactor.rewrite",p.Source="source",p.SourceOrganizeImports="source.organizeImports",p.SourceFixAll="source.fixAll"})(ji||(t.CodeActionKind=ji={}));var Ht;(function(p){p.Invoked=1,p.Automatic=2})(Ht||(t.CodeActionTriggerKind=Ht={}));var xi;(function(p){function C(v,h,L){var Q={diagnostics:v};return h!=null&&(Q.only=h),L!=null&&(Q.triggerKind=L),Q}p.create=C;function T(v){var h=v;return q.defined(h)&&q.typedArray(h.diagnostics,P.is)&&(h.only===void 0||q.typedArray(h.only,q.string))&&(h.triggerKind===void 0||h.triggerKind===Ht.Invoked||h.triggerKind===Ht.Automatic)}p.is=T})(xi||(t.CodeActionContext=xi={}));var Gn;(function(p){function C(v,h,L){var Q={title:v},be=!0;return typeof h=="string"?(be=!1,Q.kind=h):U.is(h)?Q.command=h:Q.edit=h,be&&L!==void 0&&(Q.kind=L),Q}p.create=C;function T(v){var h=v;return h&&q.string(h.title)&&(h.diagnostics===void 0||q.typedArray(h.diagnostics,P.is))&&(h.kind===void 0||q.string(h.kind))&&(h.edit!==void 0||h.command!==void 0)&&(h.command===void 0||U.is(h.command))&&(h.isPreferred===void 0||q.boolean(h.isPreferred))&&(h.edit===void 0||ae.is(h.edit))}p.is=T})(Gn||(t.CodeAction=Gn={}));var _n;(function(p){function C(v,h){var L={range:v};return q.defined(h)&&(L.data=h),L}p.create=C;function T(v){var h=v;return q.defined(h)&&f.is(h.range)&&(q.undefined(h.command)||U.is(h.command))}p.is=T})(_n||(t.CodeLens=_n={}));var kr;(function(p){function C(v,h){return{tabSize:v,insertSpaces:h}}p.create=C;function T(v){var h=v;return q.defined(h)&&q.uinteger(h.tabSize)&&q.boolean(h.insertSpaces)}p.is=T})(kr||(t.FormattingOptions=kr={}));var vn;(function(p){function C(v,h,L){return{range:v,target:h,data:L}}p.create=C;function T(v){var h=v;return q.defined(h)&&f.is(h.range)&&(q.undefined(h.target)||q.string(h.target))}p.is=T})(vn||(t.DocumentLink=vn={}));var S;(function(p){function C(v,h){return{range:v,parent:h}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&f.is(h.range)&&(h.parent===void 0||p.is(h.parent))}p.is=T})(S||(t.SelectionRange=S={}));var V;(function(p){p.namespace="namespace",p.type="type",p.class="class",p.enum="enum",p.interface="interface",p.struct="struct",p.typeParameter="typeParameter",p.parameter="parameter",p.variable="variable",p.property="property",p.enumMember="enumMember",p.event="event",p.function="function",p.method="method",p.macro="macro",p.keyword="keyword",p.modifier="modifier",p.comment="comment",p.string="string",p.number="number",p.regexp="regexp",p.operator="operator",p.decorator="decorator"})(V||(t.SemanticTokenTypes=V={}));var ee;(function(p){p.declaration="declaration",p.definition="definition",p.readonly="readonly",p.static="static",p.deprecated="deprecated",p.abstract="abstract",p.async="async",p.modification="modification",p.documentation="documentation",p.defaultLibrary="defaultLibrary"})(ee||(t.SemanticTokenModifiers=ee={}));var oe;(function(p){function C(T){var v=T;return q.objectLiteral(v)&&(v.resultId===void 0||typeof v.resultId=="string")&&Array.isArray(v.data)&&(v.data.length===0||typeof v.data[0]=="number")}p.is=C})(oe||(t.SemanticTokens=oe={}));var $e;(function(p){function C(v,h){return{range:v,text:h}}p.create=C;function T(v){var h=v;return h!=null&&f.is(h.range)&&q.string(h.text)}p.is=T})($e||(t.InlineValueText=$e={}));var Be;(function(p){function C(v,h,L){return{range:v,variableName:h,caseSensitiveLookup:L}}p.create=C;function T(v){var h=v;return h!=null&&f.is(h.range)&&q.boolean(h.caseSensitiveLookup)&&(q.string(h.variableName)||h.variableName===void 0)}p.is=T})(Be||(t.InlineValueVariableLookup=Be={}));var Qe;(function(p){function C(v,h){return{range:v,expression:h}}p.create=C;function T(v){var h=v;return h!=null&&f.is(h.range)&&(q.string(h.expression)||h.expression===void 0)}p.is=T})(Qe||(t.InlineValueEvaluatableExpression=Qe={}));var nt;(function(p){function C(v,h){return{frameId:v,stoppedLocation:h}}p.create=C;function T(v){var h=v;return q.defined(h)&&f.is(v.stoppedLocation)}p.is=T})(nt||(t.InlineValueContext=nt={}));var Re;(function(p){p.Type=1,p.Parameter=2;function C(T){return T===1||T===2}p.is=C})(Re||(t.InlayHintKind=Re={}));var Je;(function(p){function C(v){return{value:v}}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&(h.tooltip===void 0||q.string(h.tooltip)||xr.is(h.tooltip))&&(h.location===void 0||g.is(h.location))&&(h.command===void 0||U.is(h.command))}p.is=T})(Je||(t.InlayHintLabelPart=Je={}));var qe;(function(p){function C(v,h,L){var Q={position:v,label:h};return L!==void 0&&(Q.kind=L),Q}p.create=C;function T(v){var h=v;return q.objectLiteral(h)&&u.is(h.position)&&(q.string(h.label)||q.typedArray(h.label,Je.is))&&(h.kind===void 0||Re.is(h.kind))&&h.textEdits===void 0||q.typedArray(h.textEdits,ne.is)&&(h.tooltip===void 0||q.string(h.tooltip)||xr.is(h.tooltip))&&(h.paddingLeft===void 0||q.boolean(h.paddingLeft))&&(h.paddingRight===void 0||q.boolean(h.paddingRight))}p.is=T})(qe||(t.InlayHint=qe={}));var at;(function(p){function C(T){return{kind:"snippet",value:T}}p.createSnippet=C})(at||(t.StringValue=at={}));var Et;(function(p){function C(T,v,h,L){return{insertText:T,filterText:v,range:h,command:L}}p.create=C})(Et||(t.InlineCompletionItem=Et={}));var Zt;(function(p){function C(T){return{items:T}}p.create=C})(Zt||(t.InlineCompletionList=Zt={}));var zi;(function(p){p.Invoked=0,p.Automatic=1})(zi||(t.InlineCompletionTriggerKind=zi={}));var va;(function(p){function C(T,v){return{range:T,text:v}}p.create=C})(va||(t.SelectedCompletionInfo=va={}));var is;(function(p){function C(T,v){return{triggerKind:T,selectedCompletionInfo:v}}p.create=C})(is||(t.InlineCompletionContext=is={}));var ya;(function(p){function C(T){var v=T;return q.objectLiteral(v)&&i.is(v.uri)&&q.string(v.name)}p.is=C})(ya||(t.WorkspaceFolder=ya={})),t.EOL=[`
`,`\r
`,"\r"];var xa;(function(p){function C(L,Q,be,ht){return new Vl(L,Q,be,ht)}p.create=C;function T(L){var Q=L;return!!(q.defined(Q)&&q.string(Q.uri)&&(q.undefined(Q.languageId)||q.string(Q.languageId))&&q.uinteger(Q.lineCount)&&q.func(Q.getText)&&q.func(Q.positionAt)&&q.func(Q.offsetAt))}p.is=T;function v(L,Q){for(var be=L.getText(),ht=h(Q,function(zr,Hi){var wa=zr.range.start.line-Hi.range.start.line;return wa===0?zr.range.start.character-Hi.range.start.character:wa}),Ye=be.length,an=ht.length-1;an>=0;an--){var yn=ht[an],Qn=L.offsetAt(yn.range.start),Fe=L.offsetAt(yn.range.end);if(Fe<=Ye)be=be.substring(0,Qn)+yn.newText+be.substring(Fe,be.length);else throw new Error("Overlapping edit");Ye=Qn}return be}p.applyEdits=v;function h(L,Q){if(L.length<=1)return L;var be=L.length/2|0,ht=L.slice(0,be),Ye=L.slice(be);h(ht,Q),h(Ye,Q);for(var an=0,yn=0,Qn=0;an<ht.length&&yn<Ye.length;){var Fe=Q(ht[an],Ye[yn]);Fe<=0?L[Qn++]=ht[an++]:L[Qn++]=Ye[yn++]}for(;an<ht.length;)L[Qn++]=ht[an++];for(;yn<Ye.length;)L[Qn++]=Ye[yn++];return L}})(xa||(t.TextDocument=xa={}));var Vl=function(){function p(C,T,v,h){this._uri=C,this._languageId=T,this._version=v,this._content=h,this._lineOffsets=void 0}return Object.defineProperty(p.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),p.prototype.getText=function(C){if(C){var T=this.offsetAt(C.start),v=this.offsetAt(C.end);return this._content.substring(T,v)}return this._content},p.prototype.update=function(C,T){this._content=C.text,this._version=T,this._lineOffsets=void 0},p.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var C=[],T=this._content,v=!0,h=0;h<T.length;h++){v&&(C.push(h),v=!1);var L=T.charAt(h);v=L==="\r"||L===`
`,L==="\r"&&h+1<T.length&&T.charAt(h+1)===`
`&&h++}v&&T.length>0&&C.push(T.length),this._lineOffsets=C}return this._lineOffsets},p.prototype.positionAt=function(C){C=Math.max(Math.min(C,this._content.length),0);var T=this.getLineOffsets(),v=0,h=T.length;if(h===0)return u.create(0,C);for(;v<h;){var L=Math.floor((v+h)/2);T[L]>C?h=L:v=L+1}var Q=v-1;return u.create(Q,C-T[Q])},p.prototype.offsetAt=function(C){var T=this.getLineOffsets();if(C.line>=T.length)return this._content.length;if(C.line<0)return 0;var v=T[C.line],h=C.line+1<T.length?T[C.line+1]:this._content.length;return Math.max(Math.min(v+C.character,h),v)},Object.defineProperty(p.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),p}(),q;(function(p){var C=Object.prototype.toString;function T(Fe){return typeof Fe<"u"}p.defined=T;function v(Fe){return typeof Fe>"u"}p.undefined=v;function h(Fe){return Fe===!0||Fe===!1}p.boolean=h;function L(Fe){return C.call(Fe)==="[object String]"}p.string=L;function Q(Fe){return C.call(Fe)==="[object Number]"}p.number=Q;function be(Fe,zr,Hi){return C.call(Fe)==="[object Number]"&&zr<=Fe&&Fe<=Hi}p.numberRange=be;function ht(Fe){return C.call(Fe)==="[object Number]"&&-2147483648<=Fe&&Fe<=2147483647}p.integer=ht;function Ye(Fe){return C.call(Fe)==="[object Number]"&&0<=Fe&&Fe<=2147483647}p.uinteger=Ye;function an(Fe){return C.call(Fe)==="[object Function]"}p.func=an;function yn(Fe){return Fe!==null&&typeof Fe=="object"}p.objectLiteral=yn;function Qn(Fe,zr){return Array.isArray(Fe)&&Fe.every(zr)}p.typedArray=Qn})(q||(q={}))})});var pt=F(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.ProtocolNotificationType=hn.ProtocolNotificationType0=hn.ProtocolRequestType=hn.ProtocolRequestType0=hn.RegistrationType=hn.MessageDirection=void 0;var go=Mi(),H_;(function(e){e.clientToServer="clientToServer",e.serverToClient="serverToClient",e.both="both"})(H_||(hn.MessageDirection=H_={}));var mh=class{constructor(t){this.method=t}};hn.RegistrationType=mh;var bh=class extends go.RequestType0{constructor(t){super(t)}};hn.ProtocolRequestType0=bh;var _h=class extends go.RequestType{constructor(t){super(t,go.ParameterStructures.byName)}};hn.ProtocolRequestType=_h;var vh=class extends go.NotificationType0{constructor(t){super(t)}};hn.ProtocolNotificationType0=vh;var yh=class extends go.NotificationType{constructor(t){super(t,go.ParameterStructures.byName)}};hn.ProtocolNotificationType=yh});var Oc=F(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.objectLiteral=Ft.typedArray=Ft.stringArray=Ft.array=Ft.func=Ft.error=Ft.number=Ft.string=Ft.boolean=void 0;function QN(e){return e===!0||e===!1}Ft.boolean=QN;function V_(e){return typeof e=="string"||e instanceof String}Ft.string=V_;function JN(e){return typeof e=="number"||e instanceof Number}Ft.number=JN;function XN(e){return e instanceof Error}Ft.error=XN;function KN(e){return typeof e=="function"}Ft.func=KN;function G_(e){return Array.isArray(e)}Ft.array=G_;function YN(e){return G_(e)&&e.every(t=>V_(t))}Ft.stringArray=YN;function ZN(e,t){return Array.isArray(e)&&e.every(t)}Ft.typedArray=ZN;function e1(e){return e!==null&&typeof e=="object"}Ft.objectLiteral=e1});var X_=F(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.ImplementationRequest=void 0;var Q_=pt(),J_;(function(e){e.method="textDocument/implementation",e.messageDirection=Q_.MessageDirection.clientToServer,e.type=new Q_.ProtocolRequestType(e.method)})(J_||(Bc.ImplementationRequest=J_={}))});var Z_=F(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.TypeDefinitionRequest=void 0;var K_=pt(),Y_;(function(e){e.method="textDocument/typeDefinition",e.messageDirection=K_.MessageDirection.clientToServer,e.type=new K_.ProtocolRequestType(e.method)})(Y_||(Uc.TypeDefinitionRequest=Y_={}))});var nv=F(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.DidChangeWorkspaceFoldersNotification=po.WorkspaceFoldersRequest=void 0;var $c=pt(),ev;(function(e){e.method="workspace/workspaceFolders",e.messageDirection=$c.MessageDirection.serverToClient,e.type=new $c.ProtocolRequestType0(e.method)})(ev||(po.WorkspaceFoldersRequest=ev={}));var tv;(function(e){e.method="workspace/didChangeWorkspaceFolders",e.messageDirection=$c.MessageDirection.clientToServer,e.type=new $c.ProtocolNotificationType(e.method)})(tv||(po.DidChangeWorkspaceFoldersNotification=tv={}))});var ov=F(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.ConfigurationRequest=void 0;var rv=pt(),iv;(function(e){e.method="workspace/configuration",e.messageDirection=rv.MessageDirection.serverToClient,e.type=new rv.ProtocolRequestType(e.method)})(iv||(Wc.ConfigurationRequest=iv={}))});var cv=F(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.ColorPresentationRequest=mo.DocumentColorRequest=void 0;var jc=pt(),sv;(function(e){e.method="textDocument/documentColor",e.messageDirection=jc.MessageDirection.clientToServer,e.type=new jc.ProtocolRequestType(e.method)})(sv||(mo.DocumentColorRequest=sv={}));var av;(function(e){e.method="textDocument/colorPresentation",e.messageDirection=jc.MessageDirection.clientToServer,e.type=new jc.ProtocolRequestType(e.method)})(av||(mo.ColorPresentationRequest=av={}))});var dv=F(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.FoldingRangeRefreshRequest=bo.FoldingRangeRequest=void 0;var zc=pt(),uv;(function(e){e.method="textDocument/foldingRange",e.messageDirection=zc.MessageDirection.clientToServer,e.type=new zc.ProtocolRequestType(e.method)})(uv||(bo.FoldingRangeRequest=uv={}));var lv;(function(e){e.method="workspace/foldingRange/refresh",e.messageDirection=zc.MessageDirection.serverToClient,e.type=new zc.ProtocolRequestType0(e.method)})(lv||(bo.FoldingRangeRefreshRequest=lv={}))});var gv=F(Hc=>{"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});Hc.DeclarationRequest=void 0;var fv=pt(),hv;(function(e){e.method="textDocument/declaration",e.messageDirection=fv.MessageDirection.clientToServer,e.type=new fv.ProtocolRequestType(e.method)})(hv||(Hc.DeclarationRequest=hv={}))});var bv=F(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});Vc.SelectionRangeRequest=void 0;var pv=pt(),mv;(function(e){e.method="textDocument/selectionRange",e.messageDirection=pv.MessageDirection.clientToServer,e.type=new pv.ProtocolRequestType(e.method)})(mv||(Vc.SelectionRangeRequest=mv={}))});var xv=F(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.WorkDoneProgressCancelNotification=oi.WorkDoneProgressCreateRequest=oi.WorkDoneProgress=void 0;var t1=Mi(),Gc=pt(),_v;(function(e){e.type=new t1.ProgressType;function t(n){return n===e.type}e.is=t})(_v||(oi.WorkDoneProgress=_v={}));var vv;(function(e){e.method="window/workDoneProgress/create",e.messageDirection=Gc.MessageDirection.serverToClient,e.type=new Gc.ProtocolRequestType(e.method)})(vv||(oi.WorkDoneProgressCreateRequest=vv={}));var yv;(function(e){e.method="window/workDoneProgress/cancel",e.messageDirection=Gc.MessageDirection.clientToServer,e.type=new Gc.ProtocolNotificationType(e.method)})(yv||(oi.WorkDoneProgressCancelNotification=yv={}))});var Cv=F(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.CallHierarchyOutgoingCallsRequest=si.CallHierarchyIncomingCallsRequest=si.CallHierarchyPrepareRequest=void 0;var _o=pt(),wv;(function(e){e.method="textDocument/prepareCallHierarchy",e.messageDirection=_o.MessageDirection.clientToServer,e.type=new _o.ProtocolRequestType(e.method)})(wv||(si.CallHierarchyPrepareRequest=wv={}));var Pv;(function(e){e.method="callHierarchy/incomingCalls",e.messageDirection=_o.MessageDirection.clientToServer,e.type=new _o.ProtocolRequestType(e.method)})(Pv||(si.CallHierarchyIncomingCallsRequest=Pv={}));var Sv;(function(e){e.method="callHierarchy/outgoingCalls",e.messageDirection=_o.MessageDirection.clientToServer,e.type=new _o.ProtocolRequestType(e.method)})(Sv||(si.CallHierarchyOutgoingCallsRequest=Sv={}))});var Iv=F(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.SemanticTokensRefreshRequest=gn.SemanticTokensRangeRequest=gn.SemanticTokensDeltaRequest=gn.SemanticTokensRequest=gn.SemanticTokensRegistrationType=gn.TokenFormat=void 0;var Lr=pt(),kv;(function(e){e.Relative="relative"})(kv||(gn.TokenFormat=kv={}));var ks;(function(e){e.method="textDocument/semanticTokens",e.type=new Lr.RegistrationType(e.method)})(ks||(gn.SemanticTokensRegistrationType=ks={}));var Rv;(function(e){e.method="textDocument/semanticTokens/full",e.messageDirection=Lr.MessageDirection.clientToServer,e.type=new Lr.ProtocolRequestType(e.method),e.registrationMethod=ks.method})(Rv||(gn.SemanticTokensRequest=Rv={}));var Tv;(function(e){e.method="textDocument/semanticTokens/full/delta",e.messageDirection=Lr.MessageDirection.clientToServer,e.type=new Lr.ProtocolRequestType(e.method),e.registrationMethod=ks.method})(Tv||(gn.SemanticTokensDeltaRequest=Tv={}));var Dv;(function(e){e.method="textDocument/semanticTokens/range",e.messageDirection=Lr.MessageDirection.clientToServer,e.type=new Lr.ProtocolRequestType(e.method),e.registrationMethod=ks.method})(Dv||(gn.SemanticTokensRangeRequest=Dv={}));var Ev;(function(e){e.method="workspace/semanticTokens/refresh",e.messageDirection=Lr.MessageDirection.serverToClient,e.type=new Lr.ProtocolRequestType0(e.method)})(Ev||(gn.SemanticTokensRefreshRequest=Ev={}))});var Mv=F(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.ShowDocumentRequest=void 0;var Fv=pt(),Av;(function(e){e.method="window/showDocument",e.messageDirection=Fv.MessageDirection.serverToClient,e.type=new Fv.ProtocolRequestType(e.method)})(Av||(Qc.ShowDocumentRequest=Av={}))});var Lv=F(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.LinkedEditingRangeRequest=void 0;var Nv=pt(),qv;(function(e){e.method="textDocument/linkedEditingRange",e.messageDirection=Nv.MessageDirection.clientToServer,e.type=new Nv.ProtocolRequestType(e.method)})(qv||(Jc.LinkedEditingRangeRequest=qv={}))});var Hv=F(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.WillDeleteFilesRequest=Xt.DidDeleteFilesNotification=Xt.DidRenameFilesNotification=Xt.WillRenameFilesRequest=Xt.DidCreateFilesNotification=Xt.WillCreateFilesRequest=Xt.FileOperationPatternKind=void 0;var Bn=pt(),Ov;(function(e){e.file="file",e.folder="folder"})(Ov||(Xt.FileOperationPatternKind=Ov={}));var Bv;(function(e){e.method="workspace/willCreateFiles",e.messageDirection=Bn.MessageDirection.clientToServer,e.type=new Bn.ProtocolRequestType(e.method)})(Bv||(Xt.WillCreateFilesRequest=Bv={}));var Uv;(function(e){e.method="workspace/didCreateFiles",e.messageDirection=Bn.MessageDirection.clientToServer,e.type=new Bn.ProtocolNotificationType(e.method)})(Uv||(Xt.DidCreateFilesNotification=Uv={}));var $v;(function(e){e.method="workspace/willRenameFiles",e.messageDirection=Bn.MessageDirection.clientToServer,e.type=new Bn.ProtocolRequestType(e.method)})($v||(Xt.WillRenameFilesRequest=$v={}));var Wv;(function(e){e.method="workspace/didRenameFiles",e.messageDirection=Bn.MessageDirection.clientToServer,e.type=new Bn.ProtocolNotificationType(e.method)})(Wv||(Xt.DidRenameFilesNotification=Wv={}));var jv;(function(e){e.method="workspace/didDeleteFiles",e.messageDirection=Bn.MessageDirection.clientToServer,e.type=new Bn.ProtocolNotificationType(e.method)})(jv||(Xt.DidDeleteFilesNotification=jv={}));var zv;(function(e){e.method="workspace/willDeleteFiles",e.messageDirection=Bn.MessageDirection.clientToServer,e.type=new Bn.ProtocolRequestType(e.method)})(zv||(Xt.WillDeleteFilesRequest=zv={}))});var Xv=F(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.MonikerRequest=ai.MonikerKind=ai.UniquenessLevel=void 0;var Vv=pt(),Gv;(function(e){e.document="document",e.project="project",e.group="group",e.scheme="scheme",e.global="global"})(Gv||(ai.UniquenessLevel=Gv={}));var Qv;(function(e){e.$import="import",e.$export="export",e.local="local"})(Qv||(ai.MonikerKind=Qv={}));var Jv;(function(e){e.method="textDocument/moniker",e.messageDirection=Vv.MessageDirection.clientToServer,e.type=new Vv.ProtocolRequestType(e.method)})(Jv||(ai.MonikerRequest=Jv={}))});var ey=F(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.TypeHierarchySubtypesRequest=ci.TypeHierarchySupertypesRequest=ci.TypeHierarchyPrepareRequest=void 0;var vo=pt(),Kv;(function(e){e.method="textDocument/prepareTypeHierarchy",e.messageDirection=vo.MessageDirection.clientToServer,e.type=new vo.ProtocolRequestType(e.method)})(Kv||(ci.TypeHierarchyPrepareRequest=Kv={}));var Yv;(function(e){e.method="typeHierarchy/supertypes",e.messageDirection=vo.MessageDirection.clientToServer,e.type=new vo.ProtocolRequestType(e.method)})(Yv||(ci.TypeHierarchySupertypesRequest=Yv={}));var Zv;(function(e){e.method="typeHierarchy/subtypes",e.messageDirection=vo.MessageDirection.clientToServer,e.type=new vo.ProtocolRequestType(e.method)})(Zv||(ci.TypeHierarchySubtypesRequest=Zv={}))});var ry=F(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.InlineValueRefreshRequest=yo.InlineValueRequest=void 0;var Xc=pt(),ty;(function(e){e.method="textDocument/inlineValue",e.messageDirection=Xc.MessageDirection.clientToServer,e.type=new Xc.ProtocolRequestType(e.method)})(ty||(yo.InlineValueRequest=ty={}));var ny;(function(e){e.method="workspace/inlineValue/refresh",e.messageDirection=Xc.MessageDirection.serverToClient,e.type=new Xc.ProtocolRequestType0(e.method)})(ny||(yo.InlineValueRefreshRequest=ny={}))});var ay=F(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.InlayHintRefreshRequest=ui.InlayHintResolveRequest=ui.InlayHintRequest=void 0;var xo=pt(),iy;(function(e){e.method="textDocument/inlayHint",e.messageDirection=xo.MessageDirection.clientToServer,e.type=new xo.ProtocolRequestType(e.method)})(iy||(ui.InlayHintRequest=iy={}));var oy;(function(e){e.method="inlayHint/resolve",e.messageDirection=xo.MessageDirection.clientToServer,e.type=new xo.ProtocolRequestType(e.method)})(oy||(ui.InlayHintResolveRequest=oy={}));var sy;(function(e){e.method="workspace/inlayHint/refresh",e.messageDirection=xo.MessageDirection.serverToClient,e.type=new xo.ProtocolRequestType0(e.method)})(sy||(ui.InlayHintRefreshRequest=sy={}))});var gy=F(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.DiagnosticRefreshRequest=Un.WorkspaceDiagnosticRequest=Un.DocumentDiagnosticRequest=Un.DocumentDiagnosticReportKind=Un.DiagnosticServerCancellationData=void 0;var hy=Mi(),n1=Oc(),wo=pt(),cy;(function(e){function t(n){let i=n;return i&&n1.boolean(i.retriggerRequest)}e.is=t})(cy||(Un.DiagnosticServerCancellationData=cy={}));var uy;(function(e){e.Full="full",e.Unchanged="unchanged"})(uy||(Un.DocumentDiagnosticReportKind=uy={}));var ly;(function(e){e.method="textDocument/diagnostic",e.messageDirection=wo.MessageDirection.clientToServer,e.type=new wo.ProtocolRequestType(e.method),e.partialResult=new hy.ProgressType})(ly||(Un.DocumentDiagnosticRequest=ly={}));var dy;(function(e){e.method="workspace/diagnostic",e.messageDirection=wo.MessageDirection.clientToServer,e.type=new wo.ProtocolRequestType(e.method),e.partialResult=new hy.ProgressType})(dy||(Un.WorkspaceDiagnosticRequest=dy={}));var fy;(function(e){e.method="workspace/diagnostic/refresh",e.messageDirection=wo.MessageDirection.serverToClient,e.type=new wo.ProtocolRequestType0(e.method)})(fy||(Un.DiagnosticRefreshRequest=fy={}))});var xy=F(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.DidCloseNotebookDocumentNotification=xt.DidSaveNotebookDocumentNotification=xt.DidChangeNotebookDocumentNotification=xt.NotebookCellArrayChange=xt.DidOpenNotebookDocumentNotification=xt.NotebookDocumentSyncRegistrationType=xt.NotebookDocument=xt.NotebookCell=xt.ExecutionSummary=xt.NotebookCellKind=void 0;var Rs=Lc(),er=Oc(),br=pt(),xh;(function(e){e.Markup=1,e.Code=2;function t(n){return n===1||n===2}e.is=t})(xh||(xt.NotebookCellKind=xh={}));var wh;(function(e){function t(o,c){let u={executionOrder:o};return(c===!0||c===!1)&&(u.success=c),u}e.create=t;function n(o){let c=o;return er.objectLiteral(c)&&Rs.uinteger.is(c.executionOrder)&&(c.success===void 0||er.boolean(c.success))}e.is=n;function i(o,c){return o===c?!0:o==null||c===null||c===void 0?!1:o.executionOrder===c.executionOrder&&o.success===c.success}e.equals=i})(wh||(xt.ExecutionSummary=wh={}));var Kc;(function(e){function t(c,u){return{kind:c,document:u}}e.create=t;function n(c){let u=c;return er.objectLiteral(u)&&xh.is(u.kind)&&Rs.DocumentUri.is(u.document)&&(u.metadata===void 0||er.objectLiteral(u.metadata))}e.is=n;function i(c,u){let f=new Set;return c.document!==u.document&&f.add("document"),c.kind!==u.kind&&f.add("kind"),c.executionSummary!==u.executionSummary&&f.add("executionSummary"),(c.metadata!==void 0||u.metadata!==void 0)&&!o(c.metadata,u.metadata)&&f.add("metadata"),(c.executionSummary!==void 0||u.executionSummary!==void 0)&&!wh.equals(c.executionSummary,u.executionSummary)&&f.add("executionSummary"),f}e.diff=i;function o(c,u){if(c===u)return!0;if(c==null||u===null||u===void 0||typeof c!=typeof u||typeof c!="object")return!1;let f=Array.isArray(c),g=Array.isArray(u);if(f!==g)return!1;if(f&&g){if(c.length!==u.length)return!1;for(let b=0;b<c.length;b++)if(!o(c[b],u[b]))return!1}if(er.objectLiteral(c)&&er.objectLiteral(u)){let b=Object.keys(c),x=Object.keys(u);if(b.length!==x.length||(b.sort(),x.sort(),!o(b,x)))return!1;for(let k=0;k<b.length;k++){let I=b[k];if(!o(c[I],u[I]))return!1}}return!0}})(Kc||(xt.NotebookCell=Kc={}));var py;(function(e){function t(i,o,c,u){return{uri:i,notebookType:o,version:c,cells:u}}e.create=t;function n(i){let o=i;return er.objectLiteral(o)&&er.string(o.uri)&&Rs.integer.is(o.version)&&er.typedArray(o.cells,Kc.is)}e.is=n})(py||(xt.NotebookDocument=py={}));var Po;(function(e){e.method="notebookDocument/sync",e.messageDirection=br.MessageDirection.clientToServer,e.type=new br.RegistrationType(e.method)})(Po||(xt.NotebookDocumentSyncRegistrationType=Po={}));var my;(function(e){e.method="notebookDocument/didOpen",e.messageDirection=br.MessageDirection.clientToServer,e.type=new br.ProtocolNotificationType(e.method),e.registrationMethod=Po.method})(my||(xt.DidOpenNotebookDocumentNotification=my={}));var by;(function(e){function t(i){let o=i;return er.objectLiteral(o)&&Rs.uinteger.is(o.start)&&Rs.uinteger.is(o.deleteCount)&&(o.cells===void 0||er.typedArray(o.cells,Kc.is))}e.is=t;function n(i,o,c){let u={start:i,deleteCount:o};return c!==void 0&&(u.cells=c),u}e.create=n})(by||(xt.NotebookCellArrayChange=by={}));var _y;(function(e){e.method="notebookDocument/didChange",e.messageDirection=br.MessageDirection.clientToServer,e.type=new br.ProtocolNotificationType(e.method),e.registrationMethod=Po.method})(_y||(xt.DidChangeNotebookDocumentNotification=_y={}));var vy;(function(e){e.method="notebookDocument/didSave",e.messageDirection=br.MessageDirection.clientToServer,e.type=new br.ProtocolNotificationType(e.method),e.registrationMethod=Po.method})(vy||(xt.DidSaveNotebookDocumentNotification=vy={}));var yy;(function(e){e.method="notebookDocument/didClose",e.messageDirection=br.MessageDirection.clientToServer,e.type=new br.ProtocolNotificationType(e.method),e.registrationMethod=Po.method})(yy||(xt.DidCloseNotebookDocumentNotification=yy={}))});var Sy=F(Yc=>{"use strict";Object.defineProperty(Yc,"__esModule",{value:!0});Yc.InlineCompletionRequest=void 0;var wy=pt(),Py;(function(e){e.method="textDocument/inlineCompletion",e.messageDirection=wy.MessageDirection.clientToServer,e.type=new wy.ProtocolRequestType(e.method)})(Py||(Yc.InlineCompletionRequest=Py={}))});var Lx=F(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.WorkspaceSymbolRequest=y.CodeActionResolveRequest=y.CodeActionRequest=y.DocumentSymbolRequest=y.DocumentHighlightRequest=y.ReferencesRequest=y.DefinitionRequest=y.SignatureHelpRequest=y.SignatureHelpTriggerKind=y.HoverRequest=y.CompletionResolveRequest=y.CompletionRequest=y.CompletionTriggerKind=y.PublishDiagnosticsNotification=y.WatchKind=y.RelativePattern=y.FileChangeType=y.DidChangeWatchedFilesNotification=y.WillSaveTextDocumentWaitUntilRequest=y.WillSaveTextDocumentNotification=y.TextDocumentSaveReason=y.DidSaveTextDocumentNotification=y.DidCloseTextDocumentNotification=y.DidChangeTextDocumentNotification=y.TextDocumentContentChangeEvent=y.DidOpenTextDocumentNotification=y.TextDocumentSyncKind=y.TelemetryEventNotification=y.LogMessageNotification=y.ShowMessageRequest=y.ShowMessageNotification=y.MessageType=y.DidChangeConfigurationNotification=y.ExitNotification=y.ShutdownRequest=y.InitializedNotification=y.InitializeErrorCodes=y.InitializeRequest=y.WorkDoneProgressOptions=y.TextDocumentRegistrationOptions=y.StaticRegistrationOptions=y.PositionEncodingKind=y.FailureHandlingKind=y.ResourceOperationKind=y.UnregistrationRequest=y.RegistrationRequest=y.DocumentSelector=y.NotebookCellTextDocumentFilter=y.NotebookDocumentFilter=y.TextDocumentFilter=void 0;y.MonikerRequest=y.MonikerKind=y.UniquenessLevel=y.WillDeleteFilesRequest=y.DidDeleteFilesNotification=y.WillRenameFilesRequest=y.DidRenameFilesNotification=y.WillCreateFilesRequest=y.DidCreateFilesNotification=y.FileOperationPatternKind=y.LinkedEditingRangeRequest=y.ShowDocumentRequest=y.SemanticTokensRegistrationType=y.SemanticTokensRefreshRequest=y.SemanticTokensRangeRequest=y.SemanticTokensDeltaRequest=y.SemanticTokensRequest=y.TokenFormat=y.CallHierarchyPrepareRequest=y.CallHierarchyOutgoingCallsRequest=y.CallHierarchyIncomingCallsRequest=y.WorkDoneProgressCancelNotification=y.WorkDoneProgressCreateRequest=y.WorkDoneProgress=y.SelectionRangeRequest=y.DeclarationRequest=y.FoldingRangeRefreshRequest=y.FoldingRangeRequest=y.ColorPresentationRequest=y.DocumentColorRequest=y.ConfigurationRequest=y.DidChangeWorkspaceFoldersNotification=y.WorkspaceFoldersRequest=y.TypeDefinitionRequest=y.ImplementationRequest=y.ApplyWorkspaceEditRequest=y.ExecuteCommandRequest=y.PrepareRenameRequest=y.RenameRequest=y.PrepareSupportDefaultBehavior=y.DocumentOnTypeFormattingRequest=y.DocumentRangesFormattingRequest=y.DocumentRangeFormattingRequest=y.DocumentFormattingRequest=y.DocumentLinkResolveRequest=y.DocumentLinkRequest=y.CodeLensRefreshRequest=y.CodeLensResolveRequest=y.CodeLensRequest=y.WorkspaceSymbolResolveRequest=void 0;y.InlineCompletionRequest=y.DidCloseNotebookDocumentNotification=y.DidSaveNotebookDocumentNotification=y.DidChangeNotebookDocumentNotification=y.NotebookCellArrayChange=y.DidOpenNotebookDocumentNotification=y.NotebookDocumentSyncRegistrationType=y.NotebookDocument=y.NotebookCell=y.ExecutionSummary=y.NotebookCellKind=y.DiagnosticRefreshRequest=y.WorkspaceDiagnosticRequest=y.DocumentDiagnosticRequest=y.DocumentDiagnosticReportKind=y.DiagnosticServerCancellationData=y.InlayHintRefreshRequest=y.InlayHintResolveRequest=y.InlayHintRequest=y.InlineValueRefreshRequest=y.InlineValueRequest=y.TypeHierarchySupertypesRequest=y.TypeHierarchySubtypesRequest=y.TypeHierarchyPrepareRequest=void 0;var Z=pt(),Cy=Lc(),Ot=Oc(),r1=X_();Object.defineProperty(y,"ImplementationRequest",{enumerable:!0,get:function(){return r1.ImplementationRequest}});var i1=Z_();Object.defineProperty(y,"TypeDefinitionRequest",{enumerable:!0,get:function(){return i1.TypeDefinitionRequest}});var Ax=nv();Object.defineProperty(y,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Ax.WorkspaceFoldersRequest}});Object.defineProperty(y,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Ax.DidChangeWorkspaceFoldersNotification}});var o1=ov();Object.defineProperty(y,"ConfigurationRequest",{enumerable:!0,get:function(){return o1.ConfigurationRequest}});var Mx=cv();Object.defineProperty(y,"DocumentColorRequest",{enumerable:!0,get:function(){return Mx.DocumentColorRequest}});Object.defineProperty(y,"ColorPresentationRequest",{enumerable:!0,get:function(){return Mx.ColorPresentationRequest}});var Nx=dv();Object.defineProperty(y,"FoldingRangeRequest",{enumerable:!0,get:function(){return Nx.FoldingRangeRequest}});Object.defineProperty(y,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return Nx.FoldingRangeRefreshRequest}});var s1=gv();Object.defineProperty(y,"DeclarationRequest",{enumerable:!0,get:function(){return s1.DeclarationRequest}});var a1=bv();Object.defineProperty(y,"SelectionRangeRequest",{enumerable:!0,get:function(){return a1.SelectionRangeRequest}});var Rh=xv();Object.defineProperty(y,"WorkDoneProgress",{enumerable:!0,get:function(){return Rh.WorkDoneProgress}});Object.defineProperty(y,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Rh.WorkDoneProgressCreateRequest}});Object.defineProperty(y,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Rh.WorkDoneProgressCancelNotification}});var Th=Cv();Object.defineProperty(y,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Th.CallHierarchyIncomingCallsRequest}});Object.defineProperty(y,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Th.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(y,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Th.CallHierarchyPrepareRequest}});var So=Iv();Object.defineProperty(y,"TokenFormat",{enumerable:!0,get:function(){return So.TokenFormat}});Object.defineProperty(y,"SemanticTokensRequest",{enumerable:!0,get:function(){return So.SemanticTokensRequest}});Object.defineProperty(y,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return So.SemanticTokensDeltaRequest}});Object.defineProperty(y,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return So.SemanticTokensRangeRequest}});Object.defineProperty(y,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return So.SemanticTokensRefreshRequest}});Object.defineProperty(y,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return So.SemanticTokensRegistrationType}});var c1=Mv();Object.defineProperty(y,"ShowDocumentRequest",{enumerable:!0,get:function(){return c1.ShowDocumentRequest}});var u1=Lv();Object.defineProperty(y,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return u1.LinkedEditingRangeRequest}});var Ni=Hv();Object.defineProperty(y,"FileOperationPatternKind",{enumerable:!0,get:function(){return Ni.FileOperationPatternKind}});Object.defineProperty(y,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Ni.DidCreateFilesNotification}});Object.defineProperty(y,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Ni.WillCreateFilesRequest}});Object.defineProperty(y,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Ni.DidRenameFilesNotification}});Object.defineProperty(y,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Ni.WillRenameFilesRequest}});Object.defineProperty(y,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Ni.DidDeleteFilesNotification}});Object.defineProperty(y,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Ni.WillDeleteFilesRequest}});var Dh=Xv();Object.defineProperty(y,"UniquenessLevel",{enumerable:!0,get:function(){return Dh.UniquenessLevel}});Object.defineProperty(y,"MonikerKind",{enumerable:!0,get:function(){return Dh.MonikerKind}});Object.defineProperty(y,"MonikerRequest",{enumerable:!0,get:function(){return Dh.MonikerRequest}});var Eh=ey();Object.defineProperty(y,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Eh.TypeHierarchyPrepareRequest}});Object.defineProperty(y,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Eh.TypeHierarchySubtypesRequest}});Object.defineProperty(y,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Eh.TypeHierarchySupertypesRequest}});var qx=ry();Object.defineProperty(y,"InlineValueRequest",{enumerable:!0,get:function(){return qx.InlineValueRequest}});Object.defineProperty(y,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return qx.InlineValueRefreshRequest}});var Ih=ay();Object.defineProperty(y,"InlayHintRequest",{enumerable:!0,get:function(){return Ih.InlayHintRequest}});Object.defineProperty(y,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Ih.InlayHintResolveRequest}});Object.defineProperty(y,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Ih.InlayHintRefreshRequest}});var Ts=gy();Object.defineProperty(y,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Ts.DiagnosticServerCancellationData}});Object.defineProperty(y,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Ts.DocumentDiagnosticReportKind}});Object.defineProperty(y,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Ts.DocumentDiagnosticRequest}});Object.defineProperty(y,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Ts.WorkspaceDiagnosticRequest}});Object.defineProperty(y,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Ts.DiagnosticRefreshRequest}});var _r=xy();Object.defineProperty(y,"NotebookCellKind",{enumerable:!0,get:function(){return _r.NotebookCellKind}});Object.defineProperty(y,"ExecutionSummary",{enumerable:!0,get:function(){return _r.ExecutionSummary}});Object.defineProperty(y,"NotebookCell",{enumerable:!0,get:function(){return _r.NotebookCell}});Object.defineProperty(y,"NotebookDocument",{enumerable:!0,get:function(){return _r.NotebookDocument}});Object.defineProperty(y,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return _r.NotebookDocumentSyncRegistrationType}});Object.defineProperty(y,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return _r.DidOpenNotebookDocumentNotification}});Object.defineProperty(y,"NotebookCellArrayChange",{enumerable:!0,get:function(){return _r.NotebookCellArrayChange}});Object.defineProperty(y,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return _r.DidChangeNotebookDocumentNotification}});Object.defineProperty(y,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return _r.DidSaveNotebookDocumentNotification}});Object.defineProperty(y,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return _r.DidCloseNotebookDocumentNotification}});var l1=Sy();Object.defineProperty(y,"InlineCompletionRequest",{enumerable:!0,get:function(){return l1.InlineCompletionRequest}});var Ph;(function(e){function t(n){let i=n;return Ot.string(i)||Ot.string(i.language)||Ot.string(i.scheme)||Ot.string(i.pattern)}e.is=t})(Ph||(y.TextDocumentFilter=Ph={}));var Sh;(function(e){function t(n){let i=n;return Ot.objectLiteral(i)&&(Ot.string(i.notebookType)||Ot.string(i.scheme)||Ot.string(i.pattern))}e.is=t})(Sh||(y.NotebookDocumentFilter=Sh={}));var Ch;(function(e){function t(n){let i=n;return Ot.objectLiteral(i)&&(Ot.string(i.notebook)||Sh.is(i.notebook))&&(i.language===void 0||Ot.string(i.language))}e.is=t})(Ch||(y.NotebookCellTextDocumentFilter=Ch={}));var kh;(function(e){function t(n){if(!Array.isArray(n))return!1;for(let i of n)if(!Ot.string(i)&&!Ph.is(i)&&!Ch.is(i))return!1;return!0}e.is=t})(kh||(y.DocumentSelector=kh={}));var ky;(function(e){e.method="client/registerCapability",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolRequestType(e.method)})(ky||(y.RegistrationRequest=ky={}));var Ry;(function(e){e.method="client/unregisterCapability",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolRequestType(e.method)})(Ry||(y.UnregistrationRequest=Ry={}));var Ty;(function(e){e.Create="create",e.Rename="rename",e.Delete="delete"})(Ty||(y.ResourceOperationKind=Ty={}));var Dy;(function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"})(Dy||(y.FailureHandlingKind=Dy={}));var Ey;(function(e){e.UTF8="utf-8",e.UTF16="utf-16",e.UTF32="utf-32"})(Ey||(y.PositionEncodingKind=Ey={}));var Iy;(function(e){function t(n){let i=n;return i&&Ot.string(i.id)&&i.id.length>0}e.hasId=t})(Iy||(y.StaticRegistrationOptions=Iy={}));var Fy;(function(e){function t(n){let i=n;return i&&(i.documentSelector===null||kh.is(i.documentSelector))}e.is=t})(Fy||(y.TextDocumentRegistrationOptions=Fy={}));var Ay;(function(e){function t(i){let o=i;return Ot.objectLiteral(o)&&(o.workDoneProgress===void 0||Ot.boolean(o.workDoneProgress))}e.is=t;function n(i){let o=i;return o&&Ot.boolean(o.workDoneProgress)}e.hasWorkDoneProgress=n})(Ay||(y.WorkDoneProgressOptions=Ay={}));var My;(function(e){e.method="initialize",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(My||(y.InitializeRequest=My={}));var Ny;(function(e){e.unknownProtocolVersion=1})(Ny||(y.InitializeErrorCodes=Ny={}));var qy;(function(e){e.method="initialized",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(qy||(y.InitializedNotification=qy={}));var Ly;(function(e){e.method="shutdown",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType0(e.method)})(Ly||(y.ShutdownRequest=Ly={}));var Oy;(function(e){e.method="exit",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType0(e.method)})(Oy||(y.ExitNotification=Oy={}));var By;(function(e){e.method="workspace/didChangeConfiguration",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(By||(y.DidChangeConfigurationNotification=By={}));var Uy;(function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4,e.Debug=5})(Uy||(y.MessageType=Uy={}));var $y;(function(e){e.method="window/showMessage",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolNotificationType(e.method)})($y||(y.ShowMessageNotification=$y={}));var Wy;(function(e){e.method="window/showMessageRequest",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolRequestType(e.method)})(Wy||(y.ShowMessageRequest=Wy={}));var jy;(function(e){e.method="window/logMessage",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolNotificationType(e.method)})(jy||(y.LogMessageNotification=jy={}));var zy;(function(e){e.method="telemetry/event",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolNotificationType(e.method)})(zy||(y.TelemetryEventNotification=zy={}));var Hy;(function(e){e.None=0,e.Full=1,e.Incremental=2})(Hy||(y.TextDocumentSyncKind=Hy={}));var Vy;(function(e){e.method="textDocument/didOpen",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(Vy||(y.DidOpenTextDocumentNotification=Vy={}));var Gy;(function(e){function t(i){let o=i;return o!=null&&typeof o.text=="string"&&o.range!==void 0&&(o.rangeLength===void 0||typeof o.rangeLength=="number")}e.isIncremental=t;function n(i){let o=i;return o!=null&&typeof o.text=="string"&&o.range===void 0&&o.rangeLength===void 0}e.isFull=n})(Gy||(y.TextDocumentContentChangeEvent=Gy={}));var Qy;(function(e){e.method="textDocument/didChange",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(Qy||(y.DidChangeTextDocumentNotification=Qy={}));var Jy;(function(e){e.method="textDocument/didClose",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(Jy||(y.DidCloseTextDocumentNotification=Jy={}));var Xy;(function(e){e.method="textDocument/didSave",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(Xy||(y.DidSaveTextDocumentNotification=Xy={}));var Ky;(function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3})(Ky||(y.TextDocumentSaveReason=Ky={}));var Yy;(function(e){e.method="textDocument/willSave",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(Yy||(y.WillSaveTextDocumentNotification=Yy={}));var Zy;(function(e){e.method="textDocument/willSaveWaitUntil",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Zy||(y.WillSaveTextDocumentWaitUntilRequest=Zy={}));var ex;(function(e){e.method="workspace/didChangeWatchedFiles",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolNotificationType(e.method)})(ex||(y.DidChangeWatchedFilesNotification=ex={}));var tx;(function(e){e.Created=1,e.Changed=2,e.Deleted=3})(tx||(y.FileChangeType=tx={}));var nx;(function(e){function t(n){let i=n;return Ot.objectLiteral(i)&&(Cy.URI.is(i.baseUri)||Cy.WorkspaceFolder.is(i.baseUri))&&Ot.string(i.pattern)}e.is=t})(nx||(y.RelativePattern=nx={}));var rx;(function(e){e.Create=1,e.Change=2,e.Delete=4})(rx||(y.WatchKind=rx={}));var ix;(function(e){e.method="textDocument/publishDiagnostics",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolNotificationType(e.method)})(ix||(y.PublishDiagnosticsNotification=ix={}));var ox;(function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3})(ox||(y.CompletionTriggerKind=ox={}));var sx;(function(e){e.method="textDocument/completion",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(sx||(y.CompletionRequest=sx={}));var ax;(function(e){e.method="completionItem/resolve",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(ax||(y.CompletionResolveRequest=ax={}));var cx;(function(e){e.method="textDocument/hover",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(cx||(y.HoverRequest=cx={}));var ux;(function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3})(ux||(y.SignatureHelpTriggerKind=ux={}));var lx;(function(e){e.method="textDocument/signatureHelp",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(lx||(y.SignatureHelpRequest=lx={}));var dx;(function(e){e.method="textDocument/definition",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(dx||(y.DefinitionRequest=dx={}));var fx;(function(e){e.method="textDocument/references",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(fx||(y.ReferencesRequest=fx={}));var hx;(function(e){e.method="textDocument/documentHighlight",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(hx||(y.DocumentHighlightRequest=hx={}));var gx;(function(e){e.method="textDocument/documentSymbol",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(gx||(y.DocumentSymbolRequest=gx={}));var px;(function(e){e.method="textDocument/codeAction",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(px||(y.CodeActionRequest=px={}));var mx;(function(e){e.method="codeAction/resolve",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(mx||(y.CodeActionResolveRequest=mx={}));var bx;(function(e){e.method="workspace/symbol",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(bx||(y.WorkspaceSymbolRequest=bx={}));var _x;(function(e){e.method="workspaceSymbol/resolve",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(_x||(y.WorkspaceSymbolResolveRequest=_x={}));var vx;(function(e){e.method="textDocument/codeLens",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(vx||(y.CodeLensRequest=vx={}));var yx;(function(e){e.method="codeLens/resolve",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(yx||(y.CodeLensResolveRequest=yx={}));var xx;(function(e){e.method="workspace/codeLens/refresh",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolRequestType0(e.method)})(xx||(y.CodeLensRefreshRequest=xx={}));var wx;(function(e){e.method="textDocument/documentLink",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(wx||(y.DocumentLinkRequest=wx={}));var Px;(function(e){e.method="documentLink/resolve",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Px||(y.DocumentLinkResolveRequest=Px={}));var Sx;(function(e){e.method="textDocument/formatting",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Sx||(y.DocumentFormattingRequest=Sx={}));var Cx;(function(e){e.method="textDocument/rangeFormatting",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Cx||(y.DocumentRangeFormattingRequest=Cx={}));var kx;(function(e){e.method="textDocument/rangesFormatting",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(kx||(y.DocumentRangesFormattingRequest=kx={}));var Rx;(function(e){e.method="textDocument/onTypeFormatting",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Rx||(y.DocumentOnTypeFormattingRequest=Rx={}));var Tx;(function(e){e.Identifier=1})(Tx||(y.PrepareSupportDefaultBehavior=Tx={}));var Dx;(function(e){e.method="textDocument/rename",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Dx||(y.RenameRequest=Dx={}));var Ex;(function(e){e.method="textDocument/prepareRename",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Ex||(y.PrepareRenameRequest=Ex={}));var Ix;(function(e){e.method="workspace/executeCommand",e.messageDirection=Z.MessageDirection.clientToServer,e.type=new Z.ProtocolRequestType(e.method)})(Ix||(y.ExecuteCommandRequest=Ix={}));var Fx;(function(e){e.method="workspace/applyEdit",e.messageDirection=Z.MessageDirection.serverToClient,e.type=new Z.ProtocolRequestType("workspace/applyEdit")})(Fx||(y.ApplyWorkspaceEditRequest=Fx={}))});var Bx=F(Zc=>{"use strict";Object.defineProperty(Zc,"__esModule",{value:!0});Zc.createProtocolConnection=void 0;var Ox=Mi();function d1(e,t,n,i){return Ox.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,Ox.createMessageConnection)(e,t,n,i)}Zc.createProtocolConnection=d1});var $x=F(pn=>{"use strict";var f1=pn&&pn.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),eu=pn&&pn.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&f1(t,e,n)};Object.defineProperty(pn,"__esModule",{value:!0});pn.LSPErrorCodes=pn.createProtocolConnection=void 0;eu(Mi(),pn);eu(Lc(),pn);eu(pt(),pn);eu(Lx(),pn);var h1=Bx();Object.defineProperty(pn,"createProtocolConnection",{enumerable:!0,get:function(){return h1.createProtocolConnection}});var Ux;(function(e){e.lspReservedErrorRangeStart=-32899,e.RequestFailed=-32803,e.ServerCancelled=-32802,e.ContentModified=-32801,e.RequestCancelled=-32800,e.lspReservedErrorRangeEnd=-32800})(Ux||(pn.LSPErrorCodes=Ux={}))});var Rt=F(vr=>{"use strict";var g1=vr&&vr.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Wx=vr&&vr.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&g1(t,e,n)};Object.defineProperty(vr,"__esModule",{value:!0});vr.createProtocolConnection=void 0;var p1=ph();Wx(ph(),vr);Wx($x(),vr);function m1(e,t,n,i){return(0,p1.createMessageConnection)(e,t,n,i)}vr.createProtocolConnection=m1});var Fh=F($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.generateUuid=$n.parse=$n.isUUID=$n.v4=$n.empty=void 0;var Ds=class{constructor(t){this._value=t}asHex(){return this._value}equals(t){return this.asHex()===t.asHex()}},Es=class e extends Ds{static _oneOf(t){return t[Math.floor(t.length*Math.random())]}static _randomHex(){return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-","4",e._randomHex(),e._randomHex(),e._randomHex(),"-",e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex()].join(""))}};Es._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];Es._timeHighBits=["8","9","a","b"];$n.empty=new Ds("00000000-0000-0000-0000-000000000000");function jx(){return new Es}$n.v4=jx;var b1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function zx(e){return b1.test(e)}$n.isUUID=zx;function _1(e){if(!zx(e))throw new Error("invalid uuid");return new Ds(e)}$n.parse=_1;function v1(){return jx().asHex()}$n.generateUuid=v1});var Hx=F(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.attachPartialResult=di.ProgressFeature=di.attachWorkDone=void 0;var li=Rt(),y1=Fh(),qi=class e{constructor(t,n){this._connection=t,this._token=n,e.Instances.set(this._token,this)}begin(t,n,i,o){let c={kind:"begin",title:t,percentage:n,message:i,cancellable:o};this._connection.sendProgress(li.WorkDoneProgress.type,this._token,c)}report(t,n){let i={kind:"report"};typeof t=="number"?(i.percentage=t,n!==void 0&&(i.message=n)):i.message=t,this._connection.sendProgress(li.WorkDoneProgress.type,this._token,i)}done(){e.Instances.delete(this._token),this._connection.sendProgress(li.WorkDoneProgress.type,this._token,{kind:"end"})}};qi.Instances=new Map;var tu=class extends qi{constructor(t,n){super(t,n),this._source=new li.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},Is=class{constructor(){}begin(){}report(){}done(){}},nu=class extends Is{constructor(){super(),this._source=new li.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function x1(e,t){if(t===void 0||t.workDoneToken===void 0)return new Is;let n=t.workDoneToken;return delete t.workDoneToken,new qi(e,n)}di.attachWorkDone=x1;var w1=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(t){super.initialize(t),t?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(li.WorkDoneProgressCancelNotification.type,n=>{let i=qi.Instances.get(n.token);(i instanceof tu||i instanceof nu)&&i.cancel()}))}attachWorkDoneProgress(t){return t===void 0?new Is:new qi(this.connection,t)}createWorkDoneProgress(){if(this._progressSupported){let t=(0,y1.generateUuid)();return this.connection.sendRequest(li.WorkDoneProgressCreateRequest.type,{token:t}).then(()=>new tu(this.connection,t))}else return Promise.resolve(new nu)}};di.ProgressFeature=w1;var Ah;(function(e){e.type=new li.ProgressType})(Ah||(Ah={}));var Mh=class{constructor(t,n){this._connection=t,this._token=n}report(t){this._connection.sendProgress(Ah.type,this._token,t)}};function P1(e,t){if(t===void 0||t.partialResultToken===void 0)return;let n=t.partialResultToken;return delete t.partialResultToken,new Mh(e,n)}di.attachPartialResult=P1});var Vx=F(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.ConfigurationFeature=void 0;var S1=Rt(),C1=gc(),k1=e=>class extends e{getConfiguration(t){return t?C1.string(t)?this._getConfiguration({section:t}):this._getConfiguration(t):this._getConfiguration({})}_getConfiguration(t){let n={items:Array.isArray(t)?t:[t]};return this.connection.sendRequest(S1.ConfigurationRequest.type,n).then(i=>Array.isArray(i)?Array.isArray(t)?i:i[0]:Array.isArray(t)?[]:null)}};ru.ConfigurationFeature=k1});var Gx=F(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.WorkspaceFoldersFeature=void 0;var iu=Rt(),R1=e=>class extends e{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(t){super.initialize(t);let n=t.workspace;n&&n.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new iu.Emitter,this.connection.onNotification(iu.DidChangeWorkspaceFoldersNotification.type,i=>{this._onDidChangeWorkspaceFolders.fire(i.event)}))}fillServerCapabilities(t){super.fillServerCapabilities(t);let n=t.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=n===!0||typeof n=="string"}getWorkspaceFolders(){return this.connection.sendRequest(iu.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(iu.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};ou.WorkspaceFoldersFeature=R1});var Qx=F(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.CallHierarchyFeature=void 0;var Nh=Rt(),T1=e=>class extends e{get callHierarchy(){return{onPrepare:t=>this.connection.onRequest(Nh.CallHierarchyPrepareRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),void 0)),onIncomingCalls:t=>{let n=Nh.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onOutgoingCalls:t=>{let n=Nh.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};su.CallHierarchyFeature=T1});var Lh=F(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.SemanticTokensBuilder=fi.SemanticTokensDiff=fi.SemanticTokensFeature=void 0;var au=Rt(),D1=e=>class extends e{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(au.SemanticTokensRefreshRequest.type),on:t=>{let n=au.SemanticTokensRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onDelta:t=>{let n=au.SemanticTokensDeltaRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onRange:t=>{let n=au.SemanticTokensRangeRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};fi.SemanticTokensFeature=D1;var cu=class{constructor(t,n){this.originalSequence=t,this.modifiedSequence=n}computeDiff(){let t=this.originalSequence.length,n=this.modifiedSequence.length,i=0;for(;i<n&&i<t&&this.originalSequence[i]===this.modifiedSequence[i];)i++;if(i<n&&i<t){let o=t-1,c=n-1;for(;o>=i&&c>=i&&this.originalSequence[o]===this.modifiedSequence[c];)o--,c--;(o<i||c<i)&&(o++,c++);let u=o-i+1,f=this.modifiedSequence.slice(i,c+1);return f.length===1&&f[0]===this.originalSequence[o]?[{start:i,deleteCount:u-1}]:[{start:i,deleteCount:u,data:f}]}else return i<n?[{start:i,deleteCount:0,data:this.modifiedSequence.slice(i)}]:i<t?[{start:i,deleteCount:t-i}]:[]}};fi.SemanticTokensDiff=cu;var qh=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(t,n,i,o,c){let u=t,f=n;this._dataLen>0&&(u-=this._prevLine,u===0&&(f-=this._prevChar)),this._data[this._dataLen++]=u,this._data[this._dataLen++]=f,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._data[this._dataLen++]=c,this._prevLine=t,this._prevChar=n}get id(){return this._id.toString()}previousResult(t){this.id===t&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new cu(this._prevData,this._data).computeDiff()}:this.build()}};fi.SemanticTokensBuilder=qh});var Jx=F(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});uu.ShowDocumentFeature=void 0;var E1=Rt(),I1=e=>class extends e{showDocument(t){return this.connection.sendRequest(E1.ShowDocumentRequest.type,t)}};uu.ShowDocumentFeature=I1});var Xx=F(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.FileOperationsFeature=void 0;var Co=Rt(),F1=e=>class extends e{onDidCreateFiles(t){return this.connection.onNotification(Co.DidCreateFilesNotification.type,n=>{t(n)})}onDidRenameFiles(t){return this.connection.onNotification(Co.DidRenameFilesNotification.type,n=>{t(n)})}onDidDeleteFiles(t){return this.connection.onNotification(Co.DidDeleteFilesNotification.type,n=>{t(n)})}onWillCreateFiles(t){return this.connection.onRequest(Co.WillCreateFilesRequest.type,(n,i)=>t(n,i))}onWillRenameFiles(t){return this.connection.onRequest(Co.WillRenameFilesRequest.type,(n,i)=>t(n,i))}onWillDeleteFiles(t){return this.connection.onRequest(Co.WillDeleteFilesRequest.type,(n,i)=>t(n,i))}};lu.FileOperationsFeature=F1});var Kx=F(du=>{"use strict";Object.defineProperty(du,"__esModule",{value:!0});du.LinkedEditingRangeFeature=void 0;var A1=Rt(),M1=e=>class extends e{onLinkedEditingRange(t){return this.connection.onRequest(A1.LinkedEditingRangeRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),void 0))}};du.LinkedEditingRangeFeature=M1});var Yx=F(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});fu.TypeHierarchyFeature=void 0;var Oh=Rt(),N1=e=>class extends e{get typeHierarchy(){return{onPrepare:t=>this.connection.onRequest(Oh.TypeHierarchyPrepareRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),void 0)),onSupertypes:t=>{let n=Oh.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onSubtypes:t=>{let n=Oh.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};fu.TypeHierarchyFeature=N1});var ew=F(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});hu.InlineValueFeature=void 0;var Zx=Rt(),q1=e=>class extends e{get inlineValue(){return{refresh:()=>this.connection.sendRequest(Zx.InlineValueRefreshRequest.type),on:t=>this.connection.onRequest(Zx.InlineValueRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n)))}}};hu.InlineValueFeature=q1});var nw=F(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.FoldingRangeFeature=void 0;var tw=Rt(),L1=e=>class extends e{get foldingRange(){return{refresh:()=>this.connection.sendRequest(tw.FoldingRangeRefreshRequest.type),on:t=>{let n=tw.FoldingRangeRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};gu.FoldingRangeFeature=L1});var rw=F(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});pu.InlayHintFeature=void 0;var Bh=Rt(),O1=e=>class extends e{get inlayHint(){return{refresh:()=>this.connection.sendRequest(Bh.InlayHintRefreshRequest.type),on:t=>this.connection.onRequest(Bh.InlayHintRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n))),resolve:t=>this.connection.onRequest(Bh.InlayHintResolveRequest.type,(n,i)=>t(n,i))}}};pu.InlayHintFeature=O1});var iw=F(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.DiagnosticFeature=void 0;var Fs=Rt(),B1=e=>class extends e{get diagnostics(){return{refresh:()=>this.connection.sendRequest(Fs.DiagnosticRefreshRequest.type),on:t=>this.connection.onRequest(Fs.DocumentDiagnosticRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(Fs.DocumentDiagnosticRequest.partialResult,n))),onWorkspace:t=>this.connection.onRequest(Fs.WorkspaceDiagnosticRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(Fs.WorkspaceDiagnosticRequest.partialResult,n)))}}};mu.DiagnosticFeature=B1});var $h=F(bu=>{"use strict";Object.defineProperty(bu,"__esModule",{value:!0});bu.TextDocuments=void 0;var Li=Rt(),Uh=class{constructor(t){this._configuration=t,this._syncedDocuments=new Map,this._onDidChangeContent=new Li.Emitter,this._onDidOpen=new Li.Emitter,this._onDidClose=new Li.Emitter,this._onDidSave=new Li.Emitter,this._onWillSave=new Li.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(t){this._willSaveWaitUntil=t}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(t){return this._syncedDocuments.get(t)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(t){t.__textDocumentSync=Li.TextDocumentSyncKind.Incremental;let n=[];return n.push(t.onDidOpenTextDocument(i=>{let o=i.textDocument,c=this._configuration.create(o.uri,o.languageId,o.version,o.text);this._syncedDocuments.set(o.uri,c);let u=Object.freeze({document:c});this._onDidOpen.fire(u),this._onDidChangeContent.fire(u)})),n.push(t.onDidChangeTextDocument(i=>{let o=i.textDocument,c=i.contentChanges;if(c.length===0)return;let{version:u}=o;if(u==null)throw new Error(`Received document change event for ${o.uri} without valid version identifier`);let f=this._syncedDocuments.get(o.uri);f!==void 0&&(f=this._configuration.update(f,c,u),this._syncedDocuments.set(o.uri,f),this._onDidChangeContent.fire(Object.freeze({document:f})))})),n.push(t.onDidCloseTextDocument(i=>{let o=this._syncedDocuments.get(i.textDocument.uri);o!==void 0&&(this._syncedDocuments.delete(i.textDocument.uri),this._onDidClose.fire(Object.freeze({document:o})))})),n.push(t.onWillSaveTextDocument(i=>{let o=this._syncedDocuments.get(i.textDocument.uri);o!==void 0&&this._onWillSave.fire(Object.freeze({document:o,reason:i.reason}))})),n.push(t.onWillSaveTextDocumentWaitUntil((i,o)=>{let c=this._syncedDocuments.get(i.textDocument.uri);return c!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:c,reason:i.reason}),o):[]})),n.push(t.onDidSaveTextDocument(i=>{let o=this._syncedDocuments.get(i.textDocument.uri);o!==void 0&&this._onDidSave.fire(Object.freeze({document:o}))})),Li.Disposable.create(()=>{n.forEach(i=>i.dispose())})}};bu.TextDocuments=Uh});var jh=F(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.NotebookDocuments=ko.NotebookSyncFeature=void 0;var Wn=Rt(),ow=$h(),U1=e=>class extends e{get synchronization(){return{onDidOpenNotebookDocument:t=>this.connection.onNotification(Wn.DidOpenNotebookDocumentNotification.type,n=>{t(n)}),onDidChangeNotebookDocument:t=>this.connection.onNotification(Wn.DidChangeNotebookDocumentNotification.type,n=>{t(n)}),onDidSaveNotebookDocument:t=>this.connection.onNotification(Wn.DidSaveNotebookDocumentNotification.type,n=>{t(n)}),onDidCloseNotebookDocument:t=>this.connection.onNotification(Wn.DidCloseNotebookDocumentNotification.type,n=>{t(n)})}}};ko.NotebookSyncFeature=U1;var _u=class e{onDidOpenTextDocument(t){return this.openHandler=t,Wn.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(t){this.openHandler&&this.openHandler(t)}onDidChangeTextDocument(t){return this.changeHandler=t,Wn.Disposable.create(()=>{this.changeHandler=t})}changeTextDocument(t){this.changeHandler&&this.changeHandler(t)}onDidCloseTextDocument(t){return this.closeHandler=t,Wn.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(t){this.closeHandler&&this.closeHandler(t)}onWillSaveTextDocument(){return e.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return e.NULL_DISPOSE}onDidSaveTextDocument(){return e.NULL_DISPOSE}};_u.NULL_DISPOSE=Object.freeze({dispose:()=>{}});var Wh=class{constructor(t){t instanceof ow.TextDocuments?this._cellTextDocuments=t:this._cellTextDocuments=new ow.TextDocuments(t),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new Wn.Emitter,this._onDidChange=new Wn.Emitter,this._onDidSave=new Wn.Emitter,this._onDidClose=new Wn.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(t){return this._cellTextDocuments.get(t.document)}getNotebookDocument(t){return this.notebookDocuments.get(t)}getNotebookCell(t){let n=this.notebookCellMap.get(t);return n&&n[0]}findNotebookDocumentForCell(t){let n=typeof t=="string"?t:t.document,i=this.notebookCellMap.get(n);return i&&i[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(t){let n=new _u,i=[];return i.push(this.cellTextDocuments.listen(n)),i.push(t.notebooks.synchronization.onDidOpenNotebookDocument(o=>{this.notebookDocuments.set(o.notebookDocument.uri,o.notebookDocument);for(let c of o.cellTextDocuments)n.openTextDocument({textDocument:c});this.updateCellMap(o.notebookDocument),this._onDidOpen.fire(o.notebookDocument)})),i.push(t.notebooks.synchronization.onDidChangeNotebookDocument(o=>{let c=this.notebookDocuments.get(o.notebookDocument.uri);if(c===void 0)return;c.version=o.notebookDocument.version;let u=c.metadata,f=!1,g=o.change;g.metadata!==void 0&&(f=!0,c.metadata=g.metadata);let b=[],x=[],k=[],I=[];if(g.cells!==void 0){let X=g.cells;if(X.structure!==void 0){let D=X.structure.array;if(c.cells.splice(D.start,D.deleteCount,...D.cells!==void 0?D.cells:[]),X.structure.didOpen!==void 0)for(let P of X.structure.didOpen)n.openTextDocument({textDocument:P}),b.push(P.uri);if(X.structure.didClose)for(let P of X.structure.didClose)n.closeTextDocument({textDocument:P}),x.push(P.uri)}if(X.data!==void 0){let D=new Map(X.data.map(P=>[P.document,P]));for(let P=0;P<=c.cells.length;P++){let U=D.get(c.cells[P].document);if(U!==void 0){let ne=c.cells.splice(P,1,U);if(k.push({old:ne[0],new:U}),D.delete(U.document),D.size===0)break}}}if(X.textContent!==void 0)for(let D of X.textContent)n.changeTextDocument({textDocument:D.document,contentChanges:D.changes}),I.push(D.document.uri)}this.updateCellMap(c);let M={notebookDocument:c};f&&(M.metadata={old:u,new:c.metadata});let N=[];for(let X of b)N.push(this.getNotebookCell(X));let B=[];for(let X of x)B.push(this.getNotebookCell(X));let W=[];for(let X of I)W.push(this.getNotebookCell(X));(N.length>0||B.length>0||k.length>0||W.length>0)&&(M.cells={added:N,removed:B,changed:{data:k,textContent:W}}),(M.metadata!==void 0||M.cells!==void 0)&&this._onDidChange.fire(M)})),i.push(t.notebooks.synchronization.onDidSaveNotebookDocument(o=>{let c=this.notebookDocuments.get(o.notebookDocument.uri);c!==void 0&&this._onDidSave.fire(c)})),i.push(t.notebooks.synchronization.onDidCloseNotebookDocument(o=>{let c=this.notebookDocuments.get(o.notebookDocument.uri);if(c!==void 0){this._onDidClose.fire(c);for(let u of o.cellTextDocuments)n.closeTextDocument({textDocument:u});this.notebookDocuments.delete(o.notebookDocument.uri);for(let u of c.cells)this.notebookCellMap.delete(u.document)}})),Wn.Disposable.create(()=>{i.forEach(o=>o.dispose())})}updateCellMap(t){for(let n of t.cells)this.notebookCellMap.set(n.document,[n,t])}};ko.NotebookDocuments=Wh});var sw=F(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});vu.MonikerFeature=void 0;var $1=Rt(),W1=e=>class extends e{get moniker(){return{on:t=>{let n=$1.MonikerRequest.type;return this.connection.onRequest(n,(i,o)=>t(i,o,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};vu.MonikerFeature=W1});var Jh=F(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.createConnection=We.combineFeatures=We.combineNotebooksFeatures=We.combineLanguagesFeatures=We.combineWorkspaceFeatures=We.combineWindowFeatures=We.combineClientFeatures=We.combineTracerFeatures=We.combineTelemetryFeatures=We.combineConsoleFeatures=We._NotebooksImpl=We._LanguagesImpl=We.BulkUnregistration=We.BulkRegistration=We.ErrorMessageTracker=void 0;var te=Rt(),jn=gc(),Hh=Fh(),ye=Hx(),j1=Vx(),z1=Gx(),H1=Qx(),V1=Lh(),G1=Jx(),Q1=Xx(),J1=Kx(),X1=Yx(),K1=ew(),Y1=nw(),Z1=rw(),eq=iw(),tq=jh(),nq=sw();function zh(e){if(e!==null)return e}var Vh=class{constructor(){this._messages=Object.create(null)}add(t){let n=this._messages[t];n||(n=0),n++,this._messages[t]=n}sendErrors(t){Object.keys(this._messages).forEach(n=>{t.window.showErrorMessage(n)})}};We.ErrorMessageTracker=Vh;var yu=class{constructor(){}rawAttach(t){this._rawConnection=t}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(t){}initialize(t){}error(t){this.send(te.MessageType.Error,t)}warn(t){this.send(te.MessageType.Warning,t)}info(t){this.send(te.MessageType.Info,t)}log(t){this.send(te.MessageType.Log,t)}debug(t){this.send(te.MessageType.Debug,t)}send(t,n){this._rawConnection&&this._rawConnection.sendNotification(te.LogMessageNotification.type,{type:t,message:n}).catch(()=>{(0,te.RAL)().console.error("Sending log message failed")})}},Gh=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}showErrorMessage(t,...n){let i={type:te.MessageType.Error,message:t,actions:n};return this.connection.sendRequest(te.ShowMessageRequest.type,i).then(zh)}showWarningMessage(t,...n){let i={type:te.MessageType.Warning,message:t,actions:n};return this.connection.sendRequest(te.ShowMessageRequest.type,i).then(zh)}showInformationMessage(t,...n){let i={type:te.MessageType.Info,message:t,actions:n};return this.connection.sendRequest(te.ShowMessageRequest.type,i).then(zh)}},aw=(0,G1.ShowDocumentFeature)((0,ye.ProgressFeature)(Gh)),cw;(function(e){function t(){return new xu}e.create=t})(cw||(We.BulkRegistration=cw={}));var xu=class{constructor(){this._registrations=[],this._registered=new Set}add(t,n){let i=jn.string(t)?t:t.method;if(this._registered.has(i))throw new Error(`${i} is already added to this registration`);let o=Hh.generateUuid();this._registrations.push({id:o,method:i,registerOptions:n||{}}),this._registered.add(i)}asRegistrationParams(){return{registrations:this._registrations}}},uw;(function(e){function t(){return new As(void 0,[])}e.create=t})(uw||(We.BulkUnregistration=uw={}));var As=class{constructor(t,n){this._connection=t,this._unregistrations=new Map,n.forEach(i=>{this._unregistrations.set(i.method,i)})}get isAttached(){return!!this._connection}attach(t){this._connection=t}add(t){this._unregistrations.set(t.method,t)}dispose(){let t=[];for(let i of this._unregistrations.values())t.push(i);let n={unregisterations:t};this._connection.sendRequest(te.UnregistrationRequest.type,n).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(t){let n=jn.string(t)?t:t.method,i=this._unregistrations.get(n);if(!i)return!1;let o={unregisterations:[i]};return this._connection.sendRequest(te.UnregistrationRequest.type,o).then(()=>{this._unregistrations.delete(n)},c=>{this._connection.console.info(`Un-registering request handler for ${i.id} failed.`)}),!0}},wu=class{attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}register(t,n,i){return t instanceof xu?this.registerMany(t):t instanceof As?this.registerSingle1(t,n,i):this.registerSingle2(t,n)}registerSingle1(t,n,i){let o=jn.string(n)?n:n.method,c=Hh.generateUuid(),u={registrations:[{id:c,method:o,registerOptions:i||{}}]};return t.isAttached||t.attach(this.connection),this.connection.sendRequest(te.RegistrationRequest.type,u).then(f=>(t.add({id:c,method:o}),t),f=>(this.connection.console.info(`Registering request handler for ${o} failed.`),Promise.reject(f)))}registerSingle2(t,n){let i=jn.string(t)?t:t.method,o=Hh.generateUuid(),c={registrations:[{id:o,method:i,registerOptions:n||{}}]};return this.connection.sendRequest(te.RegistrationRequest.type,c).then(u=>te.Disposable.create(()=>{this.unregisterSingle(o,i).catch(()=>{this.connection.console.info(`Un-registering capability with id ${o} failed.`)})}),u=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(u)))}unregisterSingle(t,n){let i={unregisterations:[{id:t,method:n}]};return this.connection.sendRequest(te.UnregistrationRequest.type,i).catch(()=>{this.connection.console.info(`Un-registering request handler for ${t} failed.`)})}registerMany(t){let n=t.asRegistrationParams();return this.connection.sendRequest(te.RegistrationRequest.type,n).then(()=>new As(this._connection,n.registrations.map(i=>({id:i.id,method:i.method}))),i=>(this.connection.console.info("Bulk registration failed."),Promise.reject(i)))}},Qh=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}applyEdit(t){function n(o){return o&&!!o.edit}let i=n(t)?t:{edit:t};return this.connection.sendRequest(te.ApplyWorkspaceEditRequest.type,i)}},lw=(0,Q1.FileOperationsFeature)((0,z1.WorkspaceFoldersFeature)((0,j1.ConfigurationFeature)(Qh))),Pu=class{constructor(){this._trace=te.Trace.Off}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}set trace(t){this._trace=t}log(t,n){this._trace!==te.Trace.Off&&this.connection.sendNotification(te.LogTraceNotification.type,{message:t,verbose:this._trace===te.Trace.Verbose?n:void 0}).catch(()=>{})}},Su=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}logEvent(t){this.connection.sendNotification(te.TelemetryEventNotification.type,t).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},Cu=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,ye.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,n){return(0,ye.attachPartialResult)(this.connection,n)}};We._LanguagesImpl=Cu;var dw=(0,Y1.FoldingRangeFeature)((0,nq.MonikerFeature)((0,eq.DiagnosticFeature)((0,Z1.InlayHintFeature)((0,K1.InlineValueFeature)((0,X1.TypeHierarchyFeature)((0,J1.LinkedEditingRangeFeature)((0,V1.SemanticTokensFeature)((0,H1.CallHierarchyFeature)(Cu))))))))),ku=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,ye.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,n){return(0,ye.attachPartialResult)(this.connection,n)}};We._NotebooksImpl=ku;var fw=(0,tq.NotebookSyncFeature)(ku);function hw(e,t){return function(n){return t(e(n))}}We.combineConsoleFeatures=hw;function gw(e,t){return function(n){return t(e(n))}}We.combineTelemetryFeatures=gw;function pw(e,t){return function(n){return t(e(n))}}We.combineTracerFeatures=pw;function mw(e,t){return function(n){return t(e(n))}}We.combineClientFeatures=mw;function bw(e,t){return function(n){return t(e(n))}}We.combineWindowFeatures=bw;function _w(e,t){return function(n){return t(e(n))}}We.combineWorkspaceFeatures=_w;function vw(e,t){return function(n){return t(e(n))}}We.combineLanguagesFeatures=vw;function yw(e,t){return function(n){return t(e(n))}}We.combineNotebooksFeatures=yw;function rq(e,t){function n(o,c,u){return o&&c?u(o,c):o||c}return{__brand:"features",console:n(e.console,t.console,hw),tracer:n(e.tracer,t.tracer,pw),telemetry:n(e.telemetry,t.telemetry,gw),client:n(e.client,t.client,mw),window:n(e.window,t.window,bw),workspace:n(e.workspace,t.workspace,_w),languages:n(e.languages,t.languages,vw),notebooks:n(e.notebooks,t.notebooks,yw)}}We.combineFeatures=rq;function iq(e,t,n){let i=n&&n.console?new(n.console(yu)):new yu,o=e(i);i.rawAttach(o);let c=n&&n.tracer?new(n.tracer(Pu)):new Pu,u=n&&n.telemetry?new(n.telemetry(Su)):new Su,f=n&&n.client?new(n.client(wu)):new wu,g=n&&n.window?new(n.window(aw)):new aw,b=n&&n.workspace?new(n.workspace(lw)):new lw,x=n&&n.languages?new(n.languages(dw)):new dw,k=n&&n.notebooks?new(n.notebooks(fw)):new fw,I=[i,c,u,f,g,b,x,k];function M(D){return D instanceof Promise?D:jn.thenable(D)?new Promise((P,U)=>{D.then(ne=>P(ne),ne=>U(ne))}):Promise.resolve(D)}let N,B,W,X={listen:()=>o.listen(),sendRequest:(D,...P)=>o.sendRequest(jn.string(D)?D:D.method,...P),onRequest:(D,P)=>o.onRequest(D,P),sendNotification:(D,P)=>{let U=jn.string(D)?D:D.method;return o.sendNotification(U,P)},onNotification:(D,P)=>o.onNotification(D,P),onProgress:o.onProgress,sendProgress:o.sendProgress,onInitialize:D=>(B=D,{dispose:()=>{B=void 0}}),onInitialized:D=>o.onNotification(te.InitializedNotification.type,D),onShutdown:D=>(N=D,{dispose:()=>{N=void 0}}),onExit:D=>(W=D,{dispose:()=>{W=void 0}}),get console(){return i},get telemetry(){return u},get tracer(){return c},get client(){return f},get window(){return g},get workspace(){return b},get languages(){return x},get notebooks(){return k},onDidChangeConfiguration:D=>o.onNotification(te.DidChangeConfigurationNotification.type,D),onDidChangeWatchedFiles:D=>o.onNotification(te.DidChangeWatchedFilesNotification.type,D),__textDocumentSync:void 0,onDidOpenTextDocument:D=>o.onNotification(te.DidOpenTextDocumentNotification.type,D),onDidChangeTextDocument:D=>o.onNotification(te.DidChangeTextDocumentNotification.type,D),onDidCloseTextDocument:D=>o.onNotification(te.DidCloseTextDocumentNotification.type,D),onWillSaveTextDocument:D=>o.onNotification(te.WillSaveTextDocumentNotification.type,D),onWillSaveTextDocumentWaitUntil:D=>o.onRequest(te.WillSaveTextDocumentWaitUntilRequest.type,D),onDidSaveTextDocument:D=>o.onNotification(te.DidSaveTextDocumentNotification.type,D),sendDiagnostics:D=>o.sendNotification(te.PublishDiagnosticsNotification.type,D),onHover:D=>o.onRequest(te.HoverRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),void 0)),onCompletion:D=>o.onRequest(te.CompletionRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onCompletionResolve:D=>o.onRequest(te.CompletionResolveRequest.type,D),onSignatureHelp:D=>o.onRequest(te.SignatureHelpRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),void 0)),onDeclaration:D=>o.onRequest(te.DeclarationRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onDefinition:D=>o.onRequest(te.DefinitionRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onTypeDefinition:D=>o.onRequest(te.TypeDefinitionRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onImplementation:D=>o.onRequest(te.ImplementationRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onReferences:D=>o.onRequest(te.ReferencesRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onDocumentHighlight:D=>o.onRequest(te.DocumentHighlightRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onDocumentSymbol:D=>o.onRequest(te.DocumentSymbolRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onWorkspaceSymbol:D=>o.onRequest(te.WorkspaceSymbolRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onWorkspaceSymbolResolve:D=>o.onRequest(te.WorkspaceSymbolResolveRequest.type,D),onCodeAction:D=>o.onRequest(te.CodeActionRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onCodeActionResolve:D=>o.onRequest(te.CodeActionResolveRequest.type,(P,U)=>D(P,U)),onCodeLens:D=>o.onRequest(te.CodeLensRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onCodeLensResolve:D=>o.onRequest(te.CodeLensResolveRequest.type,(P,U)=>D(P,U)),onDocumentFormatting:D=>o.onRequest(te.DocumentFormattingRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),void 0)),onDocumentRangeFormatting:D=>o.onRequest(te.DocumentRangeFormattingRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),void 0)),onDocumentOnTypeFormatting:D=>o.onRequest(te.DocumentOnTypeFormattingRequest.type,(P,U)=>D(P,U)),onRenameRequest:D=>o.onRequest(te.RenameRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),void 0)),onPrepareRename:D=>o.onRequest(te.PrepareRenameRequest.type,(P,U)=>D(P,U)),onDocumentLinks:D=>o.onRequest(te.DocumentLinkRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onDocumentLinkResolve:D=>o.onRequest(te.DocumentLinkResolveRequest.type,(P,U)=>D(P,U)),onDocumentColor:D=>o.onRequest(te.DocumentColorRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onColorPresentation:D=>o.onRequest(te.ColorPresentationRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onFoldingRanges:D=>o.onRequest(te.FoldingRangeRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onSelectionRanges:D=>o.onRequest(te.SelectionRangeRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),(0,ye.attachPartialResult)(o,P))),onExecuteCommand:D=>o.onRequest(te.ExecuteCommandRequest.type,(P,U)=>D(P,U,(0,ye.attachWorkDone)(o,P),void 0)),dispose:()=>o.dispose()};for(let D of I)D.attach(X);return o.onRequest(te.InitializeRequest.type,D=>{t.initialize(D),jn.string(D.trace)&&(c.trace=te.Trace.fromString(D.trace));for(let P of I)P.initialize(D.capabilities);if(B){let P=B(D,new te.CancellationTokenSource().token,(0,ye.attachWorkDone)(o,D),void 0);return M(P).then(U=>{if(U instanceof te.ResponseError)return U;let ne=U;ne||(ne={capabilities:{}});let _e=ne.capabilities;_e||(_e={},ne.capabilities=_e),_e.textDocumentSync===void 0||_e.textDocumentSync===null?_e.textDocumentSync=jn.number(X.__textDocumentSync)?X.__textDocumentSync:te.TextDocumentSyncKind.None:!jn.number(_e.textDocumentSync)&&!jn.number(_e.textDocumentSync.change)&&(_e.textDocumentSync.change=jn.number(X.__textDocumentSync)?X.__textDocumentSync:te.TextDocumentSyncKind.None);for(let Ue of I)Ue.fillServerCapabilities(_e);return ne})}else{let P={capabilities:{textDocumentSync:te.TextDocumentSyncKind.None}};for(let U of I)U.fillServerCapabilities(P.capabilities);return P}}),o.onRequest(te.ShutdownRequest.type,()=>{if(t.shutdownReceived=!0,N)return N(new te.CancellationTokenSource().token)}),o.onNotification(te.ExitNotification.type,()=>{try{W&&W()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}}),o.onNotification(te.SetTraceNotification.type,D=>{c.trace=te.Trace.fromString(D.value)}),X}We.createConnection=iq});var xw=F(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.resolveModulePath=mn.FileSystem=mn.resolveGlobalYarnPath=mn.resolveGlobalNodePath=mn.resolve=mn.uriToFilePath=void 0;var oq=require("url"),tr=require("path"),Xh=require("fs"),eg=require("child_process");function sq(e){let t=oq.parse(e);if(t.protocol!=="file:"||!t.path)return;let n=t.path.split("/");for(var i=0,o=n.length;i<o;i++)n[i]=decodeURIComponent(n[i]);if(process.platform==="win32"&&n.length>1){let c=n[0],u=n[1];c.length===0&&u.length>1&&u[1]===":"&&n.shift()}return tr.normalize(n.join("/"))}mn.uriToFilePath=sq;function Kh(){return process.platform==="win32"}function Ru(e,t,n,i){let o="NODE_PATH",c=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((u,f)=>{let g=process.env,b=Object.create(null);Object.keys(g).forEach(x=>b[x]=g[x]),t&&Xh.existsSync(t)&&(b[o]?b[o]=t+tr.delimiter+b[o]:b[o]=t,i&&i(`NODE_PATH value is: ${b[o]}`)),b.ELECTRON_RUN_AS_NODE="1";try{let x=(0,eg.fork)("",[],{cwd:n,env:b,execArgv:["-e",c]});if(x.pid===void 0){f(new Error(`Starting process to resolve node module  ${e} failed`));return}x.on("error",I=>{f(I)}),x.on("message",I=>{I.c==="r"&&(x.send({c:"e"}),I.s?u(I.r):f(new Error(`Failed to resolve module: ${e}`)))});let k={c:"rs",a:e};x.send(k)}catch(x){f(x)}})}mn.resolve=Ru;function Yh(e){let t="npm",n=Object.create(null);Object.keys(process.env).forEach(c=>n[c]=process.env[c]),n.NO_UPDATE_NOTIFIER="true";let i={encoding:"utf8",env:n};Kh()&&(t="npm.cmd",i.shell=!0);let o=()=>{};try{process.on("SIGPIPE",o);let c=(0,eg.spawnSync)(t,["config","get","prefix"],i).stdout;if(!c){e&&e("'npm config get prefix' didn't return a value.");return}let u=c.trim();return e&&e(`'npm config get prefix' value is: ${u}`),u.length>0?Kh()?tr.join(u,"node_modules"):tr.join(u,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",o)}}mn.resolveGlobalNodePath=Yh;function aq(e){let t="yarn",n={encoding:"utf8"};Kh()&&(t="yarn.cmd",n.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let o=(0,eg.spawnSync)(t,["global","dir","--json"],n),c=o.stdout;if(!c){e&&(e("'yarn global dir' didn't return a value."),o.stderr&&e(o.stderr));return}let u=c.trim().split(/\r?\n/);for(let f of u)try{let g=JSON.parse(f);if(g.type==="log")return tr.join(g.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",i)}}mn.resolveGlobalYarnPath=aq;var Zh;(function(e){let t;function n(){return t!==void 0||(process.platform==="win32"?t=!1:t=!Xh.existsSync(__filename.toUpperCase())||!Xh.existsSync(__filename.toLowerCase())),t}e.isCaseSensitive=n;function i(o,c){return n()?tr.normalize(c).indexOf(tr.normalize(o))===0:tr.normalize(c).toLowerCase().indexOf(tr.normalize(o).toLowerCase())===0}e.isParent=i})(Zh||(mn.FileSystem=Zh={}));function cq(e,t,n,i){return n?(tr.isAbsolute(n)||(n=tr.join(e,n)),Ru(t,n,n,i).then(o=>Zh.isParent(n,o)?o:Promise.reject(new Error(`Failed to load ${t} from node path location.`))).then(void 0,o=>Ru(t,Yh(i),e,i))):Ru(t,Yh(i),e,i)}mn.resolveModulePath=cq});var tg=F((TH,ww)=>{"use strict";ww.exports=Rt()});var Pw=F(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.InlineCompletionFeature=void 0;var uq=Rt(),lq=e=>class extends e{get inlineCompletion(){return{on:t=>this.connection.onRequest(uq.InlineCompletionRequest.type,(n,i)=>t(n,i,this.attachWorkDoneProgress(n)))}}};Tu.InlineCompletionFeature=lq});var kw=F(Kt=>{"use strict";var dq=Kt&&Kt.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Cw=Kt&&Kt.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&dq(t,e,n)};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.ProposedFeatures=Kt.NotebookDocuments=Kt.TextDocuments=Kt.SemanticTokensBuilder=void 0;var fq=Lh();Object.defineProperty(Kt,"SemanticTokensBuilder",{enumerable:!0,get:function(){return fq.SemanticTokensBuilder}});var hq=Pw();Cw(Rt(),Kt);var gq=$h();Object.defineProperty(Kt,"TextDocuments",{enumerable:!0,get:function(){return gq.TextDocuments}});var pq=jh();Object.defineProperty(Kt,"NotebookDocuments",{enumerable:!0,get:function(){return pq.NotebookDocuments}});Cw(Jh(),Kt);var Sw;(function(e){e.all={__brand:"features",languages:hq.InlineCompletionFeature}})(Sw||(Kt.ProposedFeatures=Sw={}))});var Fw=F(zn=>{"use strict";var mq=zn&&zn.__createBinding||(Object.create?function(e,t,n,i){i===void 0&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){i===void 0&&(i=n),e[i]=t[n]}),Ew=zn&&zn.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&mq(t,e,n)};Object.defineProperty(zn,"__esModule",{value:!0});zn.createConnection=zn.Files=void 0;var Rw=require("node:util"),ng=gc(),bq=Jh(),Ms=xw(),Oi=tg();Ew(tg(),zn);Ew(kw(),zn);var Tw;(function(e){e.uriToFilePath=Ms.uriToFilePath,e.resolveGlobalNodePath=Ms.resolveGlobalNodePath,e.resolveGlobalYarnPath=Ms.resolveGlobalYarnPath,e.resolve=Ms.resolve,e.resolveModulePath=Ms.resolveModulePath})(Tw||(zn.Files=Tw={}));var Dw;function Du(){if(Dw!==void 0)try{Dw.end()}catch{}}var Ro=!1,Iw;function _q(){let e="--clientProcessId";function t(n){try{let i=parseInt(n);isNaN(i)||(Iw=setInterval(()=>{try{process.kill(i,0)}catch{Du(),process.exit(Ro?0:1)}},3e3))}catch{}}for(let n=2;n<process.argv.length;n++){let i=process.argv[n];if(i===e&&n+1<process.argv.length){t(process.argv[n+1]);return}else{let o=i.split("=");o[0]===e&&t(o[1])}}}_q();var vq={initialize:e=>{let t=e.processId;ng.number(t)&&Iw===void 0&&setInterval(()=>{try{process.kill(t,0)}catch{process.exit(Ro?0:1)}},3e3)},get shutdownReceived(){return Ro},set shutdownReceived(e){Ro=e},exit:e=>{Du(),process.exit(e)}};function yq(e,t,n,i){let o,c,u,f;return e!==void 0&&e.__brand==="features"&&(o=e,e=t,t=n,n=i),Oi.ConnectionStrategy.is(e)||Oi.ConnectionOptions.is(e)?f=e:(c=e,u=t,f=n),xq(c,u,f,o)}zn.createConnection=yq;function xq(e,t,n,i){let o=!1;if(!e&&!t&&process.argv.length>2){let g,b,x=process.argv.slice(2);for(let k=0;k<x.length;k++){let I=x[k];if(I==="--node-ipc"){e=new Oi.IPCMessageReader(process),t=new Oi.IPCMessageWriter(process);break}else if(I==="--stdio"){o=!0,e=process.stdin,t=process.stdout;break}else if(I==="--socket"){g=parseInt(x[k+1]);break}else if(I==="--pipe"){b=x[k+1];break}else{var c=I.split("=");if(c[0]==="--socket"){g=parseInt(c[1]);break}else if(c[0]==="--pipe"){b=c[1];break}}}if(g){let k=(0,Oi.createServerSocketTransport)(g);e=k[0],t=k[1]}else if(b){let k=(0,Oi.createServerPipeTransport)(b);e=k[0],t=k[1]}}var u="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+u);if(!t)throw new Error("Connection output stream is not set. "+u);if(ng.func(e.read)&&ng.func(e.on)){let g=e;g.on("end",()=>{Du(),process.exit(Ro?0:1)}),g.on("close",()=>{Du(),process.exit(Ro?0:1)})}let f=g=>{let b=(0,Oi.createProtocolConnection)(e,t,g,n);return o&&wq(g),b};return(0,bq.createConnection)(f,vq,i)}function wq(e){function t(i){return i.map(o=>typeof o=="string"?o:(0,Rw.inspect)(o)).join(" ")}let n=new Map;console.assert=function(o,...c){if(!o)if(c.length===0)e.error("Assertion failed");else{let[u,...f]=c;e.error(`Assertion failed: ${u} ${t(f)}`)}},console.count=function(o="default"){let c=String(o),u=n.get(c)??0;u+=1,n.set(c,u),e.log(`${c}: ${c}`)},console.countReset=function(o){o===void 0?n.clear():n.delete(String(o))},console.debug=function(...o){e.log(t(o))},console.dir=function(o,c){e.log((0,Rw.inspect)(o,c))},console.log=function(...o){e.log(t(o))},console.error=function(...o){e.error(t(o))},console.trace=function(...o){let c=new Error().stack.replace(/(.+\n){2}/,""),u="Trace";o.length!==0&&(u+=`: ${t(o)}`),e.log(`${u}
${c}`)},console.warn=function(...o){e.warn(t(o))}}});var Mw=F((AH,Aw)=>{"use strict";Aw.exports=Fw()});var Uw=F((QH,Bw)=>{"use strict";function Tq(){this.__data__=[],this.size=0}Bw.exports=Tq});var sg=F((JH,$w)=>{"use strict";function Dq(e,t){return e===t||e!==e&&t!==t}$w.exports=Dq});var qs=F((XH,Ww)=>{"use strict";var Eq=sg();function Iq(e,t){for(var n=e.length;n--;)if(Eq(e[n][0],t))return n;return-1}Ww.exports=Iq});var zw=F((KH,jw)=>{"use strict";var Fq=qs(),Aq=Array.prototype,Mq=Aq.splice;function Nq(e){var t=this.__data__,n=Fq(t,e);if(n<0)return!1;var i=t.length-1;return n==i?t.pop():Mq.call(t,n,1),--this.size,!0}jw.exports=Nq});var Vw=F((YH,Hw)=>{"use strict";var qq=qs();function Lq(e){var t=this.__data__,n=qq(t,e);return n<0?void 0:t[n][1]}Hw.exports=Lq});var Qw=F((ZH,Gw)=>{"use strict";var Oq=qs();function Bq(e){return Oq(this.__data__,e)>-1}Gw.exports=Bq});var Xw=F((e3,Jw)=>{"use strict";var Uq=qs();function $q(e,t){var n=this.__data__,i=Uq(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}Jw.exports=$q});var Ls=F((t3,Kw)=>{"use strict";var Wq=Uw(),jq=zw(),zq=Vw(),Hq=Qw(),Vq=Xw();function Io(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Io.prototype.clear=Wq;Io.prototype.delete=jq;Io.prototype.get=zq;Io.prototype.has=Hq;Io.prototype.set=Vq;Kw.exports=Io});var Zw=F((n3,Yw)=>{"use strict";var Gq=Ls();function Qq(){this.__data__=new Gq,this.size=0}Yw.exports=Qq});var tP=F((r3,eP)=>{"use strict";function Jq(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}eP.exports=Jq});var rP=F((i3,nP)=>{"use strict";function Xq(e){return this.__data__.get(e)}nP.exports=Xq});var oP=F((o3,iP)=>{"use strict";function Kq(e){return this.__data__.has(e)}iP.exports=Kq});var ag=F((s3,sP)=>{"use strict";var Yq=typeof global=="object"&&global&&global.Object===Object&&global;sP.exports=Yq});var nr=F((a3,aP)=>{"use strict";var Zq=ag(),eL=typeof self=="object"&&self&&self.Object===Object&&self,tL=Zq||eL||Function("return this")();aP.exports=tL});var Fu=F((c3,cP)=>{"use strict";var nL=nr(),rL=nL.Symbol;cP.exports=rL});var fP=F((u3,dP)=>{"use strict";var uP=Fu(),lP=Object.prototype,iL=lP.hasOwnProperty,oL=lP.toString,Os=uP?uP.toStringTag:void 0;function sL(e){var t=iL.call(e,Os),n=e[Os];try{e[Os]=void 0;var i=!0}catch{}var o=oL.call(e);return i&&(t?e[Os]=n:delete e[Os]),o}dP.exports=sL});var gP=F((l3,hP)=>{"use strict";var aL=Object.prototype,cL=aL.toString;function uL(e){return cL.call(e)}hP.exports=uL});var Bs=F((d3,bP)=>{"use strict";var pP=Fu(),lL=fP(),dL=gP(),fL="[object Null]",hL="[object Undefined]",mP=pP?pP.toStringTag:void 0;function gL(e){return e==null?e===void 0?hL:fL:mP&&mP in Object(e)?lL(e):dL(e)}bP.exports=gL});var Fo=F((f3,_P)=>{"use strict";function pL(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}_P.exports=pL});var cg=F((h3,vP)=>{"use strict";var mL=Bs(),bL=Fo(),_L="[object AsyncFunction]",vL="[object Function]",yL="[object GeneratorFunction]",xL="[object Proxy]";function wL(e){if(!bL(e))return!1;var t=mL(e);return t==vL||t==yL||t==_L||t==xL}vP.exports=wL});var xP=F((g3,yP)=>{"use strict";var PL=nr(),SL=PL["__core-js_shared__"];yP.exports=SL});var SP=F((p3,PP)=>{"use strict";var ug=xP(),wP=function(){var e=/[^.]+$/.exec(ug&&ug.keys&&ug.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function CL(e){return!!wP&&wP in e}PP.exports=CL});var lg=F((m3,CP)=>{"use strict";var kL=Function.prototype,RL=kL.toString;function TL(e){if(e!=null){try{return RL.call(e)}catch{}try{return e+""}catch{}}return""}CP.exports=TL});var RP=F((b3,kP)=>{"use strict";var DL=cg(),EL=SP(),IL=Fo(),FL=lg(),AL=/[\\^$.*+?()[\]{}|]/g,ML=/^\[object .+?Constructor\]$/,NL=Function.prototype,qL=Object.prototype,LL=NL.toString,OL=qL.hasOwnProperty,BL=RegExp("^"+LL.call(OL).replace(AL,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function UL(e){if(!IL(e)||EL(e))return!1;var t=DL(e)?BL:ML;return t.test(FL(e))}kP.exports=UL});var DP=F((_3,TP)=>{"use strict";function $L(e,t){return e?.[t]}TP.exports=$L});var hi=F((v3,EP)=>{"use strict";var WL=RP(),jL=DP();function zL(e,t){var n=jL(e,t);return WL(n)?n:void 0}EP.exports=zL});var Au=F((y3,IP)=>{"use strict";var HL=hi(),VL=nr(),GL=HL(VL,"Map");IP.exports=GL});var Us=F((x3,FP)=>{"use strict";var QL=hi(),JL=QL(Object,"create");FP.exports=JL});var NP=F((w3,MP)=>{"use strict";var AP=Us();function XL(){this.__data__=AP?AP(null):{},this.size=0}MP.exports=XL});var LP=F((P3,qP)=>{"use strict";function KL(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}qP.exports=KL});var BP=F((S3,OP)=>{"use strict";var YL=Us(),ZL="__lodash_hash_undefined__",eO=Object.prototype,tO=eO.hasOwnProperty;function nO(e){var t=this.__data__;if(YL){var n=t[e];return n===ZL?void 0:n}return tO.call(t,e)?t[e]:void 0}OP.exports=nO});var $P=F((C3,UP)=>{"use strict";var rO=Us(),iO=Object.prototype,oO=iO.hasOwnProperty;function sO(e){var t=this.__data__;return rO?t[e]!==void 0:oO.call(t,e)}UP.exports=sO});var jP=F((k3,WP)=>{"use strict";var aO=Us(),cO="__lodash_hash_undefined__";function uO(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=aO&&t===void 0?cO:t,this}WP.exports=uO});var HP=F((R3,zP)=>{"use strict";var lO=NP(),dO=LP(),fO=BP(),hO=$P(),gO=jP();function Ao(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Ao.prototype.clear=lO;Ao.prototype.delete=dO;Ao.prototype.get=fO;Ao.prototype.has=hO;Ao.prototype.set=gO;zP.exports=Ao});var QP=F((T3,GP)=>{"use strict";var VP=HP(),pO=Ls(),mO=Au();function bO(){this.size=0,this.__data__={hash:new VP,map:new(mO||pO),string:new VP}}GP.exports=bO});var XP=F((D3,JP)=>{"use strict";function _O(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}JP.exports=_O});var $s=F((E3,KP)=>{"use strict";var vO=XP();function yO(e,t){var n=e.__data__;return vO(t)?n[typeof t=="string"?"string":"hash"]:n.map}KP.exports=yO});var ZP=F((I3,YP)=>{"use strict";var xO=$s();function wO(e){var t=xO(this,e).delete(e);return this.size-=t?1:0,t}YP.exports=wO});var tS=F((F3,eS)=>{"use strict";var PO=$s();function SO(e){return PO(this,e).get(e)}eS.exports=SO});var rS=F((A3,nS)=>{"use strict";var CO=$s();function kO(e){return CO(this,e).has(e)}nS.exports=kO});var oS=F((M3,iS)=>{"use strict";var RO=$s();function TO(e,t){var n=RO(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}iS.exports=TO});var aS=F((N3,sS)=>{"use strict";var DO=QP(),EO=ZP(),IO=tS(),FO=rS(),AO=oS();function Mo(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Mo.prototype.clear=DO;Mo.prototype.delete=EO;Mo.prototype.get=IO;Mo.prototype.has=FO;Mo.prototype.set=AO;sS.exports=Mo});var uS=F((q3,cS)=>{"use strict";var MO=Ls(),NO=Au(),qO=aS(),LO=200;function OO(e,t){var n=this.__data__;if(n instanceof MO){var i=n.__data__;if(!NO||i.length<LO-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new qO(i)}return n.set(e,t),this.size=n.size,this}cS.exports=OO});var dS=F((L3,lS)=>{"use strict";var BO=Ls(),UO=Zw(),$O=tP(),WO=rP(),jO=oP(),zO=uS();function No(e){var t=this.__data__=new BO(e);this.size=t.size}No.prototype.clear=UO;No.prototype.delete=$O;No.prototype.get=WO;No.prototype.has=jO;No.prototype.set=zO;lS.exports=No});var hS=F((O3,fS)=>{"use strict";function HO(e,t){for(var n=-1,i=e==null?0:e.length;++n<i&&t(e[n],n,e)!==!1;);return e}fS.exports=HO});var pS=F((B3,gS)=>{"use strict";var VO=hi(),GO=function(){try{var e=VO(Object,"defineProperty");return e({},"",{}),e}catch{}}();gS.exports=GO});var dg=F((U3,bS)=>{"use strict";var mS=pS();function QO(e,t,n){t=="__proto__"&&mS?mS(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}bS.exports=QO});var fg=F(($3,_S)=>{"use strict";var JO=dg(),XO=sg(),KO=Object.prototype,YO=KO.hasOwnProperty;function ZO(e,t,n){var i=e[t];(!(YO.call(e,t)&&XO(i,n))||n===void 0&&!(t in e))&&JO(e,t,n)}_S.exports=ZO});var Ws=F((W3,vS)=>{"use strict";var eB=fg(),tB=dg();function nB(e,t,n,i){var o=!n;n||(n={});for(var c=-1,u=t.length;++c<u;){var f=t[c],g=i?i(n[f],e[f],f,n,e):void 0;g===void 0&&(g=e[f]),o?tB(n,f,g):eB(n,f,g)}return n}vS.exports=nB});var xS=F((j3,yS)=>{"use strict";function rB(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}yS.exports=rB});var qo=F((z3,wS)=>{"use strict";function iB(e){return e!=null&&typeof e=="object"}wS.exports=iB});var SS=F((H3,PS)=>{"use strict";var oB=Bs(),sB=qo(),aB="[object Arguments]";function cB(e){return sB(e)&&oB(e)==aB}PS.exports=cB});var TS=F((V3,RS)=>{"use strict";var CS=SS(),uB=qo(),kS=Object.prototype,lB=kS.hasOwnProperty,dB=kS.propertyIsEnumerable,fB=CS(function(){return arguments}())?CS:function(e){return uB(e)&&lB.call(e,"callee")&&!dB.call(e,"callee")};RS.exports=fB});var Mu=F((G3,DS)=>{"use strict";var hB=Array.isArray;DS.exports=hB});var IS=F((Q3,ES)=>{"use strict";function gB(){return!1}ES.exports=gB});var hg=F((js,Lo)=>{"use strict";var pB=nr(),mB=IS(),MS=typeof js=="object"&&js&&!js.nodeType&&js,FS=MS&&typeof Lo=="object"&&Lo&&!Lo.nodeType&&Lo,bB=FS&&FS.exports===MS,AS=bB?pB.Buffer:void 0,_B=AS?AS.isBuffer:void 0,vB=_B||mB;Lo.exports=vB});var qS=F((J3,NS)=>{"use strict";var yB=9007199254740991,xB=/^(?:0|[1-9]\d*)$/;function wB(e,t){var n=typeof e;return t=t??yB,!!t&&(n=="number"||n!="symbol"&&xB.test(e))&&e>-1&&e%1==0&&e<t}NS.exports=wB});var gg=F((X3,LS)=>{"use strict";var PB=9007199254740991;function SB(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=PB}LS.exports=SB});var BS=F((K3,OS)=>{"use strict";var CB=Bs(),kB=gg(),RB=qo(),TB="[object Arguments]",DB="[object Array]",EB="[object Boolean]",IB="[object Date]",FB="[object Error]",AB="[object Function]",MB="[object Map]",NB="[object Number]",qB="[object Object]",LB="[object RegExp]",OB="[object Set]",BB="[object String]",UB="[object WeakMap]",$B="[object ArrayBuffer]",WB="[object DataView]",jB="[object Float32Array]",zB="[object Float64Array]",HB="[object Int8Array]",VB="[object Int16Array]",GB="[object Int32Array]",QB="[object Uint8Array]",JB="[object Uint8ClampedArray]",XB="[object Uint16Array]",KB="[object Uint32Array]",lt={};lt[jB]=lt[zB]=lt[HB]=lt[VB]=lt[GB]=lt[QB]=lt[JB]=lt[XB]=lt[KB]=!0;lt[TB]=lt[DB]=lt[$B]=lt[EB]=lt[WB]=lt[IB]=lt[FB]=lt[AB]=lt[MB]=lt[NB]=lt[qB]=lt[LB]=lt[OB]=lt[BB]=lt[UB]=!1;function YB(e){return RB(e)&&kB(e.length)&&!!lt[CB(e)]}OS.exports=YB});var Nu=F((Y3,US)=>{"use strict";function ZB(e){return function(t){return e(t)}}US.exports=ZB});var qu=F((zs,Oo)=>{"use strict";var eU=ag(),$S=typeof zs=="object"&&zs&&!zs.nodeType&&zs,Hs=$S&&typeof Oo=="object"&&Oo&&!Oo.nodeType&&Oo,tU=Hs&&Hs.exports===$S,pg=tU&&eU.process,nU=function(){try{var e=Hs&&Hs.require&&Hs.require("util").types;return e||pg&&pg.binding&&pg.binding("util")}catch{}}();Oo.exports=nU});var HS=F((Z3,zS)=>{"use strict";var rU=BS(),iU=Nu(),WS=qu(),jS=WS&&WS.isTypedArray,oU=jS?iU(jS):rU;zS.exports=oU});var mg=F((e4,VS)=>{"use strict";var sU=xS(),aU=TS(),cU=Mu(),uU=hg(),lU=qS(),dU=HS(),fU=Object.prototype,hU=fU.hasOwnProperty;function gU(e,t){var n=cU(e),i=!n&&aU(e),o=!n&&!i&&uU(e),c=!n&&!i&&!o&&dU(e),u=n||i||o||c,f=u?sU(e.length,String):[],g=f.length;for(var b in e)(t||hU.call(e,b))&&!(u&&(b=="length"||o&&(b=="offset"||b=="parent")||c&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||lU(b,g)))&&f.push(b);return f}VS.exports=gU});var Lu=F((t4,GS)=>{"use strict";var pU=Object.prototype;function mU(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||pU;return e===n}GS.exports=mU});var bg=F((n4,QS)=>{"use strict";function bU(e,t){return function(n){return e(t(n))}}QS.exports=bU});var XS=F((r4,JS)=>{"use strict";var _U=bg(),vU=_U(Object.keys,Object);JS.exports=vU});var YS=F((i4,KS)=>{"use strict";var yU=Lu(),xU=XS(),wU=Object.prototype,PU=wU.hasOwnProperty;function SU(e){if(!yU(e))return xU(e);var t=[];for(var n in Object(e))PU.call(e,n)&&n!="constructor"&&t.push(n);return t}KS.exports=SU});var _g=F((o4,ZS)=>{"use strict";var CU=cg(),kU=gg();function RU(e){return e!=null&&kU(e.length)&&!CU(e)}ZS.exports=RU});var Ou=F((s4,eC)=>{"use strict";var TU=mg(),DU=YS(),EU=_g();function IU(e){return EU(e)?TU(e):DU(e)}eC.exports=IU});var nC=F((a4,tC)=>{"use strict";var FU=Ws(),AU=Ou();function MU(e,t){return e&&FU(t,AU(t),e)}tC.exports=MU});var iC=F((c4,rC)=>{"use strict";function NU(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}rC.exports=NU});var sC=F((u4,oC)=>{"use strict";var qU=Fo(),LU=Lu(),OU=iC(),BU=Object.prototype,UU=BU.hasOwnProperty;function $U(e){if(!qU(e))return OU(e);var t=LU(e),n=[];for(var i in e)i=="constructor"&&(t||!UU.call(e,i))||n.push(i);return n}oC.exports=$U});var Bu=F((l4,aC)=>{"use strict";var WU=mg(),jU=sC(),zU=_g();function HU(e){return zU(e)?WU(e,!0):jU(e)}aC.exports=HU});var uC=F((d4,cC)=>{"use strict";var VU=Ws(),GU=Bu();function QU(e,t){return e&&VU(t,GU(t),e)}cC.exports=QU});var gC=F((Vs,Bo)=>{"use strict";var JU=nr(),hC=typeof Vs=="object"&&Vs&&!Vs.nodeType&&Vs,lC=hC&&typeof Bo=="object"&&Bo&&!Bo.nodeType&&Bo,XU=lC&&lC.exports===hC,dC=XU?JU.Buffer:void 0,fC=dC?dC.allocUnsafe:void 0;function KU(e,t){if(t)return e.slice();var n=e.length,i=fC?fC(n):new e.constructor(n);return e.copy(i),i}Bo.exports=KU});var mC=F((f4,pC)=>{"use strict";function YU(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}pC.exports=YU});var _C=F((h4,bC)=>{"use strict";function ZU(e,t){for(var n=-1,i=e==null?0:e.length,o=0,c=[];++n<i;){var u=e[n];t(u,n,e)&&(c[o++]=u)}return c}bC.exports=ZU});var vg=F((g4,vC)=>{"use strict";function e$(){return[]}vC.exports=e$});var Uu=F((p4,xC)=>{"use strict";var t$=_C(),n$=vg(),r$=Object.prototype,i$=r$.propertyIsEnumerable,yC=Object.getOwnPropertySymbols,o$=yC?function(e){return e==null?[]:(e=Object(e),t$(yC(e),function(t){return i$.call(e,t)}))}:n$;xC.exports=o$});var PC=F((m4,wC)=>{"use strict";var s$=Ws(),a$=Uu();function c$(e,t){return s$(e,a$(e),t)}wC.exports=c$});var yg=F((b4,SC)=>{"use strict";function u$(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e}SC.exports=u$});var xg=F((_4,CC)=>{"use strict";var l$=bg(),d$=l$(Object.getPrototypeOf,Object);CC.exports=d$});var wg=F((v4,kC)=>{"use strict";var f$=yg(),h$=xg(),g$=Uu(),p$=vg(),m$=Object.getOwnPropertySymbols,b$=m$?function(e){for(var t=[];e;)f$(t,g$(e)),e=h$(e);return t}:p$;kC.exports=b$});var TC=F((y4,RC)=>{"use strict";var _$=Ws(),v$=wg();function y$(e,t){return _$(e,v$(e),t)}RC.exports=y$});var Pg=F((x4,DC)=>{"use strict";var x$=yg(),w$=Mu();function P$(e,t,n){var i=t(e);return w$(e)?i:x$(i,n(e))}DC.exports=P$});var IC=F((w4,EC)=>{"use strict";var S$=Pg(),C$=Uu(),k$=Ou();function R$(e){return S$(e,k$,C$)}EC.exports=R$});var AC=F((P4,FC)=>{"use strict";var T$=Pg(),D$=wg(),E$=Bu();function I$(e){return T$(e,E$,D$)}FC.exports=I$});var NC=F((S4,MC)=>{"use strict";var F$=hi(),A$=nr(),M$=F$(A$,"DataView");MC.exports=M$});var LC=F((C4,qC)=>{"use strict";var N$=hi(),q$=nr(),L$=N$(q$,"Promise");qC.exports=L$});var BC=F((k4,OC)=>{"use strict";var O$=hi(),B$=nr(),U$=O$(B$,"Set");OC.exports=U$});var $C=F((R4,UC)=>{"use strict";var $$=hi(),W$=nr(),j$=$$(W$,"WeakMap");UC.exports=j$});var $u=F((T4,QC)=>{"use strict";var Sg=NC(),Cg=Au(),kg=LC(),Rg=BC(),Tg=$C(),GC=Bs(),Uo=lg(),WC="[object Map]",z$="[object Object]",jC="[object Promise]",zC="[object Set]",HC="[object WeakMap]",VC="[object DataView]",H$=Uo(Sg),V$=Uo(Cg),G$=Uo(kg),Q$=Uo(Rg),J$=Uo(Tg),Bi=GC;(Sg&&Bi(new Sg(new ArrayBuffer(1)))!=VC||Cg&&Bi(new Cg)!=WC||kg&&Bi(kg.resolve())!=jC||Rg&&Bi(new Rg)!=zC||Tg&&Bi(new Tg)!=HC)&&(Bi=function(e){var t=GC(e),n=t==z$?e.constructor:void 0,i=n?Uo(n):"";if(i)switch(i){case H$:return VC;case V$:return WC;case G$:return jC;case Q$:return zC;case J$:return HC}return t});QC.exports=Bi});var XC=F((D4,JC)=>{"use strict";var X$=Object.prototype,K$=X$.hasOwnProperty;function Y$(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&K$.call(e,"index")&&(n.index=e.index,n.input=e.input),n}JC.exports=Y$});var YC=F((E4,KC)=>{"use strict";var Z$=nr(),eW=Z$.Uint8Array;KC.exports=eW});var Wu=F((I4,ek)=>{"use strict";var ZC=YC();function tW(e){var t=new e.constructor(e.byteLength);return new ZC(t).set(new ZC(e)),t}ek.exports=tW});var nk=F((F4,tk)=>{"use strict";var nW=Wu();function rW(e,t){var n=t?nW(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}tk.exports=rW});var ik=F((A4,rk)=>{"use strict";var iW=/\w*$/;function oW(e){var t=new e.constructor(e.source,iW.exec(e));return t.lastIndex=e.lastIndex,t}rk.exports=oW});var uk=F((M4,ck)=>{"use strict";var ok=Fu(),sk=ok?ok.prototype:void 0,ak=sk?sk.valueOf:void 0;function sW(e){return ak?Object(ak.call(e)):{}}ck.exports=sW});var dk=F((N4,lk)=>{"use strict";var aW=Wu();function cW(e,t){var n=t?aW(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}lk.exports=cW});var hk=F((q4,fk)=>{"use strict";var uW=Wu(),lW=nk(),dW=ik(),fW=uk(),hW=dk(),gW="[object Boolean]",pW="[object Date]",mW="[object Map]",bW="[object Number]",_W="[object RegExp]",vW="[object Set]",yW="[object String]",xW="[object Symbol]",wW="[object ArrayBuffer]",PW="[object DataView]",SW="[object Float32Array]",CW="[object Float64Array]",kW="[object Int8Array]",RW="[object Int16Array]",TW="[object Int32Array]",DW="[object Uint8Array]",EW="[object Uint8ClampedArray]",IW="[object Uint16Array]",FW="[object Uint32Array]";function AW(e,t,n){var i=e.constructor;switch(t){case wW:return uW(e);case gW:case pW:return new i(+e);case PW:return lW(e,n);case SW:case CW:case kW:case RW:case TW:case DW:case EW:case IW:case FW:return hW(e,n);case mW:return new i;case bW:case yW:return new i(e);case _W:return dW(e);case vW:return new i;case xW:return fW(e)}}fk.exports=AW});var mk=F((L4,pk)=>{"use strict";var MW=Fo(),gk=Object.create,NW=function(){function e(){}return function(t){if(!MW(t))return{};if(gk)return gk(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();pk.exports=NW});var _k=F((O4,bk)=>{"use strict";var qW=mk(),LW=xg(),OW=Lu();function BW(e){return typeof e.constructor=="function"&&!OW(e)?qW(LW(e)):{}}bk.exports=BW});var yk=F((B4,vk)=>{"use strict";var UW=$u(),$W=qo(),WW="[object Map]";function jW(e){return $W(e)&&UW(e)==WW}vk.exports=jW});var Sk=F((U4,Pk)=>{"use strict";var zW=yk(),HW=Nu(),xk=qu(),wk=xk&&xk.isMap,VW=wk?HW(wk):zW;Pk.exports=VW});var kk=F(($4,Ck)=>{"use strict";var GW=$u(),QW=qo(),JW="[object Set]";function XW(e){return QW(e)&&GW(e)==JW}Ck.exports=XW});var Ek=F((W4,Dk)=>{"use strict";var KW=kk(),YW=Nu(),Rk=qu(),Tk=Rk&&Rk.isSet,ZW=Tk?YW(Tk):KW;Dk.exports=ZW});var Nk=F((j4,Mk)=>{"use strict";var ej=dS(),tj=hS(),nj=fg(),rj=nC(),ij=uC(),oj=gC(),sj=mC(),aj=PC(),cj=TC(),uj=IC(),lj=AC(),dj=$u(),fj=XC(),hj=hk(),gj=_k(),pj=Mu(),mj=hg(),bj=Sk(),_j=Fo(),vj=Ek(),yj=Ou(),xj=Bu(),wj=1,Pj=2,Sj=4,Ik="[object Arguments]",Cj="[object Array]",kj="[object Boolean]",Rj="[object Date]",Tj="[object Error]",Fk="[object Function]",Dj="[object GeneratorFunction]",Ej="[object Map]",Ij="[object Number]",Ak="[object Object]",Fj="[object RegExp]",Aj="[object Set]",Mj="[object String]",Nj="[object Symbol]",qj="[object WeakMap]",Lj="[object ArrayBuffer]",Oj="[object DataView]",Bj="[object Float32Array]",Uj="[object Float64Array]",$j="[object Int8Array]",Wj="[object Int16Array]",jj="[object Int32Array]",zj="[object Uint8Array]",Hj="[object Uint8ClampedArray]",Vj="[object Uint16Array]",Gj="[object Uint32Array]",ot={};ot[Ik]=ot[Cj]=ot[Lj]=ot[Oj]=ot[kj]=ot[Rj]=ot[Bj]=ot[Uj]=ot[$j]=ot[Wj]=ot[jj]=ot[Ej]=ot[Ij]=ot[Ak]=ot[Fj]=ot[Aj]=ot[Mj]=ot[Nj]=ot[zj]=ot[Hj]=ot[Vj]=ot[Gj]=!0;ot[Tj]=ot[Fk]=ot[qj]=!1;function ju(e,t,n,i,o,c){var u,f=t&wj,g=t&Pj,b=t&Sj;if(n&&(u=o?n(e,i,o,c):n(e)),u!==void 0)return u;if(!_j(e))return e;var x=pj(e);if(x){if(u=fj(e),!f)return sj(e,u)}else{var k=dj(e),I=k==Fk||k==Dj;if(mj(e))return oj(e,f);if(k==Ak||k==Ik||I&&!o){if(u=g||I?{}:gj(e),!f)return g?cj(e,ij(u,e)):aj(e,rj(u,e))}else{if(!ot[k])return o?e:{};u=hj(e,k,f)}}c||(c=new ej);var M=c.get(e);if(M)return M;c.set(e,u),vj(e)?e.forEach(function(W){u.add(ju(W,t,n,W,e,c))}):bj(e)&&e.forEach(function(W,X){u.set(X,ju(W,t,n,X,e,c))});var N=b?g?lj:uj:g?xj:yj,B=x?void 0:N(e);return tj(B||e,function(W,X){B&&(X=W,W=e[X]),nj(u,X,ju(W,t,n,X,e,c))}),u}Mk.exports=ju});var Lk=F((z4,qk)=>{"use strict";var Qj=Nk(),Jj=1,Xj=4;function Kj(e){return Qj(e,Jj|Xj)}qk.exports=Kj});var Bk=F((Ok,zu)=>{"use strict";(function(e,t){"use strict";typeof define=="function"&&define.amd?define(t):typeof zu=="object"&&zu.exports?zu.exports=t():e.log=t()})(Ok,function(){"use strict";var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},c=null;function u(N,B){var W=N[B];if(typeof W.bind=="function")return W.bind(N);try{return Function.prototype.bind.call(W,N)}catch{return function(){return Function.prototype.apply.apply(W,[N,arguments])}}}function f(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function g(N){return N==="debug"&&(N="log"),typeof console===t?!1:N==="trace"&&n?f:console[N]!==void 0?u(console,N):console.log!==void 0?u(console,"log"):e}function b(){for(var N=this.getLevel(),B=0;B<i.length;B++){var W=i[B];this[W]=B<N?e:this.methodFactory(W,N,this.name)}if(this.log=this.debug,typeof console===t&&N<this.levels.SILENT)return"No console available for logging"}function x(N){return function(){typeof console!==t&&(b.call(this),this[N].apply(this,arguments))}}function k(N,B,W){return g(N)||x.apply(this,arguments)}function I(N,B){var W=this,X,D,P,U="loglevel";typeof N=="string"?U+=":"+N:typeof N=="symbol"&&(U=void 0);function ne(xe){var Y=(i[xe]||"silent").toUpperCase();if(!(typeof window===t||!U)){try{window.localStorage[U]=Y;return}catch{}try{window.document.cookie=encodeURIComponent(U)+"="+Y+";"}catch{}}}function _e(){var xe;if(!(typeof window===t||!U)){try{xe=window.localStorage[U]}catch{}if(typeof xe===t)try{var Y=window.document.cookie,H=encodeURIComponent(U),ae=Y.indexOf(H+"=");ae!==-1&&(xe=/^([^;]+)/.exec(Y.slice(ae+H.length+1))[1])}catch{}return W.levels[xe]===void 0&&(xe=void 0),xe}}function Ue(){if(!(typeof window===t||!U)){try{window.localStorage.removeItem(U)}catch{}try{window.document.cookie=encodeURIComponent(U)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function Ke(xe){var Y=xe;if(typeof Y=="string"&&W.levels[Y.toUpperCase()]!==void 0&&(Y=W.levels[Y.toUpperCase()]),typeof Y=="number"&&Y>=0&&Y<=W.levels.SILENT)return Y;throw new TypeError("log.setLevel() called with invalid level: "+xe)}W.name=N,W.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},W.methodFactory=B||k,W.getLevel=function(){return P??D??X},W.setLevel=function(xe,Y){return P=Ke(xe),Y!==!1&&ne(P),b.call(W)},W.setDefaultLevel=function(xe){D=Ke(xe),_e()||W.setLevel(xe,!1)},W.resetLevel=function(){P=null,Ue(),b.call(W)},W.enableAll=function(xe){W.setLevel(W.levels.TRACE,xe)},W.disableAll=function(xe){W.setLevel(W.levels.SILENT,xe)},W.rebuild=function(){if(c!==W&&(X=Ke(c.getLevel())),b.call(W),c===W)for(var xe in o)o[xe].rebuild()},X=Ke(c?c.getLevel():"WARN");var Dt=_e();Dt!=null&&(P=Ke(Dt)),b.call(W)}c=new I,c.getLogger=function(B){if(typeof B!="symbol"&&typeof B!="string"||B==="")throw new TypeError("You must supply a name when creating a logger.");var W=o[B];return W||(W=o[B]=new I(B,c.methodFactory)),W};var M=typeof window!==t?window.log:void 0;return c.noConflict=function(){return typeof window!==t&&window.log===c&&(window.log=M),c},c.getLoggers=function(){return o},c.default=c,c})});var Vu=F(($o,Xs)=>{"use strict";(function(){var e,t="4.17.21",n=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",c="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",f=500,g="__lodash_placeholder__",b=1,x=2,k=4,I=1,M=2,N=1,B=2,W=4,X=8,D=16,P=32,U=64,ne=128,_e=256,Ue=512,Ke=30,Dt="...",xe=800,Y=16,H=1,ae=2,ie=3,ke=1/0,ge=9007199254740991,pe=17976931348623157e292,wt=NaN,je=4294967295,ze=je-1,bn=je>>>1,xr=[["ary",ne],["bind",N],["bindKey",B],["curry",X],["curryRight",D],["flip",Ue],["partial",P],["partialRight",U],["rearg",_e]],Vn="[object Arguments]",ur="[object Array]",vi="[object AsyncFunction]",lr="[object Boolean]",dr="[object Date]",$i="[object DOMException]",wr="[object Error]",Pr="[object Function]",Sr="[object GeneratorFunction]",bt="[object Map]",fr="[object Number]",Wi="[object Null]",Ut="[object Object]",yi="[object Promise]",jr="[object Proxy]",hr="[object RegExp]",Pt="[object Set]",sn="[object String]",Cr="[object Symbol]",ji="[object Undefined]",Ht="[object WeakMap]",xi="[object WeakSet]",Gn="[object ArrayBuffer]",_n="[object DataView]",kr="[object Float32Array]",vn="[object Float64Array]",S="[object Int8Array]",V="[object Int16Array]",ee="[object Int32Array]",oe="[object Uint8Array]",$e="[object Uint8ClampedArray]",Be="[object Uint16Array]",Qe="[object Uint32Array]",nt=/\b__p \+= '';/g,Re=/\b(__p \+=) '' \+/g,Je=/(__e\(.*?\)|\b__t\)) \+\n'';/g,qe=/&(?:amp|lt|gt|quot|#39);/g,at=/[&<>"']/g,Et=RegExp(qe.source),Zt=RegExp(at.source),zi=/<%-([\s\S]+?)%>/g,va=/<%([\s\S]+?)%>/g,is=/<%=([\s\S]+?)%>/g,ya=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xa=/^\w*$/,Vl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,q=/[\\^$.*+?()[\]{}|]/g,p=RegExp(q.source),C=/^\s+/,T=/\s/,v=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,h=/\{\n\/\* \[wrapped with (.+)\] \*/,L=/,? & /,Q=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,be=/[()=,{}\[\]\/\s]/,ht=/\\(\\)?/g,Ye=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,an=/\w*$/,yn=/^[-+]0x[0-9a-f]+$/i,Qn=/^0b[01]+$/i,Fe=/^\[object .+?Constructor\]$/,zr=/^0o[0-7]+$/i,Hi=/^(?:0|[1-9]\d*)$/,wa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Pa=/($^)/,VT=/['\n\r\u2028\u2029\\]/g,Sa="\\ud800-\\udfff",GT="\\u0300-\\u036f",QT="\\ufe20-\\ufe2f",JT="\\u20d0-\\u20ff",qp=GT+QT+JT,Lp="\\u2700-\\u27bf",Op="a-z\\xdf-\\xf6\\xf8-\\xff",XT="\\xac\\xb1\\xd7\\xf7",KT="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",YT="\\u2000-\\u206f",ZT=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Bp="A-Z\\xc0-\\xd6\\xd8-\\xde",Up="\\ufe0e\\ufe0f",$p=XT+KT+YT+ZT,Gl="['\u2019]",e0="["+Sa+"]",Wp="["+$p+"]",Ca="["+qp+"]",jp="\\d+",t0="["+Lp+"]",zp="["+Op+"]",Hp="[^"+Sa+$p+jp+Lp+Op+Bp+"]",Ql="\\ud83c[\\udffb-\\udfff]",n0="(?:"+Ca+"|"+Ql+")",Vp="[^"+Sa+"]",Jl="(?:\\ud83c[\\udde6-\\uddff]){2}",Xl="[\\ud800-\\udbff][\\udc00-\\udfff]",Vi="["+Bp+"]",Gp="\\u200d",Qp="(?:"+zp+"|"+Hp+")",r0="(?:"+Vi+"|"+Hp+")",Jp="(?:"+Gl+"(?:d|ll|m|re|s|t|ve))?",Xp="(?:"+Gl+"(?:D|LL|M|RE|S|T|VE))?",Kp=n0+"?",Yp="["+Up+"]?",i0="(?:"+Gp+"(?:"+[Vp,Jl,Xl].join("|")+")"+Yp+Kp+")*",o0="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",s0="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zp=Yp+Kp+i0,a0="(?:"+[t0,Jl,Xl].join("|")+")"+Zp,c0="(?:"+[Vp+Ca+"?",Ca,Jl,Xl,e0].join("|")+")",u0=RegExp(Gl,"g"),l0=RegExp(Ca,"g"),Kl=RegExp(Ql+"(?="+Ql+")|"+c0+Zp,"g"),d0=RegExp([Vi+"?"+zp+"+"+Jp+"(?="+[Wp,Vi,"$"].join("|")+")",r0+"+"+Xp+"(?="+[Wp,Vi+Qp,"$"].join("|")+")",Vi+"?"+Qp+"+"+Jp,Vi+"+"+Xp,s0,o0,jp,a0].join("|"),"g"),f0=RegExp("["+Gp+Sa+qp+Up+"]"),h0=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,g0=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],p0=-1,ct={};ct[kr]=ct[vn]=ct[S]=ct[V]=ct[ee]=ct[oe]=ct[$e]=ct[Be]=ct[Qe]=!0,ct[Vn]=ct[ur]=ct[Gn]=ct[lr]=ct[_n]=ct[dr]=ct[wr]=ct[Pr]=ct[bt]=ct[fr]=ct[Ut]=ct[hr]=ct[Pt]=ct[sn]=ct[Ht]=!1;var rt={};rt[Vn]=rt[ur]=rt[Gn]=rt[_n]=rt[lr]=rt[dr]=rt[kr]=rt[vn]=rt[S]=rt[V]=rt[ee]=rt[bt]=rt[fr]=rt[Ut]=rt[hr]=rt[Pt]=rt[sn]=rt[Cr]=rt[oe]=rt[$e]=rt[Be]=rt[Qe]=!0,rt[wr]=rt[Pr]=rt[Ht]=!1;var m0={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},b0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_0={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},v0={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},y0=parseFloat,x0=parseInt,em=typeof global=="object"&&global&&global.Object===Object&&global,w0=typeof self=="object"&&self&&self.Object===Object&&self,qt=em||w0||Function("return this")(),Yl=typeof $o=="object"&&$o&&!$o.nodeType&&$o,wi=Yl&&typeof Xs=="object"&&Xs&&!Xs.nodeType&&Xs,tm=wi&&wi.exports===Yl,Zl=tm&&em.process,In=function(){try{var E=wi&&wi.require&&wi.require("util").types;return E||Zl&&Zl.binding&&Zl.binding("util")}catch{}}(),nm=In&&In.isArrayBuffer,rm=In&&In.isDate,im=In&&In.isMap,om=In&&In.isRegExp,sm=In&&In.isSet,am=In&&In.isTypedArray;function xn(E,j,$){switch($.length){case 0:return E.call(j);case 1:return E.call(j,$[0]);case 2:return E.call(j,$[0],$[1]);case 3:return E.call(j,$[0],$[1],$[2])}return E.apply(j,$)}function P0(E,j,$,se){for(var ve=-1,He=E==null?0:E.length;++ve<He;){var At=E[ve];j(se,At,$(At),E)}return se}function Fn(E,j){for(var $=-1,se=E==null?0:E.length;++$<se&&j(E[$],$,E)!==!1;);return E}function S0(E,j){for(var $=E==null?0:E.length;$--&&j(E[$],$,E)!==!1;);return E}function cm(E,j){for(var $=-1,se=E==null?0:E.length;++$<se;)if(!j(E[$],$,E))return!1;return!0}function Hr(E,j){for(var $=-1,se=E==null?0:E.length,ve=0,He=[];++$<se;){var At=E[$];j(At,$,E)&&(He[ve++]=At)}return He}function ka(E,j){var $=E==null?0:E.length;return!!$&&Gi(E,j,0)>-1}function ed(E,j,$){for(var se=-1,ve=E==null?0:E.length;++se<ve;)if($(j,E[se]))return!0;return!1}function gt(E,j){for(var $=-1,se=E==null?0:E.length,ve=Array(se);++$<se;)ve[$]=j(E[$],$,E);return ve}function Vr(E,j){for(var $=-1,se=j.length,ve=E.length;++$<se;)E[ve+$]=j[$];return E}function td(E,j,$,se){var ve=-1,He=E==null?0:E.length;for(se&&He&&($=E[++ve]);++ve<He;)$=j($,E[ve],ve,E);return $}function C0(E,j,$,se){var ve=E==null?0:E.length;for(se&&ve&&($=E[--ve]);ve--;)$=j($,E[ve],ve,E);return $}function nd(E,j){for(var $=-1,se=E==null?0:E.length;++$<se;)if(j(E[$],$,E))return!0;return!1}var k0=rd("length");function R0(E){return E.split("")}function T0(E){return E.match(Q)||[]}function um(E,j,$){var se;return $(E,function(ve,He,At){if(j(ve,He,At))return se=He,!1}),se}function Ra(E,j,$,se){for(var ve=E.length,He=$+(se?1:-1);se?He--:++He<ve;)if(j(E[He],He,E))return He;return-1}function Gi(E,j,$){return j===j?U0(E,j,$):Ra(E,lm,$)}function D0(E,j,$,se){for(var ve=$-1,He=E.length;++ve<He;)if(se(E[ve],j))return ve;return-1}function lm(E){return E!==E}function dm(E,j){var $=E==null?0:E.length;return $?od(E,j)/$:wt}function rd(E){return function(j){return j==null?e:j[E]}}function id(E){return function(j){return E==null?e:E[j]}}function fm(E,j,$,se,ve){return ve(E,function(He,At,et){$=se?(se=!1,He):j($,He,At,et)}),$}function E0(E,j){var $=E.length;for(E.sort(j);$--;)E[$]=E[$].value;return E}function od(E,j){for(var $,se=-1,ve=E.length;++se<ve;){var He=j(E[se]);He!==e&&($=$===e?He:$+He)}return $}function sd(E,j){for(var $=-1,se=Array(E);++$<E;)se[$]=j($);return se}function I0(E,j){return gt(j,function($){return[$,E[$]]})}function hm(E){return E&&E.slice(0,bm(E)+1).replace(C,"")}function wn(E){return function(j){return E(j)}}function ad(E,j){return gt(j,function($){return E[$]})}function os(E,j){return E.has(j)}function gm(E,j){for(var $=-1,se=E.length;++$<se&&Gi(j,E[$],0)>-1;);return $}function pm(E,j){for(var $=E.length;$--&&Gi(j,E[$],0)>-1;);return $}function F0(E,j){for(var $=E.length,se=0;$--;)E[$]===j&&++se;return se}var A0=id(m0),M0=id(b0);function N0(E){return"\\"+v0[E]}function q0(E,j){return E==null?e:E[j]}function Qi(E){return f0.test(E)}function L0(E){return h0.test(E)}function O0(E){for(var j,$=[];!(j=E.next()).done;)$.push(j.value);return $}function cd(E){var j=-1,$=Array(E.size);return E.forEach(function(se,ve){$[++j]=[ve,se]}),$}function mm(E,j){return function($){return E(j($))}}function Gr(E,j){for(var $=-1,se=E.length,ve=0,He=[];++$<se;){var At=E[$];(At===j||At===g)&&(E[$]=g,He[ve++]=$)}return He}function Ta(E){var j=-1,$=Array(E.size);return E.forEach(function(se){$[++j]=se}),$}function B0(E){var j=-1,$=Array(E.size);return E.forEach(function(se){$[++j]=[se,se]}),$}function U0(E,j,$){for(var se=$-1,ve=E.length;++se<ve;)if(E[se]===j)return se;return-1}function $0(E,j,$){for(var se=$+1;se--;)if(E[se]===j)return se;return se}function Ji(E){return Qi(E)?j0(E):k0(E)}function Jn(E){return Qi(E)?z0(E):R0(E)}function bm(E){for(var j=E.length;j--&&T.test(E.charAt(j)););return j}var W0=id(_0);function j0(E){for(var j=Kl.lastIndex=0;Kl.test(E);)++j;return j}function z0(E){return E.match(Kl)||[]}function H0(E){return E.match(d0)||[]}var V0=function E(j){j=j==null?qt:Qr.defaults(qt.Object(),j,Qr.pick(qt,g0));var $=j.Array,se=j.Date,ve=j.Error,He=j.Function,At=j.Math,et=j.Object,ud=j.RegExp,G0=j.String,An=j.TypeError,Da=$.prototype,Q0=He.prototype,Xi=et.prototype,Ea=j["__core-js_shared__"],Ia=Q0.toString,Xe=Xi.hasOwnProperty,J0=0,_m=function(){var r=/[^.]+$/.exec(Ea&&Ea.keys&&Ea.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Fa=Xi.toString,X0=Ia.call(et),K0=qt._,Y0=ud("^"+Ia.call(Xe).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Aa=tm?j.Buffer:e,Jr=j.Symbol,Ma=j.Uint8Array,vm=Aa?Aa.allocUnsafe:e,Na=mm(et.getPrototypeOf,et),ym=et.create,xm=Xi.propertyIsEnumerable,qa=Da.splice,wm=Jr?Jr.isConcatSpreadable:e,ss=Jr?Jr.iterator:e,Pi=Jr?Jr.toStringTag:e,La=function(){try{var r=Ti(et,"defineProperty");return r({},"",{}),r}catch{}}(),Z0=j.clearTimeout!==qt.clearTimeout&&j.clearTimeout,eD=se&&se.now!==qt.Date.now&&se.now,tD=j.setTimeout!==qt.setTimeout&&j.setTimeout,Oa=At.ceil,Ba=At.floor,ld=et.getOwnPropertySymbols,nD=Aa?Aa.isBuffer:e,Pm=j.isFinite,rD=Da.join,iD=mm(et.keys,et),Mt=At.max,Vt=At.min,oD=se.now,sD=j.parseInt,Sm=At.random,aD=Da.reverse,dd=Ti(j,"DataView"),as=Ti(j,"Map"),fd=Ti(j,"Promise"),Ki=Ti(j,"Set"),cs=Ti(j,"WeakMap"),us=Ti(et,"create"),Ua=cs&&new cs,Yi={},cD=Di(dd),uD=Di(as),lD=Di(fd),dD=Di(Ki),fD=Di(cs),$a=Jr?Jr.prototype:e,ls=$a?$a.valueOf:e,Cm=$a?$a.toString:e;function m(r){if(yt(r)&&!we(r)&&!(r instanceof Me)){if(r instanceof Mn)return r;if(Xe.call(r,"__wrapped__"))return kb(r)}return new Mn(r)}var Zi=function(){function r(){}return function(s){if(!_t(s))return{};if(ym)return ym(s);r.prototype=s;var a=new r;return r.prototype=e,a}}();function Wa(){}function Mn(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=e}m.templateSettings={escape:zi,evaluate:va,interpolate:is,variable:"",imports:{_:m}},m.prototype=Wa.prototype,m.prototype.constructor=m,Mn.prototype=Zi(Wa.prototype),Mn.prototype.constructor=Mn;function Me(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=je,this.__views__=[]}function hD(){var r=new Me(this.__wrapped__);return r.__actions__=cn(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=cn(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=cn(this.__views__),r}function gD(){if(this.__filtered__){var r=new Me(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function pD(){var r=this.__wrapped__.value(),s=this.__dir__,a=we(r),l=s<0,d=a?r.length:0,_=RE(0,d,this.__views__),w=_.start,R=_.end,A=R-w,G=l?R:w-1,J=this.__iteratees__,K=J.length,re=0,ce=Vt(A,this.__takeCount__);if(!a||!l&&d==A&&ce==A)return Jm(r,this.__actions__);var de=[];e:for(;A--&&re<ce;){G+=s;for(var Ce=-1,fe=r[G];++Ce<K;){var Ae=J[Ce],Le=Ae.iteratee,Cn=Ae.type,nn=Le(fe);if(Cn==ae)fe=nn;else if(!nn){if(Cn==H)continue e;break e}}de[re++]=fe}return de}Me.prototype=Zi(Wa.prototype),Me.prototype.constructor=Me;function Si(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var l=r[s];this.set(l[0],l[1])}}function mD(){this.__data__=us?us(null):{},this.size=0}function bD(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}function _D(r){var s=this.__data__;if(us){var a=s[r];return a===u?e:a}return Xe.call(s,r)?s[r]:e}function vD(r){var s=this.__data__;return us?s[r]!==e:Xe.call(s,r)}function yD(r,s){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=us&&s===e?u:s,this}Si.prototype.clear=mD,Si.prototype.delete=bD,Si.prototype.get=_D,Si.prototype.has=vD,Si.prototype.set=yD;function Rr(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var l=r[s];this.set(l[0],l[1])}}function xD(){this.__data__=[],this.size=0}function wD(r){var s=this.__data__,a=ja(s,r);if(a<0)return!1;var l=s.length-1;return a==l?s.pop():qa.call(s,a,1),--this.size,!0}function PD(r){var s=this.__data__,a=ja(s,r);return a<0?e:s[a][1]}function SD(r){return ja(this.__data__,r)>-1}function CD(r,s){var a=this.__data__,l=ja(a,r);return l<0?(++this.size,a.push([r,s])):a[l][1]=s,this}Rr.prototype.clear=xD,Rr.prototype.delete=wD,Rr.prototype.get=PD,Rr.prototype.has=SD,Rr.prototype.set=CD;function Tr(r){var s=-1,a=r==null?0:r.length;for(this.clear();++s<a;){var l=r[s];this.set(l[0],l[1])}}function kD(){this.size=0,this.__data__={hash:new Si,map:new(as||Rr),string:new Si}}function RD(r){var s=tc(this,r).delete(r);return this.size-=s?1:0,s}function TD(r){return tc(this,r).get(r)}function DD(r){return tc(this,r).has(r)}function ED(r,s){var a=tc(this,r),l=a.size;return a.set(r,s),this.size+=a.size==l?0:1,this}Tr.prototype.clear=kD,Tr.prototype.delete=RD,Tr.prototype.get=TD,Tr.prototype.has=DD,Tr.prototype.set=ED;function Ci(r){var s=-1,a=r==null?0:r.length;for(this.__data__=new Tr;++s<a;)this.add(r[s])}function ID(r){return this.__data__.set(r,u),this}function FD(r){return this.__data__.has(r)}Ci.prototype.add=Ci.prototype.push=ID,Ci.prototype.has=FD;function Xn(r){var s=this.__data__=new Rr(r);this.size=s.size}function AD(){this.__data__=new Rr,this.size=0}function MD(r){var s=this.__data__,a=s.delete(r);return this.size=s.size,a}function ND(r){return this.__data__.get(r)}function qD(r){return this.__data__.has(r)}function LD(r,s){var a=this.__data__;if(a instanceof Rr){var l=a.__data__;if(!as||l.length<n-1)return l.push([r,s]),this.size=++a.size,this;a=this.__data__=new Tr(l)}return a.set(r,s),this.size=a.size,this}Xn.prototype.clear=AD,Xn.prototype.delete=MD,Xn.prototype.get=ND,Xn.prototype.has=qD,Xn.prototype.set=LD;function km(r,s){var a=we(r),l=!a&&Ei(r),d=!a&&!l&&ei(r),_=!a&&!l&&!d&&ro(r),w=a||l||d||_,R=w?sd(r.length,G0):[],A=R.length;for(var G in r)(s||Xe.call(r,G))&&!(w&&(G=="length"||d&&(G=="offset"||G=="parent")||_&&(G=="buffer"||G=="byteLength"||G=="byteOffset")||Fr(G,A)))&&R.push(G);return R}function Rm(r){var s=r.length;return s?r[Pd(0,s-1)]:e}function OD(r,s){return nc(cn(r),ki(s,0,r.length))}function BD(r){return nc(cn(r))}function hd(r,s,a){(a!==e&&!Kn(r[s],a)||a===e&&!(s in r))&&Dr(r,s,a)}function ds(r,s,a){var l=r[s];(!(Xe.call(r,s)&&Kn(l,a))||a===e&&!(s in r))&&Dr(r,s,a)}function ja(r,s){for(var a=r.length;a--;)if(Kn(r[a][0],s))return a;return-1}function UD(r,s,a,l){return Xr(r,function(d,_,w){s(l,d,a(d),w)}),l}function Tm(r,s){return r&&pr(s,Lt(s),r)}function $D(r,s){return r&&pr(s,ln(s),r)}function Dr(r,s,a){s=="__proto__"&&La?La(r,s,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[s]=a}function gd(r,s){for(var a=-1,l=s.length,d=$(l),_=r==null;++a<l;)d[a]=_?e:Qd(r,s[a]);return d}function ki(r,s,a){return r===r&&(a!==e&&(r=r<=a?r:a),s!==e&&(r=r>=s?r:s)),r}function Nn(r,s,a,l,d,_){var w,R=s&b,A=s&x,G=s&k;if(a&&(w=d?a(r,l,d,_):a(r)),w!==e)return w;if(!_t(r))return r;var J=we(r);if(J){if(w=DE(r),!R)return cn(r,w)}else{var K=Gt(r),re=K==Pr||K==Sr;if(ei(r))return Ym(r,R);if(K==Ut||K==Vn||re&&!d){if(w=A||re?{}:bb(r),!R)return A?_E(r,$D(w,r)):bE(r,Tm(w,r))}else{if(!rt[K])return d?r:{};w=EE(r,K,R)}}_||(_=new Xn);var ce=_.get(r);if(ce)return ce;_.set(r,w),Vb(r)?r.forEach(function(fe){w.add(Nn(fe,s,a,fe,r,_))}):zb(r)&&r.forEach(function(fe,Ae){w.set(Ae,Nn(fe,s,a,Ae,r,_))});var de=G?A?Md:Ad:A?ln:Lt,Ce=J?e:de(r);return Fn(Ce||r,function(fe,Ae){Ce&&(Ae=fe,fe=r[Ae]),ds(w,Ae,Nn(fe,s,a,Ae,r,_))}),w}function WD(r){var s=Lt(r);return function(a){return Dm(a,r,s)}}function Dm(r,s,a){var l=a.length;if(r==null)return!l;for(r=et(r);l--;){var d=a[l],_=s[d],w=r[d];if(w===e&&!(d in r)||!_(w))return!1}return!0}function Em(r,s,a){if(typeof r!="function")throw new An(o);return _s(function(){r.apply(e,a)},s)}function fs(r,s,a,l){var d=-1,_=ka,w=!0,R=r.length,A=[],G=s.length;if(!R)return A;a&&(s=gt(s,wn(a))),l?(_=ed,w=!1):s.length>=n&&(_=os,w=!1,s=new Ci(s));e:for(;++d<R;){var J=r[d],K=a==null?J:a(J);if(J=l||J!==0?J:0,w&&K===K){for(var re=G;re--;)if(s[re]===K)continue e;A.push(J)}else _(s,K,l)||A.push(J)}return A}var Xr=rb(gr),Im=rb(md,!0);function jD(r,s){var a=!0;return Xr(r,function(l,d,_){return a=!!s(l,d,_),a}),a}function za(r,s,a){for(var l=-1,d=r.length;++l<d;){var _=r[l],w=s(_);if(w!=null&&(R===e?w===w&&!Sn(w):a(w,R)))var R=w,A=_}return A}function zD(r,s,a,l){var d=r.length;for(a=Se(a),a<0&&(a=-a>d?0:d+a),l=l===e||l>d?d:Se(l),l<0&&(l+=d),l=a>l?0:Qb(l);a<l;)r[a++]=s;return r}function Fm(r,s){var a=[];return Xr(r,function(l,d,_){s(l,d,_)&&a.push(l)}),a}function $t(r,s,a,l,d){var _=-1,w=r.length;for(a||(a=FE),d||(d=[]);++_<w;){var R=r[_];s>0&&a(R)?s>1?$t(R,s-1,a,l,d):Vr(d,R):l||(d[d.length]=R)}return d}var pd=ib(),Am=ib(!0);function gr(r,s){return r&&pd(r,s,Lt)}function md(r,s){return r&&Am(r,s,Lt)}function Ha(r,s){return Hr(s,function(a){return Ar(r[a])})}function Ri(r,s){s=Yr(s,r);for(var a=0,l=s.length;r!=null&&a<l;)r=r[mr(s[a++])];return a&&a==l?r:e}function Mm(r,s,a){var l=s(r);return we(r)?l:Vr(l,a(r))}function en(r){return r==null?r===e?ji:Wi:Pi&&Pi in et(r)?kE(r):BE(r)}function bd(r,s){return r>s}function HD(r,s){return r!=null&&Xe.call(r,s)}function VD(r,s){return r!=null&&s in et(r)}function GD(r,s,a){return r>=Vt(s,a)&&r<Mt(s,a)}function _d(r,s,a){for(var l=a?ed:ka,d=r[0].length,_=r.length,w=_,R=$(_),A=1/0,G=[];w--;){var J=r[w];w&&s&&(J=gt(J,wn(s))),A=Vt(J.length,A),R[w]=!a&&(s||d>=120&&J.length>=120)?new Ci(w&&J):e}J=r[0];var K=-1,re=R[0];e:for(;++K<d&&G.length<A;){var ce=J[K],de=s?s(ce):ce;if(ce=a||ce!==0?ce:0,!(re?os(re,de):l(G,de,a))){for(w=_;--w;){var Ce=R[w];if(!(Ce?os(Ce,de):l(r[w],de,a)))continue e}re&&re.push(de),G.push(ce)}}return G}function QD(r,s,a,l){return gr(r,function(d,_,w){s(l,a(d),_,w)}),l}function hs(r,s,a){s=Yr(s,r),r=xb(r,s);var l=r==null?r:r[mr(Ln(s))];return l==null?e:xn(l,r,a)}function Nm(r){return yt(r)&&en(r)==Vn}function JD(r){return yt(r)&&en(r)==Gn}function XD(r){return yt(r)&&en(r)==dr}function gs(r,s,a,l,d){return r===s?!0:r==null||s==null||!yt(r)&&!yt(s)?r!==r&&s!==s:KD(r,s,a,l,gs,d)}function KD(r,s,a,l,d,_){var w=we(r),R=we(s),A=w?ur:Gt(r),G=R?ur:Gt(s);A=A==Vn?Ut:A,G=G==Vn?Ut:G;var J=A==Ut,K=G==Ut,re=A==G;if(re&&ei(r)){if(!ei(s))return!1;w=!0,J=!1}if(re&&!J)return _||(_=new Xn),w||ro(r)?gb(r,s,a,l,d,_):SE(r,s,A,a,l,d,_);if(!(a&I)){var ce=J&&Xe.call(r,"__wrapped__"),de=K&&Xe.call(s,"__wrapped__");if(ce||de){var Ce=ce?r.value():r,fe=de?s.value():s;return _||(_=new Xn),d(Ce,fe,a,l,_)}}return re?(_||(_=new Xn),CE(r,s,a,l,d,_)):!1}function YD(r){return yt(r)&&Gt(r)==bt}function vd(r,s,a,l){var d=a.length,_=d,w=!l;if(r==null)return!_;for(r=et(r);d--;){var R=a[d];if(w&&R[2]?R[1]!==r[R[0]]:!(R[0]in r))return!1}for(;++d<_;){R=a[d];var A=R[0],G=r[A],J=R[1];if(w&&R[2]){if(G===e&&!(A in r))return!1}else{var K=new Xn;if(l)var re=l(G,J,A,r,s,K);if(!(re===e?gs(J,G,I|M,l,K):re))return!1}}return!0}function qm(r){if(!_t(r)||ME(r))return!1;var s=Ar(r)?Y0:Fe;return s.test(Di(r))}function ZD(r){return yt(r)&&en(r)==hr}function eE(r){return yt(r)&&Gt(r)==Pt}function tE(r){return yt(r)&&cc(r.length)&&!!ct[en(r)]}function Lm(r){return typeof r=="function"?r:r==null?dn:typeof r=="object"?we(r)?Um(r[0],r[1]):Bm(r):o_(r)}function yd(r){if(!bs(r))return iD(r);var s=[];for(var a in et(r))Xe.call(r,a)&&a!="constructor"&&s.push(a);return s}function nE(r){if(!_t(r))return OE(r);var s=bs(r),a=[];for(var l in r)l=="constructor"&&(s||!Xe.call(r,l))||a.push(l);return a}function xd(r,s){return r<s}function Om(r,s){var a=-1,l=un(r)?$(r.length):[];return Xr(r,function(d,_,w){l[++a]=s(d,_,w)}),l}function Bm(r){var s=qd(r);return s.length==1&&s[0][2]?vb(s[0][0],s[0][1]):function(a){return a===r||vd(a,r,s)}}function Um(r,s){return Od(r)&&_b(s)?vb(mr(r),s):function(a){var l=Qd(a,r);return l===e&&l===s?Jd(a,r):gs(s,l,I|M)}}function Va(r,s,a,l,d){r!==s&&pd(s,function(_,w){if(d||(d=new Xn),_t(_))rE(r,s,w,a,Va,l,d);else{var R=l?l(Ud(r,w),_,w+"",r,s,d):e;R===e&&(R=_),hd(r,w,R)}},ln)}function rE(r,s,a,l,d,_,w){var R=Ud(r,a),A=Ud(s,a),G=w.get(A);if(G){hd(r,a,G);return}var J=_?_(R,A,a+"",r,s,w):e,K=J===e;if(K){var re=we(A),ce=!re&&ei(A),de=!re&&!ce&&ro(A);J=A,re||ce||de?we(R)?J=R:St(R)?J=cn(R):ce?(K=!1,J=Ym(A,!0)):de?(K=!1,J=Zm(A,!0)):J=[]:vs(A)||Ei(A)?(J=R,Ei(R)?J=Jb(R):(!_t(R)||Ar(R))&&(J=bb(A))):K=!1}K&&(w.set(A,J),d(J,A,l,_,w),w.delete(A)),hd(r,a,J)}function $m(r,s){var a=r.length;if(a)return s+=s<0?a:0,Fr(s,a)?r[s]:e}function Wm(r,s,a){s.length?s=gt(s,function(_){return we(_)?function(w){return Ri(w,_.length===1?_[0]:_)}:_}):s=[dn];var l=-1;s=gt(s,wn(le()));var d=Om(r,function(_,w,R){var A=gt(s,function(G){return G(_)});return{criteria:A,index:++l,value:_}});return E0(d,function(_,w){return mE(_,w,a)})}function iE(r,s){return jm(r,s,function(a,l){return Jd(r,l)})}function jm(r,s,a){for(var l=-1,d=s.length,_={};++l<d;){var w=s[l],R=Ri(r,w);a(R,w)&&ps(_,Yr(w,r),R)}return _}function oE(r){return function(s){return Ri(s,r)}}function wd(r,s,a,l){var d=l?D0:Gi,_=-1,w=s.length,R=r;for(r===s&&(s=cn(s)),a&&(R=gt(r,wn(a)));++_<w;)for(var A=0,G=s[_],J=a?a(G):G;(A=d(R,J,A,l))>-1;)R!==r&&qa.call(R,A,1),qa.call(r,A,1);return r}function zm(r,s){for(var a=r?s.length:0,l=a-1;a--;){var d=s[a];if(a==l||d!==_){var _=d;Fr(d)?qa.call(r,d,1):kd(r,d)}}return r}function Pd(r,s){return r+Ba(Sm()*(s-r+1))}function sE(r,s,a,l){for(var d=-1,_=Mt(Oa((s-r)/(a||1)),0),w=$(_);_--;)w[l?_:++d]=r,r+=a;return w}function Sd(r,s){var a="";if(!r||s<1||s>ge)return a;do s%2&&(a+=r),s=Ba(s/2),s&&(r+=r);while(s);return a}function Te(r,s){return $d(yb(r,s,dn),r+"")}function aE(r){return Rm(io(r))}function cE(r,s){var a=io(r);return nc(a,ki(s,0,a.length))}function ps(r,s,a,l){if(!_t(r))return r;s=Yr(s,r);for(var d=-1,_=s.length,w=_-1,R=r;R!=null&&++d<_;){var A=mr(s[d]),G=a;if(A==="__proto__"||A==="constructor"||A==="prototype")return r;if(d!=w){var J=R[A];G=l?l(J,A,R):e,G===e&&(G=_t(J)?J:Fr(s[d+1])?[]:{})}ds(R,A,G),R=R[A]}return r}var Hm=Ua?function(r,s){return Ua.set(r,s),r}:dn,uE=La?function(r,s){return La(r,"toString",{configurable:!0,enumerable:!1,value:Kd(s),writable:!0})}:dn;function lE(r){return nc(io(r))}function qn(r,s,a){var l=-1,d=r.length;s<0&&(s=-s>d?0:d+s),a=a>d?d:a,a<0&&(a+=d),d=s>a?0:a-s>>>0,s>>>=0;for(var _=$(d);++l<d;)_[l]=r[l+s];return _}function dE(r,s){var a;return Xr(r,function(l,d,_){return a=s(l,d,_),!a}),!!a}function Ga(r,s,a){var l=0,d=r==null?l:r.length;if(typeof s=="number"&&s===s&&d<=bn){for(;l<d;){var _=l+d>>>1,w=r[_];w!==null&&!Sn(w)&&(a?w<=s:w<s)?l=_+1:d=_}return d}return Cd(r,s,dn,a)}function Cd(r,s,a,l){var d=0,_=r==null?0:r.length;if(_===0)return 0;s=a(s);for(var w=s!==s,R=s===null,A=Sn(s),G=s===e;d<_;){var J=Ba((d+_)/2),K=a(r[J]),re=K!==e,ce=K===null,de=K===K,Ce=Sn(K);if(w)var fe=l||de;else G?fe=de&&(l||re):R?fe=de&&re&&(l||!ce):A?fe=de&&re&&!ce&&(l||!Ce):ce||Ce?fe=!1:fe=l?K<=s:K<s;fe?d=J+1:_=J}return Vt(_,ze)}function Vm(r,s){for(var a=-1,l=r.length,d=0,_=[];++a<l;){var w=r[a],R=s?s(w):w;if(!a||!Kn(R,A)){var A=R;_[d++]=w===0?0:w}}return _}function Gm(r){return typeof r=="number"?r:Sn(r)?wt:+r}function Pn(r){if(typeof r=="string")return r;if(we(r))return gt(r,Pn)+"";if(Sn(r))return Cm?Cm.call(r):"";var s=r+"";return s=="0"&&1/r==-ke?"-0":s}function Kr(r,s,a){var l=-1,d=ka,_=r.length,w=!0,R=[],A=R;if(a)w=!1,d=ed;else if(_>=n){var G=s?null:wE(r);if(G)return Ta(G);w=!1,d=os,A=new Ci}else A=s?[]:R;e:for(;++l<_;){var J=r[l],K=s?s(J):J;if(J=a||J!==0?J:0,w&&K===K){for(var re=A.length;re--;)if(A[re]===K)continue e;s&&A.push(K),R.push(J)}else d(A,K,a)||(A!==R&&A.push(K),R.push(J))}return R}function kd(r,s){return s=Yr(s,r),r=xb(r,s),r==null||delete r[mr(Ln(s))]}function Qm(r,s,a,l){return ps(r,s,a(Ri(r,s)),l)}function Qa(r,s,a,l){for(var d=r.length,_=l?d:-1;(l?_--:++_<d)&&s(r[_],_,r););return a?qn(r,l?0:_,l?_+1:d):qn(r,l?_+1:0,l?d:_)}function Jm(r,s){var a=r;return a instanceof Me&&(a=a.value()),td(s,function(l,d){return d.func.apply(d.thisArg,Vr([l],d.args))},a)}function Rd(r,s,a){var l=r.length;if(l<2)return l?Kr(r[0]):[];for(var d=-1,_=$(l);++d<l;)for(var w=r[d],R=-1;++R<l;)R!=d&&(_[d]=fs(_[d]||w,r[R],s,a));return Kr($t(_,1),s,a)}function Xm(r,s,a){for(var l=-1,d=r.length,_=s.length,w={};++l<d;){var R=l<_?s[l]:e;a(w,r[l],R)}return w}function Td(r){return St(r)?r:[]}function Dd(r){return typeof r=="function"?r:dn}function Yr(r,s){return we(r)?r:Od(r,s)?[r]:Cb(Ge(r))}var fE=Te;function Zr(r,s,a){var l=r.length;return a=a===e?l:a,!s&&a>=l?r:qn(r,s,a)}var Km=Z0||function(r){return qt.clearTimeout(r)};function Ym(r,s){if(s)return r.slice();var a=r.length,l=vm?vm(a):new r.constructor(a);return r.copy(l),l}function Ed(r){var s=new r.constructor(r.byteLength);return new Ma(s).set(new Ma(r)),s}function hE(r,s){var a=s?Ed(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function gE(r){var s=new r.constructor(r.source,an.exec(r));return s.lastIndex=r.lastIndex,s}function pE(r){return ls?et(ls.call(r)):{}}function Zm(r,s){var a=s?Ed(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function eb(r,s){if(r!==s){var a=r!==e,l=r===null,d=r===r,_=Sn(r),w=s!==e,R=s===null,A=s===s,G=Sn(s);if(!R&&!G&&!_&&r>s||_&&w&&A&&!R&&!G||l&&w&&A||!a&&A||!d)return 1;if(!l&&!_&&!G&&r<s||G&&a&&d&&!l&&!_||R&&a&&d||!w&&d||!A)return-1}return 0}function mE(r,s,a){for(var l=-1,d=r.criteria,_=s.criteria,w=d.length,R=a.length;++l<w;){var A=eb(d[l],_[l]);if(A){if(l>=R)return A;var G=a[l];return A*(G=="desc"?-1:1)}}return r.index-s.index}function tb(r,s,a,l){for(var d=-1,_=r.length,w=a.length,R=-1,A=s.length,G=Mt(_-w,0),J=$(A+G),K=!l;++R<A;)J[R]=s[R];for(;++d<w;)(K||d<_)&&(J[a[d]]=r[d]);for(;G--;)J[R++]=r[d++];return J}function nb(r,s,a,l){for(var d=-1,_=r.length,w=-1,R=a.length,A=-1,G=s.length,J=Mt(_-R,0),K=$(J+G),re=!l;++d<J;)K[d]=r[d];for(var ce=d;++A<G;)K[ce+A]=s[A];for(;++w<R;)(re||d<_)&&(K[ce+a[w]]=r[d++]);return K}function cn(r,s){var a=-1,l=r.length;for(s||(s=$(l));++a<l;)s[a]=r[a];return s}function pr(r,s,a,l){var d=!a;a||(a={});for(var _=-1,w=s.length;++_<w;){var R=s[_],A=l?l(a[R],r[R],R,a,r):e;A===e&&(A=r[R]),d?Dr(a,R,A):ds(a,R,A)}return a}function bE(r,s){return pr(r,Ld(r),s)}function _E(r,s){return pr(r,pb(r),s)}function Ja(r,s){return function(a,l){var d=we(a)?P0:UD,_=s?s():{};return d(a,r,le(l,2),_)}}function eo(r){return Te(function(s,a){var l=-1,d=a.length,_=d>1?a[d-1]:e,w=d>2?a[2]:e;for(_=r.length>3&&typeof _=="function"?(d--,_):e,w&&tn(a[0],a[1],w)&&(_=d<3?e:_,d=1),s=et(s);++l<d;){var R=a[l];R&&r(s,R,l,_)}return s})}function rb(r,s){return function(a,l){if(a==null)return a;if(!un(a))return r(a,l);for(var d=a.length,_=s?d:-1,w=et(a);(s?_--:++_<d)&&l(w[_],_,w)!==!1;);return a}}function ib(r){return function(s,a,l){for(var d=-1,_=et(s),w=l(s),R=w.length;R--;){var A=w[r?R:++d];if(a(_[A],A,_)===!1)break}return s}}function vE(r,s,a){var l=s&N,d=ms(r);function _(){var w=this&&this!==qt&&this instanceof _?d:r;return w.apply(l?a:this,arguments)}return _}function ob(r){return function(s){s=Ge(s);var a=Qi(s)?Jn(s):e,l=a?a[0]:s.charAt(0),d=a?Zr(a,1).join(""):s.slice(1);return l[r]()+d}}function to(r){return function(s){return td(r_(n_(s).replace(u0,"")),r,"")}}function ms(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var a=Zi(r.prototype),l=r.apply(a,s);return _t(l)?l:a}}function yE(r,s,a){var l=ms(r);function d(){for(var _=arguments.length,w=$(_),R=_,A=no(d);R--;)w[R]=arguments[R];var G=_<3&&w[0]!==A&&w[_-1]!==A?[]:Gr(w,A);if(_-=G.length,_<a)return lb(r,s,Xa,d.placeholder,e,w,G,e,e,a-_);var J=this&&this!==qt&&this instanceof d?l:r;return xn(J,this,w)}return d}function sb(r){return function(s,a,l){var d=et(s);if(!un(s)){var _=le(a,3);s=Lt(s),a=function(R){return _(d[R],R,d)}}var w=r(s,a,l);return w>-1?d[_?s[w]:w]:e}}function ab(r){return Ir(function(s){var a=s.length,l=a,d=Mn.prototype.thru;for(r&&s.reverse();l--;){var _=s[l];if(typeof _!="function")throw new An(o);if(d&&!w&&ec(_)=="wrapper")var w=new Mn([],!0)}for(l=w?l:a;++l<a;){_=s[l];var R=ec(_),A=R=="wrapper"?Nd(_):e;A&&Bd(A[0])&&A[1]==(ne|X|P|_e)&&!A[4].length&&A[9]==1?w=w[ec(A[0])].apply(w,A[3]):w=_.length==1&&Bd(_)?w[R]():w.thru(_)}return function(){var G=arguments,J=G[0];if(w&&G.length==1&&we(J))return w.plant(J).value();for(var K=0,re=a?s[K].apply(this,G):J;++K<a;)re=s[K].call(this,re);return re}})}function Xa(r,s,a,l,d,_,w,R,A,G){var J=s&ne,K=s&N,re=s&B,ce=s&(X|D),de=s&Ue,Ce=re?e:ms(r);function fe(){for(var Ae=arguments.length,Le=$(Ae),Cn=Ae;Cn--;)Le[Cn]=arguments[Cn];if(ce)var nn=no(fe),kn=F0(Le,nn);if(l&&(Le=tb(Le,l,d,ce)),_&&(Le=nb(Le,_,w,ce)),Ae-=kn,ce&&Ae<G){var Ct=Gr(Le,nn);return lb(r,s,Xa,fe.placeholder,a,Le,Ct,R,A,G-Ae)}var Yn=K?a:this,Nr=re?Yn[r]:r;return Ae=Le.length,R?Le=UE(Le,R):de&&Ae>1&&Le.reverse(),J&&A<Ae&&(Le.length=A),this&&this!==qt&&this instanceof fe&&(Nr=Ce||ms(Nr)),Nr.apply(Yn,Le)}return fe}function cb(r,s){return function(a,l){return QD(a,r,s(l),{})}}function Ka(r,s){return function(a,l){var d;if(a===e&&l===e)return s;if(a!==e&&(d=a),l!==e){if(d===e)return l;typeof a=="string"||typeof l=="string"?(a=Pn(a),l=Pn(l)):(a=Gm(a),l=Gm(l)),d=r(a,l)}return d}}function Id(r){return Ir(function(s){return s=gt(s,wn(le())),Te(function(a){var l=this;return r(s,function(d){return xn(d,l,a)})})})}function Ya(r,s){s=s===e?" ":Pn(s);var a=s.length;if(a<2)return a?Sd(s,r):s;var l=Sd(s,Oa(r/Ji(s)));return Qi(s)?Zr(Jn(l),0,r).join(""):l.slice(0,r)}function xE(r,s,a,l){var d=s&N,_=ms(r);function w(){for(var R=-1,A=arguments.length,G=-1,J=l.length,K=$(J+A),re=this&&this!==qt&&this instanceof w?_:r;++G<J;)K[G]=l[G];for(;A--;)K[G++]=arguments[++R];return xn(re,d?a:this,K)}return w}function ub(r){return function(s,a,l){return l&&typeof l!="number"&&tn(s,a,l)&&(a=l=e),s=Mr(s),a===e?(a=s,s=0):a=Mr(a),l=l===e?s<a?1:-1:Mr(l),sE(s,a,l,r)}}function Za(r){return function(s,a){return typeof s=="string"&&typeof a=="string"||(s=On(s),a=On(a)),r(s,a)}}function lb(r,s,a,l,d,_,w,R,A,G){var J=s&X,K=J?w:e,re=J?e:w,ce=J?_:e,de=J?e:_;s|=J?P:U,s&=~(J?U:P),s&W||(s&=~(N|B));var Ce=[r,s,d,ce,K,de,re,R,A,G],fe=a.apply(e,Ce);return Bd(r)&&wb(fe,Ce),fe.placeholder=l,Pb(fe,r,s)}function Fd(r){var s=At[r];return function(a,l){if(a=On(a),l=l==null?0:Vt(Se(l),292),l&&Pm(a)){var d=(Ge(a)+"e").split("e"),_=s(d[0]+"e"+(+d[1]+l));return d=(Ge(_)+"e").split("e"),+(d[0]+"e"+(+d[1]-l))}return s(a)}}var wE=Ki&&1/Ta(new Ki([,-0]))[1]==ke?function(r){return new Ki(r)}:ef;function db(r){return function(s){var a=Gt(s);return a==bt?cd(s):a==Pt?B0(s):I0(s,r(s))}}function Er(r,s,a,l,d,_,w,R){var A=s&B;if(!A&&typeof r!="function")throw new An(o);var G=l?l.length:0;if(G||(s&=~(P|U),l=d=e),w=w===e?w:Mt(Se(w),0),R=R===e?R:Se(R),G-=d?d.length:0,s&U){var J=l,K=d;l=d=e}var re=A?e:Nd(r),ce=[r,s,a,l,d,J,K,_,w,R];if(re&&LE(ce,re),r=ce[0],s=ce[1],a=ce[2],l=ce[3],d=ce[4],R=ce[9]=ce[9]===e?A?0:r.length:Mt(ce[9]-G,0),!R&&s&(X|D)&&(s&=~(X|D)),!s||s==N)var de=vE(r,s,a);else s==X||s==D?de=yE(r,s,R):(s==P||s==(N|P))&&!d.length?de=xE(r,s,a,l):de=Xa.apply(e,ce);var Ce=re?Hm:wb;return Pb(Ce(de,ce),r,s)}function fb(r,s,a,l){return r===e||Kn(r,Xi[a])&&!Xe.call(l,a)?s:r}function hb(r,s,a,l,d,_){return _t(r)&&_t(s)&&(_.set(s,r),Va(r,s,e,hb,_),_.delete(s)),r}function PE(r){return vs(r)?e:r}function gb(r,s,a,l,d,_){var w=a&I,R=r.length,A=s.length;if(R!=A&&!(w&&A>R))return!1;var G=_.get(r),J=_.get(s);if(G&&J)return G==s&&J==r;var K=-1,re=!0,ce=a&M?new Ci:e;for(_.set(r,s),_.set(s,r);++K<R;){var de=r[K],Ce=s[K];if(l)var fe=w?l(Ce,de,K,s,r,_):l(de,Ce,K,r,s,_);if(fe!==e){if(fe)continue;re=!1;break}if(ce){if(!nd(s,function(Ae,Le){if(!os(ce,Le)&&(de===Ae||d(de,Ae,a,l,_)))return ce.push(Le)})){re=!1;break}}else if(!(de===Ce||d(de,Ce,a,l,_))){re=!1;break}}return _.delete(r),_.delete(s),re}function SE(r,s,a,l,d,_,w){switch(a){case _n:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case Gn:return!(r.byteLength!=s.byteLength||!_(new Ma(r),new Ma(s)));case lr:case dr:case fr:return Kn(+r,+s);case wr:return r.name==s.name&&r.message==s.message;case hr:case sn:return r==s+"";case bt:var R=cd;case Pt:var A=l&I;if(R||(R=Ta),r.size!=s.size&&!A)return!1;var G=w.get(r);if(G)return G==s;l|=M,w.set(r,s);var J=gb(R(r),R(s),l,d,_,w);return w.delete(r),J;case Cr:if(ls)return ls.call(r)==ls.call(s)}return!1}function CE(r,s,a,l,d,_){var w=a&I,R=Ad(r),A=R.length,G=Ad(s),J=G.length;if(A!=J&&!w)return!1;for(var K=A;K--;){var re=R[K];if(!(w?re in s:Xe.call(s,re)))return!1}var ce=_.get(r),de=_.get(s);if(ce&&de)return ce==s&&de==r;var Ce=!0;_.set(r,s),_.set(s,r);for(var fe=w;++K<A;){re=R[K];var Ae=r[re],Le=s[re];if(l)var Cn=w?l(Le,Ae,re,s,r,_):l(Ae,Le,re,r,s,_);if(!(Cn===e?Ae===Le||d(Ae,Le,a,l,_):Cn)){Ce=!1;break}fe||(fe=re=="constructor")}if(Ce&&!fe){var nn=r.constructor,kn=s.constructor;nn!=kn&&"constructor"in r&&"constructor"in s&&!(typeof nn=="function"&&nn instanceof nn&&typeof kn=="function"&&kn instanceof kn)&&(Ce=!1)}return _.delete(r),_.delete(s),Ce}function Ir(r){return $d(yb(r,e,Db),r+"")}function Ad(r){return Mm(r,Lt,Ld)}function Md(r){return Mm(r,ln,pb)}var Nd=Ua?function(r){return Ua.get(r)}:ef;function ec(r){for(var s=r.name+"",a=Yi[s],l=Xe.call(Yi,s)?a.length:0;l--;){var d=a[l],_=d.func;if(_==null||_==r)return d.name}return s}function no(r){var s=Xe.call(m,"placeholder")?m:r;return s.placeholder}function le(){var r=m.iteratee||Yd;return r=r===Yd?Lm:r,arguments.length?r(arguments[0],arguments[1]):r}function tc(r,s){var a=r.__data__;return AE(s)?a[typeof s=="string"?"string":"hash"]:a.map}function qd(r){for(var s=Lt(r),a=s.length;a--;){var l=s[a],d=r[l];s[a]=[l,d,_b(d)]}return s}function Ti(r,s){var a=q0(r,s);return qm(a)?a:e}function kE(r){var s=Xe.call(r,Pi),a=r[Pi];try{r[Pi]=e;var l=!0}catch{}var d=Fa.call(r);return l&&(s?r[Pi]=a:delete r[Pi]),d}var Ld=ld?function(r){return r==null?[]:(r=et(r),Hr(ld(r),function(s){return xm.call(r,s)}))}:tf,pb=ld?function(r){for(var s=[];r;)Vr(s,Ld(r)),r=Na(r);return s}:tf,Gt=en;(dd&&Gt(new dd(new ArrayBuffer(1)))!=_n||as&&Gt(new as)!=bt||fd&&Gt(fd.resolve())!=yi||Ki&&Gt(new Ki)!=Pt||cs&&Gt(new cs)!=Ht)&&(Gt=function(r){var s=en(r),a=s==Ut?r.constructor:e,l=a?Di(a):"";if(l)switch(l){case cD:return _n;case uD:return bt;case lD:return yi;case dD:return Pt;case fD:return Ht}return s});function RE(r,s,a){for(var l=-1,d=a.length;++l<d;){var _=a[l],w=_.size;switch(_.type){case"drop":r+=w;break;case"dropRight":s-=w;break;case"take":s=Vt(s,r+w);break;case"takeRight":r=Mt(r,s-w);break}}return{start:r,end:s}}function TE(r){var s=r.match(h);return s?s[1].split(L):[]}function mb(r,s,a){s=Yr(s,r);for(var l=-1,d=s.length,_=!1;++l<d;){var w=mr(s[l]);if(!(_=r!=null&&a(r,w)))break;r=r[w]}return _||++l!=d?_:(d=r==null?0:r.length,!!d&&cc(d)&&Fr(w,d)&&(we(r)||Ei(r)))}function DE(r){var s=r.length,a=new r.constructor(s);return s&&typeof r[0]=="string"&&Xe.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function bb(r){return typeof r.constructor=="function"&&!bs(r)?Zi(Na(r)):{}}function EE(r,s,a){var l=r.constructor;switch(s){case Gn:return Ed(r);case lr:case dr:return new l(+r);case _n:return hE(r,a);case kr:case vn:case S:case V:case ee:case oe:case $e:case Be:case Qe:return Zm(r,a);case bt:return new l;case fr:case sn:return new l(r);case hr:return gE(r);case Pt:return new l;case Cr:return pE(r)}}function IE(r,s){var a=s.length;if(!a)return r;var l=a-1;return s[l]=(a>1?"& ":"")+s[l],s=s.join(a>2?", ":" "),r.replace(v,`{
/* [wrapped with `+s+`] */
`)}function FE(r){return we(r)||Ei(r)||!!(wm&&r&&r[wm])}function Fr(r,s){var a=typeof r;return s=s??ge,!!s&&(a=="number"||a!="symbol"&&Hi.test(r))&&r>-1&&r%1==0&&r<s}function tn(r,s,a){if(!_t(a))return!1;var l=typeof s;return(l=="number"?un(a)&&Fr(s,a.length):l=="string"&&s in a)?Kn(a[s],r):!1}function Od(r,s){if(we(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Sn(r)?!0:xa.test(r)||!ya.test(r)||s!=null&&r in et(s)}function AE(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function Bd(r){var s=ec(r),a=m[s];if(typeof a!="function"||!(s in Me.prototype))return!1;if(r===a)return!0;var l=Nd(a);return!!l&&r===l[0]}function ME(r){return!!_m&&_m in r}var NE=Ea?Ar:nf;function bs(r){var s=r&&r.constructor,a=typeof s=="function"&&s.prototype||Xi;return r===a}function _b(r){return r===r&&!_t(r)}function vb(r,s){return function(a){return a==null?!1:a[r]===s&&(s!==e||r in et(a))}}function qE(r){var s=sc(r,function(l){return a.size===f&&a.clear(),l}),a=s.cache;return s}function LE(r,s){var a=r[1],l=s[1],d=a|l,_=d<(N|B|ne),w=l==ne&&a==X||l==ne&&a==_e&&r[7].length<=s[8]||l==(ne|_e)&&s[7].length<=s[8]&&a==X;if(!(_||w))return r;l&N&&(r[2]=s[2],d|=a&N?0:W);var R=s[3];if(R){var A=r[3];r[3]=A?tb(A,R,s[4]):R,r[4]=A?Gr(r[3],g):s[4]}return R=s[5],R&&(A=r[5],r[5]=A?nb(A,R,s[6]):R,r[6]=A?Gr(r[5],g):s[6]),R=s[7],R&&(r[7]=R),l&ne&&(r[8]=r[8]==null?s[8]:Vt(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=d,r}function OE(r){var s=[];if(r!=null)for(var a in et(r))s.push(a);return s}function BE(r){return Fa.call(r)}function yb(r,s,a){return s=Mt(s===e?r.length-1:s,0),function(){for(var l=arguments,d=-1,_=Mt(l.length-s,0),w=$(_);++d<_;)w[d]=l[s+d];d=-1;for(var R=$(s+1);++d<s;)R[d]=l[d];return R[s]=a(w),xn(r,this,R)}}function xb(r,s){return s.length<2?r:Ri(r,qn(s,0,-1))}function UE(r,s){for(var a=r.length,l=Vt(s.length,a),d=cn(r);l--;){var _=s[l];r[l]=Fr(_,a)?d[_]:e}return r}function Ud(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}var wb=Sb(Hm),_s=tD||function(r,s){return qt.setTimeout(r,s)},$d=Sb(uE);function Pb(r,s,a){var l=s+"";return $d(r,IE(l,$E(TE(l),a)))}function Sb(r){var s=0,a=0;return function(){var l=oD(),d=Y-(l-a);if(a=l,d>0){if(++s>=xe)return arguments[0]}else s=0;return r.apply(e,arguments)}}function nc(r,s){var a=-1,l=r.length,d=l-1;for(s=s===e?l:s;++a<s;){var _=Pd(a,d),w=r[_];r[_]=r[a],r[a]=w}return r.length=s,r}var Cb=qE(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(Vl,function(a,l,d,_){s.push(d?_.replace(ht,"$1"):l||a)}),s});function mr(r){if(typeof r=="string"||Sn(r))return r;var s=r+"";return s=="0"&&1/r==-ke?"-0":s}function Di(r){if(r!=null){try{return Ia.call(r)}catch{}try{return r+""}catch{}}return""}function $E(r,s){return Fn(xr,function(a){var l="_."+a[0];s&a[1]&&!ka(r,l)&&r.push(l)}),r.sort()}function kb(r){if(r instanceof Me)return r.clone();var s=new Mn(r.__wrapped__,r.__chain__);return s.__actions__=cn(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}function WE(r,s,a){(a?tn(r,s,a):s===e)?s=1:s=Mt(Se(s),0);var l=r==null?0:r.length;if(!l||s<1)return[];for(var d=0,_=0,w=$(Oa(l/s));d<l;)w[_++]=qn(r,d,d+=s);return w}function jE(r){for(var s=-1,a=r==null?0:r.length,l=0,d=[];++s<a;){var _=r[s];_&&(d[l++]=_)}return d}function zE(){var r=arguments.length;if(!r)return[];for(var s=$(r-1),a=arguments[0],l=r;l--;)s[l-1]=arguments[l];return Vr(we(a)?cn(a):[a],$t(s,1))}var HE=Te(function(r,s){return St(r)?fs(r,$t(s,1,St,!0)):[]}),VE=Te(function(r,s){var a=Ln(s);return St(a)&&(a=e),St(r)?fs(r,$t(s,1,St,!0),le(a,2)):[]}),GE=Te(function(r,s){var a=Ln(s);return St(a)&&(a=e),St(r)?fs(r,$t(s,1,St,!0),e,a):[]});function QE(r,s,a){var l=r==null?0:r.length;return l?(s=a||s===e?1:Se(s),qn(r,s<0?0:s,l)):[]}function JE(r,s,a){var l=r==null?0:r.length;return l?(s=a||s===e?1:Se(s),s=l-s,qn(r,0,s<0?0:s)):[]}function XE(r,s){return r&&r.length?Qa(r,le(s,3),!0,!0):[]}function KE(r,s){return r&&r.length?Qa(r,le(s,3),!0):[]}function YE(r,s,a,l){var d=r==null?0:r.length;return d?(a&&typeof a!="number"&&tn(r,s,a)&&(a=0,l=d),zD(r,s,a,l)):[]}function Rb(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var d=a==null?0:Se(a);return d<0&&(d=Mt(l+d,0)),Ra(r,le(s,3),d)}function Tb(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var d=l-1;return a!==e&&(d=Se(a),d=a<0?Mt(l+d,0):Vt(d,l-1)),Ra(r,le(s,3),d,!0)}function Db(r){var s=r==null?0:r.length;return s?$t(r,1):[]}function ZE(r){var s=r==null?0:r.length;return s?$t(r,ke):[]}function eI(r,s){var a=r==null?0:r.length;return a?(s=s===e?1:Se(s),$t(r,s)):[]}function tI(r){for(var s=-1,a=r==null?0:r.length,l={};++s<a;){var d=r[s];l[d[0]]=d[1]}return l}function Eb(r){return r&&r.length?r[0]:e}function nI(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var d=a==null?0:Se(a);return d<0&&(d=Mt(l+d,0)),Gi(r,s,d)}function rI(r){var s=r==null?0:r.length;return s?qn(r,0,-1):[]}var iI=Te(function(r){var s=gt(r,Td);return s.length&&s[0]===r[0]?_d(s):[]}),oI=Te(function(r){var s=Ln(r),a=gt(r,Td);return s===Ln(a)?s=e:a.pop(),a.length&&a[0]===r[0]?_d(a,le(s,2)):[]}),sI=Te(function(r){var s=Ln(r),a=gt(r,Td);return s=typeof s=="function"?s:e,s&&a.pop(),a.length&&a[0]===r[0]?_d(a,e,s):[]});function aI(r,s){return r==null?"":rD.call(r,s)}function Ln(r){var s=r==null?0:r.length;return s?r[s-1]:e}function cI(r,s,a){var l=r==null?0:r.length;if(!l)return-1;var d=l;return a!==e&&(d=Se(a),d=d<0?Mt(l+d,0):Vt(d,l-1)),s===s?$0(r,s,d):Ra(r,lm,d,!0)}function uI(r,s){return r&&r.length?$m(r,Se(s)):e}var lI=Te(Ib);function Ib(r,s){return r&&r.length&&s&&s.length?wd(r,s):r}function dI(r,s,a){return r&&r.length&&s&&s.length?wd(r,s,le(a,2)):r}function fI(r,s,a){return r&&r.length&&s&&s.length?wd(r,s,e,a):r}var hI=Ir(function(r,s){var a=r==null?0:r.length,l=gd(r,s);return zm(r,gt(s,function(d){return Fr(d,a)?+d:d}).sort(eb)),l});function gI(r,s){var a=[];if(!(r&&r.length))return a;var l=-1,d=[],_=r.length;for(s=le(s,3);++l<_;){var w=r[l];s(w,l,r)&&(a.push(w),d.push(l))}return zm(r,d),a}function Wd(r){return r==null?r:aD.call(r)}function pI(r,s,a){var l=r==null?0:r.length;return l?(a&&typeof a!="number"&&tn(r,s,a)?(s=0,a=l):(s=s==null?0:Se(s),a=a===e?l:Se(a)),qn(r,s,a)):[]}function mI(r,s){return Ga(r,s)}function bI(r,s,a){return Cd(r,s,le(a,2))}function _I(r,s){var a=r==null?0:r.length;if(a){var l=Ga(r,s);if(l<a&&Kn(r[l],s))return l}return-1}function vI(r,s){return Ga(r,s,!0)}function yI(r,s,a){return Cd(r,s,le(a,2),!0)}function xI(r,s){var a=r==null?0:r.length;if(a){var l=Ga(r,s,!0)-1;if(Kn(r[l],s))return l}return-1}function wI(r){return r&&r.length?Vm(r):[]}function PI(r,s){return r&&r.length?Vm(r,le(s,2)):[]}function SI(r){var s=r==null?0:r.length;return s?qn(r,1,s):[]}function CI(r,s,a){return r&&r.length?(s=a||s===e?1:Se(s),qn(r,0,s<0?0:s)):[]}function kI(r,s,a){var l=r==null?0:r.length;return l?(s=a||s===e?1:Se(s),s=l-s,qn(r,s<0?0:s,l)):[]}function RI(r,s){return r&&r.length?Qa(r,le(s,3),!1,!0):[]}function TI(r,s){return r&&r.length?Qa(r,le(s,3)):[]}var DI=Te(function(r){return Kr($t(r,1,St,!0))}),EI=Te(function(r){var s=Ln(r);return St(s)&&(s=e),Kr($t(r,1,St,!0),le(s,2))}),II=Te(function(r){var s=Ln(r);return s=typeof s=="function"?s:e,Kr($t(r,1,St,!0),e,s)});function FI(r){return r&&r.length?Kr(r):[]}function AI(r,s){return r&&r.length?Kr(r,le(s,2)):[]}function MI(r,s){return s=typeof s=="function"?s:e,r&&r.length?Kr(r,e,s):[]}function jd(r){if(!(r&&r.length))return[];var s=0;return r=Hr(r,function(a){if(St(a))return s=Mt(a.length,s),!0}),sd(s,function(a){return gt(r,rd(a))})}function Fb(r,s){if(!(r&&r.length))return[];var a=jd(r);return s==null?a:gt(a,function(l){return xn(s,e,l)})}var NI=Te(function(r,s){return St(r)?fs(r,s):[]}),qI=Te(function(r){return Rd(Hr(r,St))}),LI=Te(function(r){var s=Ln(r);return St(s)&&(s=e),Rd(Hr(r,St),le(s,2))}),OI=Te(function(r){var s=Ln(r);return s=typeof s=="function"?s:e,Rd(Hr(r,St),e,s)}),BI=Te(jd);function UI(r,s){return Xm(r||[],s||[],ds)}function $I(r,s){return Xm(r||[],s||[],ps)}var WI=Te(function(r){var s=r.length,a=s>1?r[s-1]:e;return a=typeof a=="function"?(r.pop(),a):e,Fb(r,a)});function Ab(r){var s=m(r);return s.__chain__=!0,s}function jI(r,s){return s(r),r}function rc(r,s){return s(r)}var zI=Ir(function(r){var s=r.length,a=s?r[0]:0,l=this.__wrapped__,d=function(_){return gd(_,r)};return s>1||this.__actions__.length||!(l instanceof Me)||!Fr(a)?this.thru(d):(l=l.slice(a,+a+(s?1:0)),l.__actions__.push({func:rc,args:[d],thisArg:e}),new Mn(l,this.__chain__).thru(function(_){return s&&!_.length&&_.push(e),_}))});function HI(){return Ab(this)}function VI(){return new Mn(this.value(),this.__chain__)}function GI(){this.__values__===e&&(this.__values__=Gb(this.value()));var r=this.__index__>=this.__values__.length,s=r?e:this.__values__[this.__index__++];return{done:r,value:s}}function QI(){return this}function JI(r){for(var s,a=this;a instanceof Wa;){var l=kb(a);l.__index__=0,l.__values__=e,s?d.__wrapped__=l:s=l;var d=l;a=a.__wrapped__}return d.__wrapped__=r,s}function XI(){var r=this.__wrapped__;if(r instanceof Me){var s=r;return this.__actions__.length&&(s=new Me(this)),s=s.reverse(),s.__actions__.push({func:rc,args:[Wd],thisArg:e}),new Mn(s,this.__chain__)}return this.thru(Wd)}function KI(){return Jm(this.__wrapped__,this.__actions__)}var YI=Ja(function(r,s,a){Xe.call(r,a)?++r[a]:Dr(r,a,1)});function ZI(r,s,a){var l=we(r)?cm:jD;return a&&tn(r,s,a)&&(s=e),l(r,le(s,3))}function eF(r,s){var a=we(r)?Hr:Fm;return a(r,le(s,3))}var tF=sb(Rb),nF=sb(Tb);function rF(r,s){return $t(ic(r,s),1)}function iF(r,s){return $t(ic(r,s),ke)}function oF(r,s,a){return a=a===e?1:Se(a),$t(ic(r,s),a)}function Mb(r,s){var a=we(r)?Fn:Xr;return a(r,le(s,3))}function Nb(r,s){var a=we(r)?S0:Im;return a(r,le(s,3))}var sF=Ja(function(r,s,a){Xe.call(r,a)?r[a].push(s):Dr(r,a,[s])});function aF(r,s,a,l){r=un(r)?r:io(r),a=a&&!l?Se(a):0;var d=r.length;return a<0&&(a=Mt(d+a,0)),uc(r)?a<=d&&r.indexOf(s,a)>-1:!!d&&Gi(r,s,a)>-1}var cF=Te(function(r,s,a){var l=-1,d=typeof s=="function",_=un(r)?$(r.length):[];return Xr(r,function(w){_[++l]=d?xn(s,w,a):hs(w,s,a)}),_}),uF=Ja(function(r,s,a){Dr(r,a,s)});function ic(r,s){var a=we(r)?gt:Om;return a(r,le(s,3))}function lF(r,s,a,l){return r==null?[]:(we(s)||(s=s==null?[]:[s]),a=l?e:a,we(a)||(a=a==null?[]:[a]),Wm(r,s,a))}var dF=Ja(function(r,s,a){r[a?0:1].push(s)},function(){return[[],[]]});function fF(r,s,a){var l=we(r)?td:fm,d=arguments.length<3;return l(r,le(s,4),a,d,Xr)}function hF(r,s,a){var l=we(r)?C0:fm,d=arguments.length<3;return l(r,le(s,4),a,d,Im)}function gF(r,s){var a=we(r)?Hr:Fm;return a(r,ac(le(s,3)))}function pF(r){var s=we(r)?Rm:aE;return s(r)}function mF(r,s,a){(a?tn(r,s,a):s===e)?s=1:s=Se(s);var l=we(r)?OD:cE;return l(r,s)}function bF(r){var s=we(r)?BD:lE;return s(r)}function _F(r){if(r==null)return 0;if(un(r))return uc(r)?Ji(r):r.length;var s=Gt(r);return s==bt||s==Pt?r.size:yd(r).length}function vF(r,s,a){var l=we(r)?nd:dE;return a&&tn(r,s,a)&&(s=e),l(r,le(s,3))}var yF=Te(function(r,s){if(r==null)return[];var a=s.length;return a>1&&tn(r,s[0],s[1])?s=[]:a>2&&tn(s[0],s[1],s[2])&&(s=[s[0]]),Wm(r,$t(s,1),[])}),oc=eD||function(){return qt.Date.now()};function xF(r,s){if(typeof s!="function")throw new An(o);return r=Se(r),function(){if(--r<1)return s.apply(this,arguments)}}function qb(r,s,a){return s=a?e:s,s=r&&s==null?r.length:s,Er(r,ne,e,e,e,e,s)}function Lb(r,s){var a;if(typeof s!="function")throw new An(o);return r=Se(r),function(){return--r>0&&(a=s.apply(this,arguments)),r<=1&&(s=e),a}}var zd=Te(function(r,s,a){var l=N;if(a.length){var d=Gr(a,no(zd));l|=P}return Er(r,l,s,a,d)}),Ob=Te(function(r,s,a){var l=N|B;if(a.length){var d=Gr(a,no(Ob));l|=P}return Er(s,l,r,a,d)});function Bb(r,s,a){s=a?e:s;var l=Er(r,X,e,e,e,e,e,s);return l.placeholder=Bb.placeholder,l}function Ub(r,s,a){s=a?e:s;var l=Er(r,D,e,e,e,e,e,s);return l.placeholder=Ub.placeholder,l}function $b(r,s,a){var l,d,_,w,R,A,G=0,J=!1,K=!1,re=!0;if(typeof r!="function")throw new An(o);s=On(s)||0,_t(a)&&(J=!!a.leading,K="maxWait"in a,_=K?Mt(On(a.maxWait)||0,s):_,re="trailing"in a?!!a.trailing:re);function ce(Ct){var Yn=l,Nr=d;return l=d=e,G=Ct,w=r.apply(Nr,Yn),w}function de(Ct){return G=Ct,R=_s(Ae,s),J?ce(Ct):w}function Ce(Ct){var Yn=Ct-A,Nr=Ct-G,s_=s-Yn;return K?Vt(s_,_-Nr):s_}function fe(Ct){var Yn=Ct-A,Nr=Ct-G;return A===e||Yn>=s||Yn<0||K&&Nr>=_}function Ae(){var Ct=oc();if(fe(Ct))return Le(Ct);R=_s(Ae,Ce(Ct))}function Le(Ct){return R=e,re&&l?ce(Ct):(l=d=e,w)}function Cn(){R!==e&&Km(R),G=0,l=A=d=R=e}function nn(){return R===e?w:Le(oc())}function kn(){var Ct=oc(),Yn=fe(Ct);if(l=arguments,d=this,A=Ct,Yn){if(R===e)return de(A);if(K)return Km(R),R=_s(Ae,s),ce(A)}return R===e&&(R=_s(Ae,s)),w}return kn.cancel=Cn,kn.flush=nn,kn}var wF=Te(function(r,s){return Em(r,1,s)}),PF=Te(function(r,s,a){return Em(r,On(s)||0,a)});function SF(r){return Er(r,Ue)}function sc(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new An(o);var a=function(){var l=arguments,d=s?s.apply(this,l):l[0],_=a.cache;if(_.has(d))return _.get(d);var w=r.apply(this,l);return a.cache=_.set(d,w)||_,w};return a.cache=new(sc.Cache||Tr),a}sc.Cache=Tr;function ac(r){if(typeof r!="function")throw new An(o);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}function CF(r){return Lb(2,r)}var kF=fE(function(r,s){s=s.length==1&&we(s[0])?gt(s[0],wn(le())):gt($t(s,1),wn(le()));var a=s.length;return Te(function(l){for(var d=-1,_=Vt(l.length,a);++d<_;)l[d]=s[d].call(this,l[d]);return xn(r,this,l)})}),Hd=Te(function(r,s){var a=Gr(s,no(Hd));return Er(r,P,e,s,a)}),Wb=Te(function(r,s){var a=Gr(s,no(Wb));return Er(r,U,e,s,a)}),RF=Ir(function(r,s){return Er(r,_e,e,e,e,s)});function TF(r,s){if(typeof r!="function")throw new An(o);return s=s===e?s:Se(s),Te(r,s)}function DF(r,s){if(typeof r!="function")throw new An(o);return s=s==null?0:Mt(Se(s),0),Te(function(a){var l=a[s],d=Zr(a,0,s);return l&&Vr(d,l),xn(r,this,d)})}function EF(r,s,a){var l=!0,d=!0;if(typeof r!="function")throw new An(o);return _t(a)&&(l="leading"in a?!!a.leading:l,d="trailing"in a?!!a.trailing:d),$b(r,s,{leading:l,maxWait:s,trailing:d})}function IF(r){return qb(r,1)}function FF(r,s){return Hd(Dd(s),r)}function AF(){if(!arguments.length)return[];var r=arguments[0];return we(r)?r:[r]}function MF(r){return Nn(r,k)}function NF(r,s){return s=typeof s=="function"?s:e,Nn(r,k,s)}function qF(r){return Nn(r,b|k)}function LF(r,s){return s=typeof s=="function"?s:e,Nn(r,b|k,s)}function OF(r,s){return s==null||Dm(r,s,Lt(s))}function Kn(r,s){return r===s||r!==r&&s!==s}var BF=Za(bd),UF=Za(function(r,s){return r>=s}),Ei=Nm(function(){return arguments}())?Nm:function(r){return yt(r)&&Xe.call(r,"callee")&&!xm.call(r,"callee")},we=$.isArray,$F=nm?wn(nm):JD;function un(r){return r!=null&&cc(r.length)&&!Ar(r)}function St(r){return yt(r)&&un(r)}function WF(r){return r===!0||r===!1||yt(r)&&en(r)==lr}var ei=nD||nf,jF=rm?wn(rm):XD;function zF(r){return yt(r)&&r.nodeType===1&&!vs(r)}function HF(r){if(r==null)return!0;if(un(r)&&(we(r)||typeof r=="string"||typeof r.splice=="function"||ei(r)||ro(r)||Ei(r)))return!r.length;var s=Gt(r);if(s==bt||s==Pt)return!r.size;if(bs(r))return!yd(r).length;for(var a in r)if(Xe.call(r,a))return!1;return!0}function VF(r,s){return gs(r,s)}function GF(r,s,a){a=typeof a=="function"?a:e;var l=a?a(r,s):e;return l===e?gs(r,s,e,a):!!l}function Vd(r){if(!yt(r))return!1;var s=en(r);return s==wr||s==$i||typeof r.message=="string"&&typeof r.name=="string"&&!vs(r)}function QF(r){return typeof r=="number"&&Pm(r)}function Ar(r){if(!_t(r))return!1;var s=en(r);return s==Pr||s==Sr||s==vi||s==jr}function jb(r){return typeof r=="number"&&r==Se(r)}function cc(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=ge}function _t(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function yt(r){return r!=null&&typeof r=="object"}var zb=im?wn(im):YD;function JF(r,s){return r===s||vd(r,s,qd(s))}function XF(r,s,a){return a=typeof a=="function"?a:e,vd(r,s,qd(s),a)}function KF(r){return Hb(r)&&r!=+r}function YF(r){if(NE(r))throw new ve(i);return qm(r)}function ZF(r){return r===null}function eA(r){return r==null}function Hb(r){return typeof r=="number"||yt(r)&&en(r)==fr}function vs(r){if(!yt(r)||en(r)!=Ut)return!1;var s=Na(r);if(s===null)return!0;var a=Xe.call(s,"constructor")&&s.constructor;return typeof a=="function"&&a instanceof a&&Ia.call(a)==X0}var Gd=om?wn(om):ZD;function tA(r){return jb(r)&&r>=-ge&&r<=ge}var Vb=sm?wn(sm):eE;function uc(r){return typeof r=="string"||!we(r)&&yt(r)&&en(r)==sn}function Sn(r){return typeof r=="symbol"||yt(r)&&en(r)==Cr}var ro=am?wn(am):tE;function nA(r){return r===e}function rA(r){return yt(r)&&Gt(r)==Ht}function iA(r){return yt(r)&&en(r)==xi}var oA=Za(xd),sA=Za(function(r,s){return r<=s});function Gb(r){if(!r)return[];if(un(r))return uc(r)?Jn(r):cn(r);if(ss&&r[ss])return O0(r[ss]());var s=Gt(r),a=s==bt?cd:s==Pt?Ta:io;return a(r)}function Mr(r){if(!r)return r===0?r:0;if(r=On(r),r===ke||r===-ke){var s=r<0?-1:1;return s*pe}return r===r?r:0}function Se(r){var s=Mr(r),a=s%1;return s===s?a?s-a:s:0}function Qb(r){return r?ki(Se(r),0,je):0}function On(r){if(typeof r=="number")return r;if(Sn(r))return wt;if(_t(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=_t(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=hm(r);var a=Qn.test(r);return a||zr.test(r)?x0(r.slice(2),a?2:8):yn.test(r)?wt:+r}function Jb(r){return pr(r,ln(r))}function aA(r){return r?ki(Se(r),-ge,ge):r===0?r:0}function Ge(r){return r==null?"":Pn(r)}var cA=eo(function(r,s){if(bs(s)||un(s)){pr(s,Lt(s),r);return}for(var a in s)Xe.call(s,a)&&ds(r,a,s[a])}),Xb=eo(function(r,s){pr(s,ln(s),r)}),lc=eo(function(r,s,a,l){pr(s,ln(s),r,l)}),uA=eo(function(r,s,a,l){pr(s,Lt(s),r,l)}),lA=Ir(gd);function dA(r,s){var a=Zi(r);return s==null?a:Tm(a,s)}var fA=Te(function(r,s){r=et(r);var a=-1,l=s.length,d=l>2?s[2]:e;for(d&&tn(s[0],s[1],d)&&(l=1);++a<l;)for(var _=s[a],w=ln(_),R=-1,A=w.length;++R<A;){var G=w[R],J=r[G];(J===e||Kn(J,Xi[G])&&!Xe.call(r,G))&&(r[G]=_[G])}return r}),hA=Te(function(r){return r.push(e,hb),xn(Kb,e,r)});function gA(r,s){return um(r,le(s,3),gr)}function pA(r,s){return um(r,le(s,3),md)}function mA(r,s){return r==null?r:pd(r,le(s,3),ln)}function bA(r,s){return r==null?r:Am(r,le(s,3),ln)}function _A(r,s){return r&&gr(r,le(s,3))}function vA(r,s){return r&&md(r,le(s,3))}function yA(r){return r==null?[]:Ha(r,Lt(r))}function xA(r){return r==null?[]:Ha(r,ln(r))}function Qd(r,s,a){var l=r==null?e:Ri(r,s);return l===e?a:l}function wA(r,s){return r!=null&&mb(r,s,HD)}function Jd(r,s){return r!=null&&mb(r,s,VD)}var PA=cb(function(r,s,a){s!=null&&typeof s.toString!="function"&&(s=Fa.call(s)),r[s]=a},Kd(dn)),SA=cb(function(r,s,a){s!=null&&typeof s.toString!="function"&&(s=Fa.call(s)),Xe.call(r,s)?r[s].push(a):r[s]=[a]},le),CA=Te(hs);function Lt(r){return un(r)?km(r):yd(r)}function ln(r){return un(r)?km(r,!0):nE(r)}function kA(r,s){var a={};return s=le(s,3),gr(r,function(l,d,_){Dr(a,s(l,d,_),l)}),a}function RA(r,s){var a={};return s=le(s,3),gr(r,function(l,d,_){Dr(a,d,s(l,d,_))}),a}var TA=eo(function(r,s,a){Va(r,s,a)}),Kb=eo(function(r,s,a,l){Va(r,s,a,l)}),DA=Ir(function(r,s){var a={};if(r==null)return a;var l=!1;s=gt(s,function(_){return _=Yr(_,r),l||(l=_.length>1),_}),pr(r,Md(r),a),l&&(a=Nn(a,b|x|k,PE));for(var d=s.length;d--;)kd(a,s[d]);return a});function EA(r,s){return Yb(r,ac(le(s)))}var IA=Ir(function(r,s){return r==null?{}:iE(r,s)});function Yb(r,s){if(r==null)return{};var a=gt(Md(r),function(l){return[l]});return s=le(s),jm(r,a,function(l,d){return s(l,d[0])})}function FA(r,s,a){s=Yr(s,r);var l=-1,d=s.length;for(d||(d=1,r=e);++l<d;){var _=r==null?e:r[mr(s[l])];_===e&&(l=d,_=a),r=Ar(_)?_.call(r):_}return r}function AA(r,s,a){return r==null?r:ps(r,s,a)}function MA(r,s,a,l){return l=typeof l=="function"?l:e,r==null?r:ps(r,s,a,l)}var Zb=db(Lt),e_=db(ln);function NA(r,s,a){var l=we(r),d=l||ei(r)||ro(r);if(s=le(s,4),a==null){var _=r&&r.constructor;d?a=l?new _:[]:_t(r)?a=Ar(_)?Zi(Na(r)):{}:a={}}return(d?Fn:gr)(r,function(w,R,A){return s(a,w,R,A)}),a}function qA(r,s){return r==null?!0:kd(r,s)}function LA(r,s,a){return r==null?r:Qm(r,s,Dd(a))}function OA(r,s,a,l){return l=typeof l=="function"?l:e,r==null?r:Qm(r,s,Dd(a),l)}function io(r){return r==null?[]:ad(r,Lt(r))}function BA(r){return r==null?[]:ad(r,ln(r))}function UA(r,s,a){return a===e&&(a=s,s=e),a!==e&&(a=On(a),a=a===a?a:0),s!==e&&(s=On(s),s=s===s?s:0),ki(On(r),s,a)}function $A(r,s,a){return s=Mr(s),a===e?(a=s,s=0):a=Mr(a),r=On(r),GD(r,s,a)}function WA(r,s,a){if(a&&typeof a!="boolean"&&tn(r,s,a)&&(s=a=e),a===e&&(typeof s=="boolean"?(a=s,s=e):typeof r=="boolean"&&(a=r,r=e)),r===e&&s===e?(r=0,s=1):(r=Mr(r),s===e?(s=r,r=0):s=Mr(s)),r>s){var l=r;r=s,s=l}if(a||r%1||s%1){var d=Sm();return Vt(r+d*(s-r+y0("1e-"+((d+"").length-1))),s)}return Pd(r,s)}var jA=to(function(r,s,a){return s=s.toLowerCase(),r+(a?t_(s):s)});function t_(r){return Xd(Ge(r).toLowerCase())}function n_(r){return r=Ge(r),r&&r.replace(wa,A0).replace(l0,"")}function zA(r,s,a){r=Ge(r),s=Pn(s);var l=r.length;a=a===e?l:ki(Se(a),0,l);var d=a;return a-=s.length,a>=0&&r.slice(a,d)==s}function HA(r){return r=Ge(r),r&&Zt.test(r)?r.replace(at,M0):r}function VA(r){return r=Ge(r),r&&p.test(r)?r.replace(q,"\\$&"):r}var GA=to(function(r,s,a){return r+(a?"-":"")+s.toLowerCase()}),QA=to(function(r,s,a){return r+(a?" ":"")+s.toLowerCase()}),JA=ob("toLowerCase");function XA(r,s,a){r=Ge(r),s=Se(s);var l=s?Ji(r):0;if(!s||l>=s)return r;var d=(s-l)/2;return Ya(Ba(d),a)+r+Ya(Oa(d),a)}function KA(r,s,a){r=Ge(r),s=Se(s);var l=s?Ji(r):0;return s&&l<s?r+Ya(s-l,a):r}function YA(r,s,a){r=Ge(r),s=Se(s);var l=s?Ji(r):0;return s&&l<s?Ya(s-l,a)+r:r}function ZA(r,s,a){return a||s==null?s=0:s&&(s=+s),sD(Ge(r).replace(C,""),s||0)}function eM(r,s,a){return(a?tn(r,s,a):s===e)?s=1:s=Se(s),Sd(Ge(r),s)}function tM(){var r=arguments,s=Ge(r[0]);return r.length<3?s:s.replace(r[1],r[2])}var nM=to(function(r,s,a){return r+(a?"_":"")+s.toLowerCase()});function rM(r,s,a){return a&&typeof a!="number"&&tn(r,s,a)&&(s=a=e),a=a===e?je:a>>>0,a?(r=Ge(r),r&&(typeof s=="string"||s!=null&&!Gd(s))&&(s=Pn(s),!s&&Qi(r))?Zr(Jn(r),0,a):r.split(s,a)):[]}var iM=to(function(r,s,a){return r+(a?" ":"")+Xd(s)});function oM(r,s,a){return r=Ge(r),a=a==null?0:ki(Se(a),0,r.length),s=Pn(s),r.slice(a,a+s.length)==s}function sM(r,s,a){var l=m.templateSettings;a&&tn(r,s,a)&&(s=e),r=Ge(r),s=lc({},s,l,fb);var d=lc({},s.imports,l.imports,fb),_=Lt(d),w=ad(d,_),R,A,G=0,J=s.interpolate||Pa,K="__p += '",re=ud((s.escape||Pa).source+"|"+J.source+"|"+(J===is?Ye:Pa).source+"|"+(s.evaluate||Pa).source+"|$","g"),ce="//# sourceURL="+(Xe.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++p0+"]")+`
`;r.replace(re,function(fe,Ae,Le,Cn,nn,kn){return Le||(Le=Cn),K+=r.slice(G,kn).replace(VT,N0),Ae&&(R=!0,K+=`' +
__e(`+Ae+`) +
'`),nn&&(A=!0,K+=`';
`+nn+`;
__p += '`),Le&&(K+=`' +
((__t = (`+Le+`)) == null ? '' : __t) +
'`),G=kn+fe.length,fe}),K+=`';
`;var de=Xe.call(s,"variable")&&s.variable;if(!de)K=`with (obj) {
`+K+`
}
`;else if(be.test(de))throw new ve(c);K=(A?K.replace(nt,""):K).replace(Re,"$1").replace(Je,"$1;"),K="function("+(de||"obj")+`) {
`+(de?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(A?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Ce=i_(function(){return He(_,ce+"return "+K).apply(e,w)});if(Ce.source=K,Vd(Ce))throw Ce;return Ce}function aM(r){return Ge(r).toLowerCase()}function cM(r){return Ge(r).toUpperCase()}function uM(r,s,a){if(r=Ge(r),r&&(a||s===e))return hm(r);if(!r||!(s=Pn(s)))return r;var l=Jn(r),d=Jn(s),_=gm(l,d),w=pm(l,d)+1;return Zr(l,_,w).join("")}function lM(r,s,a){if(r=Ge(r),r&&(a||s===e))return r.slice(0,bm(r)+1);if(!r||!(s=Pn(s)))return r;var l=Jn(r),d=pm(l,Jn(s))+1;return Zr(l,0,d).join("")}function dM(r,s,a){if(r=Ge(r),r&&(a||s===e))return r.replace(C,"");if(!r||!(s=Pn(s)))return r;var l=Jn(r),d=gm(l,Jn(s));return Zr(l,d).join("")}function fM(r,s){var a=Ke,l=Dt;if(_t(s)){var d="separator"in s?s.separator:d;a="length"in s?Se(s.length):a,l="omission"in s?Pn(s.omission):l}r=Ge(r);var _=r.length;if(Qi(r)){var w=Jn(r);_=w.length}if(a>=_)return r;var R=a-Ji(l);if(R<1)return l;var A=w?Zr(w,0,R).join(""):r.slice(0,R);if(d===e)return A+l;if(w&&(R+=A.length-R),Gd(d)){if(r.slice(R).search(d)){var G,J=A;for(d.global||(d=ud(d.source,Ge(an.exec(d))+"g")),d.lastIndex=0;G=d.exec(J);)var K=G.index;A=A.slice(0,K===e?R:K)}}else if(r.indexOf(Pn(d),R)!=R){var re=A.lastIndexOf(d);re>-1&&(A=A.slice(0,re))}return A+l}function hM(r){return r=Ge(r),r&&Et.test(r)?r.replace(qe,W0):r}var gM=to(function(r,s,a){return r+(a?" ":"")+s.toUpperCase()}),Xd=ob("toUpperCase");function r_(r,s,a){return r=Ge(r),s=a?e:s,s===e?L0(r)?H0(r):T0(r):r.match(s)||[]}var i_=Te(function(r,s){try{return xn(r,e,s)}catch(a){return Vd(a)?a:new ve(a)}}),pM=Ir(function(r,s){return Fn(s,function(a){a=mr(a),Dr(r,a,zd(r[a],r))}),r});function mM(r){var s=r==null?0:r.length,a=le();return r=s?gt(r,function(l){if(typeof l[1]!="function")throw new An(o);return[a(l[0]),l[1]]}):[],Te(function(l){for(var d=-1;++d<s;){var _=r[d];if(xn(_[0],this,l))return xn(_[1],this,l)}})}function bM(r){return WD(Nn(r,b))}function Kd(r){return function(){return r}}function _M(r,s){return r==null||r!==r?s:r}var vM=ab(),yM=ab(!0);function dn(r){return r}function Yd(r){return Lm(typeof r=="function"?r:Nn(r,b))}function xM(r){return Bm(Nn(r,b))}function wM(r,s){return Um(r,Nn(s,b))}var PM=Te(function(r,s){return function(a){return hs(a,r,s)}}),SM=Te(function(r,s){return function(a){return hs(r,a,s)}});function Zd(r,s,a){var l=Lt(s),d=Ha(s,l);a==null&&!(_t(s)&&(d.length||!l.length))&&(a=s,s=r,r=this,d=Ha(s,Lt(s)));var _=!(_t(a)&&"chain"in a)||!!a.chain,w=Ar(r);return Fn(d,function(R){var A=s[R];r[R]=A,w&&(r.prototype[R]=function(){var G=this.__chain__;if(_||G){var J=r(this.__wrapped__),K=J.__actions__=cn(this.__actions__);return K.push({func:A,args:arguments,thisArg:r}),J.__chain__=G,J}return A.apply(r,Vr([this.value()],arguments))})}),r}function CM(){return qt._===this&&(qt._=K0),this}function ef(){}function kM(r){return r=Se(r),Te(function(s){return $m(s,r)})}var RM=Id(gt),TM=Id(cm),DM=Id(nd);function o_(r){return Od(r)?rd(mr(r)):oE(r)}function EM(r){return function(s){return r==null?e:Ri(r,s)}}var IM=ub(),FM=ub(!0);function tf(){return[]}function nf(){return!1}function AM(){return{}}function MM(){return""}function NM(){return!0}function qM(r,s){if(r=Se(r),r<1||r>ge)return[];var a=je,l=Vt(r,je);s=le(s),r-=je;for(var d=sd(l,s);++a<r;)s(a);return d}function LM(r){return we(r)?gt(r,mr):Sn(r)?[r]:cn(Cb(Ge(r)))}function OM(r){var s=++J0;return Ge(r)+s}var BM=Ka(function(r,s){return r+s},0),UM=Fd("ceil"),$M=Ka(function(r,s){return r/s},1),WM=Fd("floor");function jM(r){return r&&r.length?za(r,dn,bd):e}function zM(r,s){return r&&r.length?za(r,le(s,2),bd):e}function HM(r){return dm(r,dn)}function VM(r,s){return dm(r,le(s,2))}function GM(r){return r&&r.length?za(r,dn,xd):e}function QM(r,s){return r&&r.length?za(r,le(s,2),xd):e}var JM=Ka(function(r,s){return r*s},1),XM=Fd("round"),KM=Ka(function(r,s){return r-s},0);function YM(r){return r&&r.length?od(r,dn):0}function ZM(r,s){return r&&r.length?od(r,le(s,2)):0}return m.after=xF,m.ary=qb,m.assign=cA,m.assignIn=Xb,m.assignInWith=lc,m.assignWith=uA,m.at=lA,m.before=Lb,m.bind=zd,m.bindAll=pM,m.bindKey=Ob,m.castArray=AF,m.chain=Ab,m.chunk=WE,m.compact=jE,m.concat=zE,m.cond=mM,m.conforms=bM,m.constant=Kd,m.countBy=YI,m.create=dA,m.curry=Bb,m.curryRight=Ub,m.debounce=$b,m.defaults=fA,m.defaultsDeep=hA,m.defer=wF,m.delay=PF,m.difference=HE,m.differenceBy=VE,m.differenceWith=GE,m.drop=QE,m.dropRight=JE,m.dropRightWhile=XE,m.dropWhile=KE,m.fill=YE,m.filter=eF,m.flatMap=rF,m.flatMapDeep=iF,m.flatMapDepth=oF,m.flatten=Db,m.flattenDeep=ZE,m.flattenDepth=eI,m.flip=SF,m.flow=vM,m.flowRight=yM,m.fromPairs=tI,m.functions=yA,m.functionsIn=xA,m.groupBy=sF,m.initial=rI,m.intersection=iI,m.intersectionBy=oI,m.intersectionWith=sI,m.invert=PA,m.invertBy=SA,m.invokeMap=cF,m.iteratee=Yd,m.keyBy=uF,m.keys=Lt,m.keysIn=ln,m.map=ic,m.mapKeys=kA,m.mapValues=RA,m.matches=xM,m.matchesProperty=wM,m.memoize=sc,m.merge=TA,m.mergeWith=Kb,m.method=PM,m.methodOf=SM,m.mixin=Zd,m.negate=ac,m.nthArg=kM,m.omit=DA,m.omitBy=EA,m.once=CF,m.orderBy=lF,m.over=RM,m.overArgs=kF,m.overEvery=TM,m.overSome=DM,m.partial=Hd,m.partialRight=Wb,m.partition=dF,m.pick=IA,m.pickBy=Yb,m.property=o_,m.propertyOf=EM,m.pull=lI,m.pullAll=Ib,m.pullAllBy=dI,m.pullAllWith=fI,m.pullAt=hI,m.range=IM,m.rangeRight=FM,m.rearg=RF,m.reject=gF,m.remove=gI,m.rest=TF,m.reverse=Wd,m.sampleSize=mF,m.set=AA,m.setWith=MA,m.shuffle=bF,m.slice=pI,m.sortBy=yF,m.sortedUniq=wI,m.sortedUniqBy=PI,m.split=rM,m.spread=DF,m.tail=SI,m.take=CI,m.takeRight=kI,m.takeRightWhile=RI,m.takeWhile=TI,m.tap=jI,m.throttle=EF,m.thru=rc,m.toArray=Gb,m.toPairs=Zb,m.toPairsIn=e_,m.toPath=LM,m.toPlainObject=Jb,m.transform=NA,m.unary=IF,m.union=DI,m.unionBy=EI,m.unionWith=II,m.uniq=FI,m.uniqBy=AI,m.uniqWith=MI,m.unset=qA,m.unzip=jd,m.unzipWith=Fb,m.update=LA,m.updateWith=OA,m.values=io,m.valuesIn=BA,m.without=NI,m.words=r_,m.wrap=FF,m.xor=qI,m.xorBy=LI,m.xorWith=OI,m.zip=BI,m.zipObject=UI,m.zipObjectDeep=$I,m.zipWith=WI,m.entries=Zb,m.entriesIn=e_,m.extend=Xb,m.extendWith=lc,Zd(m,m),m.add=BM,m.attempt=i_,m.camelCase=jA,m.capitalize=t_,m.ceil=UM,m.clamp=UA,m.clone=MF,m.cloneDeep=qF,m.cloneDeepWith=LF,m.cloneWith=NF,m.conformsTo=OF,m.deburr=n_,m.defaultTo=_M,m.divide=$M,m.endsWith=zA,m.eq=Kn,m.escape=HA,m.escapeRegExp=VA,m.every=ZI,m.find=tF,m.findIndex=Rb,m.findKey=gA,m.findLast=nF,m.findLastIndex=Tb,m.findLastKey=pA,m.floor=WM,m.forEach=Mb,m.forEachRight=Nb,m.forIn=mA,m.forInRight=bA,m.forOwn=_A,m.forOwnRight=vA,m.get=Qd,m.gt=BF,m.gte=UF,m.has=wA,m.hasIn=Jd,m.head=Eb,m.identity=dn,m.includes=aF,m.indexOf=nI,m.inRange=$A,m.invoke=CA,m.isArguments=Ei,m.isArray=we,m.isArrayBuffer=$F,m.isArrayLike=un,m.isArrayLikeObject=St,m.isBoolean=WF,m.isBuffer=ei,m.isDate=jF,m.isElement=zF,m.isEmpty=HF,m.isEqual=VF,m.isEqualWith=GF,m.isError=Vd,m.isFinite=QF,m.isFunction=Ar,m.isInteger=jb,m.isLength=cc,m.isMap=zb,m.isMatch=JF,m.isMatchWith=XF,m.isNaN=KF,m.isNative=YF,m.isNil=eA,m.isNull=ZF,m.isNumber=Hb,m.isObject=_t,m.isObjectLike=yt,m.isPlainObject=vs,m.isRegExp=Gd,m.isSafeInteger=tA,m.isSet=Vb,m.isString=uc,m.isSymbol=Sn,m.isTypedArray=ro,m.isUndefined=nA,m.isWeakMap=rA,m.isWeakSet=iA,m.join=aI,m.kebabCase=GA,m.last=Ln,m.lastIndexOf=cI,m.lowerCase=QA,m.lowerFirst=JA,m.lt=oA,m.lte=sA,m.max=jM,m.maxBy=zM,m.mean=HM,m.meanBy=VM,m.min=GM,m.minBy=QM,m.stubArray=tf,m.stubFalse=nf,m.stubObject=AM,m.stubString=MM,m.stubTrue=NM,m.multiply=JM,m.nth=uI,m.noConflict=CM,m.noop=ef,m.now=oc,m.pad=XA,m.padEnd=KA,m.padStart=YA,m.parseInt=ZA,m.random=WA,m.reduce=fF,m.reduceRight=hF,m.repeat=eM,m.replace=tM,m.result=FA,m.round=XM,m.runInContext=E,m.sample=pF,m.size=_F,m.snakeCase=nM,m.some=vF,m.sortedIndex=mI,m.sortedIndexBy=bI,m.sortedIndexOf=_I,m.sortedLastIndex=vI,m.sortedLastIndexBy=yI,m.sortedLastIndexOf=xI,m.startCase=iM,m.startsWith=oM,m.subtract=KM,m.sum=YM,m.sumBy=ZM,m.template=sM,m.times=qM,m.toFinite=Mr,m.toInteger=Se,m.toLength=Qb,m.toLower=aM,m.toNumber=On,m.toSafeInteger=aA,m.toString=Ge,m.toUpper=cM,m.trim=uM,m.trimEnd=lM,m.trimStart=dM,m.truncate=fM,m.unescape=hM,m.uniqueId=OM,m.upperCase=gM,m.upperFirst=Xd,m.each=Mb,m.eachRight=Nb,m.first=Eb,Zd(m,function(){var r={};return gr(m,function(s,a){Xe.call(m.prototype,a)||(r[a]=s)}),r}(),{chain:!1}),m.VERSION=t,Fn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){m[r].placeholder=m}),Fn(["drop","take"],function(r,s){Me.prototype[r]=function(a){a=a===e?1:Mt(Se(a),0);var l=this.__filtered__&&!s?new Me(this):this.clone();return l.__filtered__?l.__takeCount__=Vt(a,l.__takeCount__):l.__views__.push({size:Vt(a,je),type:r+(l.__dir__<0?"Right":"")}),l},Me.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Fn(["filter","map","takeWhile"],function(r,s){var a=s+1,l=a==H||a==ie;Me.prototype[r]=function(d){var _=this.clone();return _.__iteratees__.push({iteratee:le(d,3),type:a}),_.__filtered__=_.__filtered__||l,_}}),Fn(["head","last"],function(r,s){var a="take"+(s?"Right":"");Me.prototype[r]=function(){return this[a](1).value()[0]}}),Fn(["initial","tail"],function(r,s){var a="drop"+(s?"":"Right");Me.prototype[r]=function(){return this.__filtered__?new Me(this):this[a](1)}}),Me.prototype.compact=function(){return this.filter(dn)},Me.prototype.find=function(r){return this.filter(r).head()},Me.prototype.findLast=function(r){return this.reverse().find(r)},Me.prototype.invokeMap=Te(function(r,s){return typeof r=="function"?new Me(this):this.map(function(a){return hs(a,r,s)})}),Me.prototype.reject=function(r){return this.filter(ac(le(r)))},Me.prototype.slice=function(r,s){r=Se(r);var a=this;return a.__filtered__&&(r>0||s<0)?new Me(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),s!==e&&(s=Se(s),a=s<0?a.dropRight(-s):a.take(s-r)),a)},Me.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Me.prototype.toArray=function(){return this.take(je)},gr(Me.prototype,function(r,s){var a=/^(?:filter|find|map|reject)|While$/.test(s),l=/^(?:head|last)$/.test(s),d=m[l?"take"+(s=="last"?"Right":""):s],_=l||/^find/.test(s);d&&(m.prototype[s]=function(){var w=this.__wrapped__,R=l?[1]:arguments,A=w instanceof Me,G=R[0],J=A||we(w),K=function(Ae){var Le=d.apply(m,Vr([Ae],R));return l&&re?Le[0]:Le};J&&a&&typeof G=="function"&&G.length!=1&&(A=J=!1);var re=this.__chain__,ce=!!this.__actions__.length,de=_&&!re,Ce=A&&!ce;if(!_&&J){w=Ce?w:new Me(this);var fe=r.apply(w,R);return fe.__actions__.push({func:rc,args:[K],thisArg:e}),new Mn(fe,re)}return de&&Ce?r.apply(this,R):(fe=this.thru(K),de?l?fe.value()[0]:fe.value():fe)})}),Fn(["pop","push","shift","sort","splice","unshift"],function(r){var s=Da[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",l=/^(?:pop|shift)$/.test(r);m.prototype[r]=function(){var d=arguments;if(l&&!this.__chain__){var _=this.value();return s.apply(we(_)?_:[],d)}return this[a](function(w){return s.apply(we(w)?w:[],d)})}}),gr(Me.prototype,function(r,s){var a=m[s];if(a){var l=a.name+"";Xe.call(Yi,l)||(Yi[l]=[]),Yi[l].push({name:s,func:a})}}),Yi[Xa(e,B).name]=[{name:"wrapper",func:e}],Me.prototype.clone=hD,Me.prototype.reverse=gD,Me.prototype.value=pD,m.prototype.at=zI,m.prototype.chain=HI,m.prototype.commit=VI,m.prototype.next=GI,m.prototype.plant=JI,m.prototype.reverse=XI,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=KI,m.prototype.first=m.prototype.head,ss&&(m.prototype[ss]=QI),m},Qr=V0();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(qt._=Qr,define(function(){return Qr})):wi?((wi.exports=Qr)._=Qr,Yl._=Qr):qt._=Qr}).call($o)});var YR=F((lV,i2)=>{i2.exports=[{name:"C",vscode_name:"c",type:"programming",extensions:[".c",".cats",".h",".idc",".w"]},{name:"C++",vscode_name:"cpp",type:"programming",extensions:[".cpp",".c++",".cc",".cp",".cxx",".h",".h++",".hh",".hpp",".hxx",".inc",".inl",".ipp",".tcc",".tpp"]},{name:"Go",vscode_name:"go",type:"programming",extensions:[".go"]},{name:"Java",vscode_name:"java",type:"programming",extensions:[".java"]},{name:"JavaScript",vscode_name:"javascript",type:"programming",extensions:[".js","._js",".bones",".es",".es6",".frag",".gs",".jake",".jsb",".jscad",".jsfl",".jsm",".jss",".njs",".pac",".sjs",".ssjs",".sublime-build",".sublime-commands",".sublime-completions",".sublime-keymap",".sublime-macro",".sublime-menu",".sublime-mousemap",".sublime-project",".sublime-settings",".sublime-theme",".sublime-workspace",".sublime_metrics",".sublime_session",".xsjs",".xsjslib"]},{name:"Python",vscode_name:"python",type:"programming",extensions:[".py",".bzl",".cgi",".fcgi",".gyp",".lmi",".pyde",".pyp",".pyt",".pyw",".rpy",".tac",".wsgi",".xpy"]}]});var bT=F((lG,mT)=>{"use strict";function cT(e){return Array.isArray(e)?e:[e]}var fT="",uT=" ",rp="\\",y2=/^\s+$/,x2=/(?:[^\\]|^)\\$/,w2=/^\\!/,P2=/^\\#/,S2=/\r?\n/g,C2=/^\.*\/|^\.+$/,ip="/",hT="node-ignore";typeof Symbol<"u"&&(hT=Symbol.for("node-ignore"));var lT=hT,k2=(e,t,n)=>Object.defineProperty(e,t,{value:n}),R2=/([0-z])-([0-z])/g,gT=()=>!1,T2=e=>e.replace(R2,(t,n,i)=>n.charCodeAt(0)<=i.charCodeAt(0)?t:fT),D2=e=>{let{length:t}=e;return e.slice(0,t-t%2)},E2=[[/\\?\s+$/,e=>e.indexOf("\\")===0?uT:fT],[/\\\s/g,()=>uT],[/[\\$.|*+(){^]/g,e=>`\\${e}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(e,t,n)=>t+6<n.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(e,t,n)=>{let i=n.replace(/\\\*/g,"[^\\/]*");return t+i}],[/\\\\\\(?=[$.|*+(){^])/g,()=>rp],[/\\\\/g,()=>rp],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(e,t,n,i,o)=>t===rp?`\\[${n}${D2(i)}${o}`:o==="]"&&i.length%2===0?`[${T2(n)}${i}]`:"[]"],[/(?:[^*])$/,e=>/\/$/.test(e)?`${e}$`:`${e}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(e,t)=>`${t?`${t}[^/]+`:"[^/]*"}(?=$|\\/$)`]],dT=Object.create(null),I2=(e,t)=>{let n=dT[e];return n||(n=E2.reduce((i,o)=>i.replace(o[0],o[1].bind(e)),e),dT[e]=n),t?new RegExp(n,"i"):new RegExp(n)},ap=e=>typeof e=="string",F2=e=>e&&ap(e)&&!y2.test(e)&&!x2.test(e)&&e.indexOf("#")!==0,A2=e=>e.split(S2),op=class{constructor(t,n,i,o){this.origin=t,this.pattern=n,this.negative=i,this.regex=o}},M2=(e,t)=>{let n=e,i=!1;e.indexOf("!")===0&&(i=!0,e=e.substr(1)),e=e.replace(w2,"!").replace(P2,"#");let o=I2(e,t);return new op(n,e,i,o)},N2=(e,t)=>{throw new t(e)},Ur=(e,t,n)=>ap(e)?e?Ur.isNotRelative(e)?n(`path should be a \`path.relative()\`d string, but got "${t}"`,RangeError):!0:n("path must not be empty",TypeError):n(`path must be a string, but got \`${t}\``,TypeError),pT=e=>C2.test(e);Ur.isNotRelative=pT;Ur.convert=e=>e;var sp=class{constructor({ignorecase:t=!0,ignoreCase:n=t,allowRelativePaths:i=!1}={}){k2(this,lT,!0),this._rules=[],this._ignoreCase=n,this._allowRelativePaths=i,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(t){if(t&&t[lT]){this._rules=this._rules.concat(t._rules),this._added=!0;return}if(F2(t)){let n=M2(t,this._ignoreCase);this._added=!0,this._rules.push(n)}}add(t){return this._added=!1,cT(ap(t)?A2(t):t).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(t){return this.add(t)}_testOne(t,n){let i=!1,o=!1;return this._rules.forEach(c=>{let{negative:u}=c;if(o===u&&i!==o||u&&!i&&!o&&!n)return;c.regex.test(t)&&(i=!u,o=u)}),{ignored:i,unignored:o}}_test(t,n,i,o){let c=t&&Ur.convert(t);return Ur(c,t,this._allowRelativePaths?gT:N2),this._t(c,n,i,o)}_t(t,n,i,o){if(t in n)return n[t];if(o||(o=t.split(ip)),o.pop(),!o.length)return n[t]=this._testOne(t,i);let c=this._t(o.join(ip)+ip,n,i,o);if(c.ignored)return n[t]=c;let u=this._testOne(t,i);return n[t]={ignored:u.ignored,unignored:c.unignored||u.unignored}}ignores(t){return this._test(t,this._ignoreCache,!1).ignored}createFilter(){return t=>!this.ignores(t)}filter(t){return cT(t).filter(this.createFilter())}test(t){return this._test(t,this._testCache,!0)}},ml=e=>new sp(e),q2=e=>Ur(e&&Ur.convert(e),e,gT);ml.isPathValid=q2;ml.default=ml;mT.exports=ml;if(typeof process<"u"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let e=n=>/^\\\\\?\\/.test(n)||/["<>|\u0000-\u001F]+/u.test(n)?n:n.replace(/\\/g,"/");Ur.convert=e;let t=/^[a-z]:\//i;Ur.isNotRelative=n=>t.test(n)||pT(n)}});var ez={};oN(ez,{API_ENDPOINT:()=>J2});module.exports=sN(ez);var Hl=kt(require("fs")),WT=kt(require("os")),_a=kt(require("path"));var fc=class e{constructor(t,n,i,o){this._uri=t,this._languageId=n,this._version=i,this._content=o,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let n=this.offsetAt(t.start),i=this.offsetAt(t.end);return this._content.substring(n,i)}return this._content}update(t,n){for(let i of t)if(e.isIncremental(i)){let o=l_(i.range),c=this.offsetAt(o.start),u=this.offsetAt(o.end);this._content=this._content.substring(0,c)+i.text+this._content.substring(u,this._content.length);let f=Math.max(o.start.line,0),g=Math.max(o.end.line,0),b=this._lineOffsets,x=c_(i.text,!1,c);if(g-f===x.length)for(let I=0,M=x.length;I<M;I++)b[I+f+1]=x[I];else x.length<1e4?b.splice(f+1,g-f,...x):this._lineOffsets=b=b.slice(0,f+1).concat(x,b.slice(g+1));let k=i.text.length-(u-c);if(k!==0)for(let I=f+1+x.length,M=b.length;I<M;I++)b[I]=b[I]+k}else if(e.isFull(i))this._content=i.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=c_(this._content,!0)),this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let n=this.getLineOffsets(),i=0,o=n.length;if(o===0)return{line:0,character:t};for(;i<o;){let u=Math.floor((i+o)/2);n[u]>t?o=u:i=u+1}let c=i-1;return t=this.ensureBeforeEOL(t,n[c]),{line:c,character:t-n[c]}}offsetAt(t){let n=this.getLineOffsets();if(t.line>=n.length)return this._content.length;if(t.line<0)return 0;let i=n[t.line];if(t.character<=0)return i;let o=t.line+1<n.length?n[t.line+1]:this._content.length,c=Math.min(i+t.character,o);return this.ensureBeforeEOL(c,i)}ensureBeforeEOL(t,n){for(;t>n&&u_(this._content.charCodeAt(t-1));)t--;return t}get lineCount(){return this.getLineOffsets().length}static isIncremental(t){let n=t;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||typeof n.rangeLength=="number")}static isFull(t){let n=t;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}},hc;(function(e){function t(o,c,u,f){return new fc(o,c,u,f)}e.create=t;function n(o,c,u){if(o instanceof fc)return o.update(c,u),o;throw new Error("TextDocument.update: document must be created by TextDocument.create")}e.update=n;function i(o,c){let u=o.getText(),f=rf(c.map(aN),(x,k)=>{let I=x.range.start.line-k.range.start.line;return I===0?x.range.start.character-k.range.start.character:I}),g=0,b=[];for(let x of f){let k=o.offsetAt(x.range.start);if(k<g)throw new Error("Overlapping edit");k>g&&b.push(u.substring(g,k)),x.newText.length&&b.push(x.newText),g=o.offsetAt(x.range.end)}return b.push(u.substr(g)),b.join("")}e.applyEdits=i})(hc||(hc={}));function rf(e,t){if(e.length<=1)return e;let n=e.length/2|0,i=e.slice(0,n),o=e.slice(n);rf(i,t),rf(o,t);let c=0,u=0,f=0;for(;c<i.length&&u<o.length;)t(i[c],o[u])<=0?e[f++]=i[c++]:e[f++]=o[u++];for(;c<i.length;)e[f++]=i[c++];for(;u<o.length;)e[f++]=o[u++];return e}function c_(e,t,n=0){let i=t?[n]:[];for(let o=0;o<e.length;o++){let c=e.charCodeAt(o);u_(c)&&(c===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}function u_(e){return e===13||e===10}function l_(e){let t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function aN(e){let t=l_(e.range);return t!==e.range?{newText:e.newText,range:t}:e}var Ne=kt(Mw());var Nw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Pq(e){return typeof e=="string"&&Nw.test(e)}var rg=Pq;var jt=[];for(let e=0;e<256;++e)jt.push((e+256).toString(16).slice(1));function qw(e,t=0){return(jt[e[t+0]]+jt[e[t+1]]+jt[e[t+2]]+jt[e[t+3]]+"-"+jt[e[t+4]]+jt[e[t+5]]+"-"+jt[e[t+6]]+jt[e[t+7]]+"-"+jt[e[t+8]]+jt[e[t+9]]+"-"+jt[e[t+10]]+jt[e[t+11]]+jt[e[t+12]]+jt[e[t+13]]+jt[e[t+14]]+jt[e[t+15]]).toLowerCase()}var Lw=require("crypto"),Iu=new Uint8Array(256),Eu=Iu.length;function ig(){return Eu>Iu.length-16&&((0,Lw.randomFillSync)(Iu),Eu=0),Iu.slice(Eu,Eu+=16)}var Ow=require("crypto"),og={randomUUID:Ow.randomUUID};function Sq(e,t,n){if(og.randomUUID&&!t&&!e)return og.randomUUID();e=e||{};let i=e.random||(e.rng||ig)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=i[o];return t}return qw(i)}var Ns=Sq;var To=class extends Error{constructor(n){super(`Configured model "${n}" is not available`);this.modelName=n}};var Do=class extends Error{constructor(){super("No models available")}},Eo=class extends Error{constructor(t="Skipping inline completion."){super(t)}},Nt=class e extends Error{constructor(n,i){super(i);this.status=n}static transientIssue(n){return new e(3,n)}static fromResponse(n){return new e(Cq(n.status),`HTTP error: ${n.status} ${n.statusText}`)}static isAPIErrorWithStatus(n,i){return n instanceof e?n.status===i:!1}static isRetriableAPIError(n){return n instanceof e?kq.has(n.status):!1}};function Cq(e){switch(e){case 200:return 0;case 400:return 5;case 401:return 7;case 403:return 8;case 404:return 4;case 413:return 10;case 429:return 6;case 499:return 1;case 504:return 9}return e>=500&&e<600?3:2}var kq=new Set([3,1]);function Rq(e){return e.cause instanceof String?String(e.cause):e.cause instanceof Object?JSON.stringify(e.cause):""}function Ee(e,t=!1){if(e instanceof Error){if(t){let n=Rq(e);if(n!=="")return`${e.message} (due to ${n})`}return e.message}return String(e)}var KR=kt(Lk());var Hu=kt(require("fs")),Qs=kt(Bk()),$k=kt(require("os")),Js=kt(require("path")),Yj=process.env.TEST_TMPDIR?Js.default.join(process.env.TEST_TMPDIR,"state"):process.env.XDG_STATE_HOME||Js.default.join($k.default.homedir(),".local","state"),Uk=Js.default.join(Yj,"augment","augment-server.log"),Gs;function Zj(){if(Gs)return Gs;let e=Js.default.dirname(Uk);Hu.default.existsSync(e)||Hu.default.mkdirSync(e,{recursive:!0});let t=(process.env.AUGMENT_LOG_LEVEL||"info").toLowerCase(),n;return["trace","debug","info","warn","error"].includes(t)?Qs.default.setLevel(t):(n=`Environment variable AUGMENT_LOG_LEVEL set to invalid log level "${t}". Defaulting to "info"`,Qs.default.setLevel("info")),Qs.default.methodFactory=function(i){return function(o){let c=new Date().toISOString();Hu.default.appendFileSync(Uk,`${c} [${i.toUpperCase()}] ${o}
`)}},Gs=Qs.default.getLogger("server"),n&&Gs.warn(n),Gs}function Ie(e){let t=Zj();return{...t,verbose:(n,...i)=>t.debug(n,...i)}}var Ks=kt(Vu()),Wo=class{constructor(t,n){this.name=t;this._logger=n}_isSet=!1;_value;get value(){return this._value}update(t){return this._isSet&&(0,Ks.isEqual)(t,this._value)?!1:(this._isSet?this._logger.info(`${this.name} changed:
${this.diff(this.value,t).map(n=>`  - ${n}`).join(`
`)}`):this._logger.info(`${this.name} changed from <unset> to ${this._formatValue(t)}`),this._value=(0,Ks.cloneDeep)(t),this._isSet=!0,!0)}diff(t,n,i=[]){if((0,Ks.isEqual)(n,t))return[];if(!this.isObject(n)||!this.isObject(t))return[`${this._formatValue(t)} to ${this._formatValue(n)}`];let o=new Set([...Object.keys(t||{}),...Object.keys(n||{})]),c=[];for(let u of o){let f=n?n[u]:void 0,g=t?t[u]:void 0;!this.isObject(f)||!this.isObject(g)?f!==g&&c.push(`${i.concat(u).join(" > ")}: ${this._formatValue(g)} to ${this._formatValue(f)}`):c.push(...this.diff(g,f,i.concat(u)))}return c}isObject(t){return typeof t=="object"&&t!==null}toString(){return this._isSet?this._formatValue(this.value):"<unset>"}_formatValue(t){return t===void 0?"undefined":JSON.stringify(t)}};var XR=require("events"),Dn=kt(require("fs"));var Wk;(function(e){function t(n){return typeof n=="string"}e.is=t})(Wk||(Wk={}));var Dg;(function(e){function t(n){return typeof n=="string"}e.is=t})(Dg||(Dg={}));var jk;(function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647;function t(n){return typeof n=="number"&&e.MIN_VALUE<=n&&n<=e.MAX_VALUE}e.is=t})(jk||(jk={}));var Gu;(function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647;function t(n){return typeof n=="number"&&e.MIN_VALUE<=n&&n<=e.MAX_VALUE}e.is=t})(Gu||(Gu={}));var rr;(function(e){function t(i,o){return i===Number.MAX_VALUE&&(i=Gu.MAX_VALUE),o===Number.MAX_VALUE&&(o=Gu.MAX_VALUE),{line:i,character:o}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&O.uinteger(o.line)&&O.uinteger(o.character)}e.is=n})(rr||(rr={}));var dt;(function(e){function t(i,o,c,u){if(O.uinteger(i)&&O.uinteger(o)&&O.uinteger(c)&&O.uinteger(u))return{start:rr.create(i,o),end:rr.create(c,u)};if(rr.is(i)&&rr.is(o))return{start:i,end:o};throw new Error(`Range#create called with invalid arguments[${i}, ${o}, ${c}, ${u}]`)}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&rr.is(o.start)&&rr.is(o.end)}e.is=n})(dt||(dt={}));var Qu;(function(e){function t(i,o){return{uri:i,range:o}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&dt.is(o.range)&&(O.string(o.uri)||O.undefined(o.uri))}e.is=n})(Qu||(Qu={}));var zk;(function(e){function t(i,o,c,u){return{targetUri:i,targetRange:o,targetSelectionRange:c,originSelectionRange:u}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&dt.is(o.targetRange)&&O.string(o.targetUri)&&dt.is(o.targetSelectionRange)&&(dt.is(o.originSelectionRange)||O.undefined(o.originSelectionRange))}e.is=n})(zk||(zk={}));var Eg;(function(e){function t(i,o,c,u){return{red:i,green:o,blue:c,alpha:u}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&O.numberRange(o.red,0,1)&&O.numberRange(o.green,0,1)&&O.numberRange(o.blue,0,1)&&O.numberRange(o.alpha,0,1)}e.is=n})(Eg||(Eg={}));var Hk;(function(e){function t(i,o){return{range:i,color:o}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&dt.is(o.range)&&Eg.is(o.color)}e.is=n})(Hk||(Hk={}));var Vk;(function(e){function t(i,o,c){return{label:i,textEdit:o,additionalTextEdits:c}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&O.string(o.label)&&(O.undefined(o.textEdit)||zo.is(o))&&(O.undefined(o.additionalTextEdits)||O.typedArray(o.additionalTextEdits,zo.is))}e.is=n})(Vk||(Vk={}));var Gk;(function(e){e.Comment="comment",e.Imports="imports",e.Region="region"})(Gk||(Gk={}));var Qk;(function(e){function t(i,o,c,u,f,g){let b={startLine:i,endLine:o};return O.defined(c)&&(b.startCharacter=c),O.defined(u)&&(b.endCharacter=u),O.defined(f)&&(b.kind=f),O.defined(g)&&(b.collapsedText=g),b}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&O.uinteger(o.startLine)&&O.uinteger(o.startLine)&&(O.undefined(o.startCharacter)||O.uinteger(o.startCharacter))&&(O.undefined(o.endCharacter)||O.uinteger(o.endCharacter))&&(O.undefined(o.kind)||O.string(o.kind))}e.is=n})(Qk||(Qk={}));var Ig;(function(e){function t(i,o){return{location:i,message:o}}e.create=t;function n(i){let o=i;return O.defined(o)&&Qu.is(o.location)&&O.string(o.message)}e.is=n})(Ig||(Ig={}));var Jk;(function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4})(Jk||(Jk={}));var Xk;(function(e){e.Unnecessary=1,e.Deprecated=2})(Xk||(Xk={}));var Kk;(function(e){function t(n){let i=n;return O.objectLiteral(i)&&O.string(i.href)}e.is=t})(Kk||(Kk={}));var Ju;(function(e){function t(i,o,c,u,f,g){let b={range:i,message:o};return O.defined(c)&&(b.severity=c),O.defined(u)&&(b.code=u),O.defined(f)&&(b.source=f),O.defined(g)&&(b.relatedInformation=g),b}e.create=t;function n(i){var o;let c=i;return O.defined(c)&&dt.is(c.range)&&O.string(c.message)&&(O.number(c.severity)||O.undefined(c.severity))&&(O.integer(c.code)||O.string(c.code)||O.undefined(c.code))&&(O.undefined(c.codeDescription)||O.string((o=c.codeDescription)===null||o===void 0?void 0:o.href))&&(O.string(c.source)||O.undefined(c.source))&&(O.undefined(c.relatedInformation)||O.typedArray(c.relatedInformation,Ig.is))}e.is=n})(Ju||(Ju={}));var jo;(function(e){function t(i,o,...c){let u={title:i,command:o};return O.defined(c)&&c.length>0&&(u.arguments=c),u}e.create=t;function n(i){let o=i;return O.defined(o)&&O.string(o.title)&&O.string(o.command)}e.is=n})(jo||(jo={}));var zo;(function(e){function t(c,u){return{range:c,newText:u}}e.replace=t;function n(c,u){return{range:{start:c,end:c},newText:u}}e.insert=n;function i(c){return{range:c,newText:""}}e.del=i;function o(c){let u=c;return O.objectLiteral(u)&&O.string(u.newText)&&dt.is(u.range)}e.is=o})(zo||(zo={}));var Fg;(function(e){function t(i,o,c){let u={label:i};return o!==void 0&&(u.needsConfirmation=o),c!==void 0&&(u.description=c),u}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&O.string(o.label)&&(O.boolean(o.needsConfirmation)||o.needsConfirmation===void 0)&&(O.string(o.description)||o.description===void 0)}e.is=n})(Fg||(Fg={}));var Ho;(function(e){function t(n){let i=n;return O.string(i)}e.is=t})(Ho||(Ho={}));var Yk;(function(e){function t(c,u,f){return{range:c,newText:u,annotationId:f}}e.replace=t;function n(c,u,f){return{range:{start:c,end:c},newText:u,annotationId:f}}e.insert=n;function i(c,u){return{range:c,newText:"",annotationId:u}}e.del=i;function o(c){let u=c;return zo.is(u)&&(Fg.is(u.annotationId)||Ho.is(u.annotationId))}e.is=o})(Yk||(Yk={}));var Ag;(function(e){function t(i,o){return{textDocument:i,edits:o}}e.create=t;function n(i){let o=i;return O.defined(o)&&Og.is(o.textDocument)&&Array.isArray(o.edits)}e.is=n})(Ag||(Ag={}));var Mg;(function(e){function t(i,o,c){let u={kind:"create",uri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(u.options=o),c!==void 0&&(u.annotationId=c),u}e.create=t;function n(i){let o=i;return o&&o.kind==="create"&&O.string(o.uri)&&(o.options===void 0||(o.options.overwrite===void 0||O.boolean(o.options.overwrite))&&(o.options.ignoreIfExists===void 0||O.boolean(o.options.ignoreIfExists)))&&(o.annotationId===void 0||Ho.is(o.annotationId))}e.is=n})(Mg||(Mg={}));var Ng;(function(e){function t(i,o,c,u){let f={kind:"rename",oldUri:i,newUri:o};return c!==void 0&&(c.overwrite!==void 0||c.ignoreIfExists!==void 0)&&(f.options=c),u!==void 0&&(f.annotationId=u),f}e.create=t;function n(i){let o=i;return o&&o.kind==="rename"&&O.string(o.oldUri)&&O.string(o.newUri)&&(o.options===void 0||(o.options.overwrite===void 0||O.boolean(o.options.overwrite))&&(o.options.ignoreIfExists===void 0||O.boolean(o.options.ignoreIfExists)))&&(o.annotationId===void 0||Ho.is(o.annotationId))}e.is=n})(Ng||(Ng={}));var qg;(function(e){function t(i,o,c){let u={kind:"delete",uri:i};return o!==void 0&&(o.recursive!==void 0||o.ignoreIfNotExists!==void 0)&&(u.options=o),c!==void 0&&(u.annotationId=c),u}e.create=t;function n(i){let o=i;return o&&o.kind==="delete"&&O.string(o.uri)&&(o.options===void 0||(o.options.recursive===void 0||O.boolean(o.options.recursive))&&(o.options.ignoreIfNotExists===void 0||O.boolean(o.options.ignoreIfNotExists)))&&(o.annotationId===void 0||Ho.is(o.annotationId))}e.is=n})(qg||(qg={}));var Lg;(function(e){function t(n){let i=n;return i&&(i.changes!==void 0||i.documentChanges!==void 0)&&(i.documentChanges===void 0||i.documentChanges.every(o=>O.string(o.kind)?Mg.is(o)||Ng.is(o)||qg.is(o):Ag.is(o)))}e.is=t})(Lg||(Lg={}));var Zk;(function(e){function t(i){return{uri:i}}e.create=t;function n(i){let o=i;return O.defined(o)&&O.string(o.uri)}e.is=n})(Zk||(Zk={}));var eR;(function(e){function t(i,o){return{uri:i,version:o}}e.create=t;function n(i){let o=i;return O.defined(o)&&O.string(o.uri)&&O.integer(o.version)}e.is=n})(eR||(eR={}));var Og;(function(e){function t(i,o){return{uri:i,version:o}}e.create=t;function n(i){let o=i;return O.defined(o)&&O.string(o.uri)&&(o.version===null||O.integer(o.version))}e.is=n})(Og||(Og={}));var tR;(function(e){function t(i,o,c,u){return{uri:i,languageId:o,version:c,text:u}}e.create=t;function n(i){let o=i;return O.defined(o)&&O.string(o.uri)&&O.string(o.languageId)&&O.integer(o.version)&&O.string(o.text)}e.is=n})(tR||(tR={}));var Bg;(function(e){e.PlainText="plaintext",e.Markdown="markdown";function t(n){let i=n;return i===e.PlainText||i===e.Markdown}e.is=t})(Bg||(Bg={}));var Ys;(function(e){function t(n){let i=n;return O.objectLiteral(n)&&Bg.is(i.kind)&&O.string(i.value)}e.is=t})(Ys||(Ys={}));var nR;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(nR||(nR={}));var rR;(function(e){e.PlainText=1,e.Snippet=2})(rR||(rR={}));var iR;(function(e){e.Deprecated=1})(iR||(iR={}));var oR;(function(e){function t(i,o,c){return{newText:i,insert:o,replace:c}}e.create=t;function n(i){let o=i;return o&&O.string(o.newText)&&dt.is(o.insert)&&dt.is(o.replace)}e.is=n})(oR||(oR={}));var sR;(function(e){e.asIs=1,e.adjustIndentation=2})(sR||(sR={}));var aR;(function(e){function t(n){let i=n;return i&&(O.string(i.detail)||i.detail===void 0)&&(O.string(i.description)||i.description===void 0)}e.is=t})(aR||(aR={}));var cR;(function(e){function t(n){return{label:n}}e.create=t})(cR||(cR={}));var uR;(function(e){function t(n,i){return{items:n||[],isIncomplete:!!i}}e.create=t})(uR||(uR={}));var Xu;(function(e){function t(i){return i.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}e.fromPlainText=t;function n(i){let o=i;return O.string(o)||O.objectLiteral(o)&&O.string(o.language)&&O.string(o.value)}e.is=n})(Xu||(Xu={}));var lR;(function(e){function t(n){let i=n;return!!i&&O.objectLiteral(i)&&(Ys.is(i.contents)||Xu.is(i.contents)||O.typedArray(i.contents,Xu.is))&&(n.range===void 0||dt.is(n.range))}e.is=t})(lR||(lR={}));var dR;(function(e){function t(n,i){return i?{label:n,documentation:i}:{label:n}}e.create=t})(dR||(dR={}));var fR;(function(e){function t(n,i,...o){let c={label:n};return O.defined(i)&&(c.documentation=i),O.defined(o)?c.parameters=o:c.parameters=[],c}e.create=t})(fR||(fR={}));var hR;(function(e){e.Text=1,e.Read=2,e.Write=3})(hR||(hR={}));var gR;(function(e){function t(n,i){let o={range:n};return O.number(i)&&(o.kind=i),o}e.create=t})(gR||(gR={}));var pR;(function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26})(pR||(pR={}));var mR;(function(e){e.Deprecated=1})(mR||(mR={}));var bR;(function(e){function t(n,i,o,c,u){let f={name:n,kind:i,location:{uri:c,range:o}};return u&&(f.containerName=u),f}e.create=t})(bR||(bR={}));var _R;(function(e){function t(n,i,o,c){return c!==void 0?{name:n,kind:i,location:{uri:o,range:c}}:{name:n,kind:i,location:{uri:o}}}e.create=t})(_R||(_R={}));var vR;(function(e){function t(i,o,c,u,f,g){let b={name:i,detail:o,kind:c,range:u,selectionRange:f};return g!==void 0&&(b.children=g),b}e.create=t;function n(i){let o=i;return o&&O.string(o.name)&&O.number(o.kind)&&dt.is(o.range)&&dt.is(o.selectionRange)&&(o.detail===void 0||O.string(o.detail))&&(o.deprecated===void 0||O.boolean(o.deprecated))&&(o.children===void 0||Array.isArray(o.children))&&(o.tags===void 0||Array.isArray(o.tags))}e.is=n})(vR||(vR={}));var yR;(function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"})(yR||(yR={}));var Ku;(function(e){e.Invoked=1,e.Automatic=2})(Ku||(Ku={}));var xR;(function(e){function t(i,o,c){let u={diagnostics:i};return o!=null&&(u.only=o),c!=null&&(u.triggerKind=c),u}e.create=t;function n(i){let o=i;return O.defined(o)&&O.typedArray(o.diagnostics,Ju.is)&&(o.only===void 0||O.typedArray(o.only,O.string))&&(o.triggerKind===void 0||o.triggerKind===Ku.Invoked||o.triggerKind===Ku.Automatic)}e.is=n})(xR||(xR={}));var wR;(function(e){function t(i,o,c){let u={title:i},f=!0;return typeof o=="string"?(f=!1,u.kind=o):jo.is(o)?u.command=o:u.edit=o,f&&c!==void 0&&(u.kind=c),u}e.create=t;function n(i){let o=i;return o&&O.string(o.title)&&(o.diagnostics===void 0||O.typedArray(o.diagnostics,Ju.is))&&(o.kind===void 0||O.string(o.kind))&&(o.edit!==void 0||o.command!==void 0)&&(o.command===void 0||jo.is(o.command))&&(o.isPreferred===void 0||O.boolean(o.isPreferred))&&(o.edit===void 0||Lg.is(o.edit))}e.is=n})(wR||(wR={}));var PR;(function(e){function t(i,o){let c={range:i};return O.defined(o)&&(c.data=o),c}e.create=t;function n(i){let o=i;return O.defined(o)&&dt.is(o.range)&&(O.undefined(o.command)||jo.is(o.command))}e.is=n})(PR||(PR={}));var SR;(function(e){function t(i,o){return{tabSize:i,insertSpaces:o}}e.create=t;function n(i){let o=i;return O.defined(o)&&O.uinteger(o.tabSize)&&O.boolean(o.insertSpaces)}e.is=n})(SR||(SR={}));var CR;(function(e){function t(i,o,c){return{range:i,target:o,data:c}}e.create=t;function n(i){let o=i;return O.defined(o)&&dt.is(o.range)&&(O.undefined(o.target)||O.string(o.target))}e.is=n})(CR||(CR={}));var kR;(function(e){function t(i,o){return{range:i,parent:o}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&dt.is(o.range)&&(o.parent===void 0||e.is(o.parent))}e.is=n})(kR||(kR={}));var RR;(function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"})(RR||(RR={}));var TR;(function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"})(TR||(TR={}));var DR;(function(e){function t(n){let i=n;return O.objectLiteral(i)&&(i.resultId===void 0||typeof i.resultId=="string")&&Array.isArray(i.data)&&(i.data.length===0||typeof i.data[0]=="number")}e.is=t})(DR||(DR={}));var ER;(function(e){function t(i,o){return{range:i,text:o}}e.create=t;function n(i){let o=i;return o!=null&&dt.is(o.range)&&O.string(o.text)}e.is=n})(ER||(ER={}));var IR;(function(e){function t(i,o,c){return{range:i,variableName:o,caseSensitiveLookup:c}}e.create=t;function n(i){let o=i;return o!=null&&dt.is(o.range)&&O.boolean(o.caseSensitiveLookup)&&(O.string(o.variableName)||o.variableName===void 0)}e.is=n})(IR||(IR={}));var FR;(function(e){function t(i,o){return{range:i,expression:o}}e.create=t;function n(i){let o=i;return o!=null&&dt.is(o.range)&&(O.string(o.expression)||o.expression===void 0)}e.is=n})(FR||(FR={}));var AR;(function(e){function t(i,o){return{frameId:i,stoppedLocation:o}}e.create=t;function n(i){let o=i;return O.defined(o)&&dt.is(i.stoppedLocation)}e.is=n})(AR||(AR={}));var Ug;(function(e){e.Type=1,e.Parameter=2;function t(n){return n===1||n===2}e.is=t})(Ug||(Ug={}));var $g;(function(e){function t(i){return{value:i}}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&(o.tooltip===void 0||O.string(o.tooltip)||Ys.is(o.tooltip))&&(o.location===void 0||Qu.is(o.location))&&(o.command===void 0||jo.is(o.command))}e.is=n})($g||($g={}));var MR;(function(e){function t(i,o,c){let u={position:i,label:o};return c!==void 0&&(u.kind=c),u}e.create=t;function n(i){let o=i;return O.objectLiteral(o)&&rr.is(o.position)&&(O.string(o.label)||O.typedArray(o.label,$g.is))&&(o.kind===void 0||Ug.is(o.kind))&&o.textEdits===void 0||O.typedArray(o.textEdits,zo.is)&&(o.tooltip===void 0||O.string(o.tooltip)||Ys.is(o.tooltip))&&(o.paddingLeft===void 0||O.boolean(o.paddingLeft))&&(o.paddingRight===void 0||O.boolean(o.paddingRight))}e.is=n})(MR||(MR={}));var NR;(function(e){function t(n){return{kind:"snippet",value:n}}e.createSnippet=t})(NR||(NR={}));var qR;(function(e){function t(n,i,o,c){return{insertText:n,filterText:i,range:o,command:c}}e.create=t})(qR||(qR={}));var LR;(function(e){function t(n){return{items:n}}e.create=t})(LR||(LR={}));var OR;(function(e){e.Invoked=0,e.Automatic=1})(OR||(OR={}));var BR;(function(e){function t(n,i){return{range:n,text:i}}e.create=t})(BR||(BR={}));var UR;(function(e){function t(n,i){return{triggerKind:n,selectedCompletionInfo:i}}e.create=t})(UR||(UR={}));var $R;(function(e){function t(n){let i=n;return O.objectLiteral(i)&&Dg.is(i.uri)&&O.string(i.name)}e.is=t})($R||($R={}));var WR;(function(e){function t(c,u,f,g){return new Wg(c,u,f,g)}e.create=t;function n(c){let u=c;return!!(O.defined(u)&&O.string(u.uri)&&(O.undefined(u.languageId)||O.string(u.languageId))&&O.uinteger(u.lineCount)&&O.func(u.getText)&&O.func(u.positionAt)&&O.func(u.offsetAt))}e.is=n;function i(c,u){let f=c.getText(),g=o(u,(x,k)=>{let I=x.range.start.line-k.range.start.line;return I===0?x.range.start.character-k.range.start.character:I}),b=f.length;for(let x=g.length-1;x>=0;x--){let k=g[x],I=c.offsetAt(k.range.start),M=c.offsetAt(k.range.end);if(M<=b)f=f.substring(0,I)+k.newText+f.substring(M,f.length);else throw new Error("Overlapping edit");b=I}return f}e.applyEdits=i;function o(c,u){if(c.length<=1)return c;let f=c.length/2|0,g=c.slice(0,f),b=c.slice(f);o(g,u),o(b,u);let x=0,k=0,I=0;for(;x<g.length&&k<b.length;)u(g[x],b[k])<=0?c[I++]=g[x++]:c[I++]=b[k++];for(;x<g.length;)c[I++]=g[x++];for(;k<b.length;)c[I++]=b[k++];return c}})(WR||(WR={}));var Wg=class{constructor(t,n,i,o){this._uri=t,this._languageId=n,this._version=i,this._content=o,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let n=this.offsetAt(t.start),i=this.offsetAt(t.end);return this._content.substring(n,i)}return this._content}update(t,n){this._content=t.text,this._version=n,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let t=[],n=this._content,i=!0;for(let o=0;o<n.length;o++){i&&(t.push(o),i=!1);let c=n.charAt(o);i=c==="\r"||c===`
`,c==="\r"&&o+1<n.length&&n.charAt(o+1)===`
`&&o++}i&&n.length>0&&t.push(n.length),this._lineOffsets=t}return this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let n=this.getLineOffsets(),i=0,o=n.length;if(o===0)return rr.create(0,t);for(;i<o;){let u=Math.floor((i+o)/2);n[u]>t?o=u:i=u+1}let c=i-1;return rr.create(c,t-n[c])}offsetAt(t){let n=this.getLineOffsets();if(t.line>=n.length)return this._content.length;if(t.line<0)return 0;let i=n[t.line],o=t.line+1<n.length?n[t.line+1]:this._content.length;return Math.max(Math.min(i+t.character,o),i)}get lineCount(){return this.getLineOffsets().length}},O;(function(e){let t=Object.prototype.toString;function n(M){return typeof M<"u"}e.defined=n;function i(M){return typeof M>"u"}e.undefined=i;function o(M){return M===!0||M===!1}e.boolean=o;function c(M){return t.call(M)==="[object String]"}e.string=c;function u(M){return t.call(M)==="[object Number]"}e.number=u;function f(M,N,B){return t.call(M)==="[object Number]"&&N<=M&&M<=B}e.numberRange=f;function g(M){return t.call(M)==="[object Number]"&&-2147483648<=M&&M<=2147483647}e.integer=g;function b(M){return t.call(M)==="[object Number]"&&0<=M&&M<=2147483647}e.uinteger=b;function x(M){return t.call(M)==="[object Function]"}e.func=x;function k(M){return M!==null&&typeof M=="object"}e.objectLiteral=k;function I(M,N){return Array.isArray(M)&&M.every(N)}e.typedArray=I})(O||(O={}));var jR;(()=>{"use strict";var e={470:o=>{function c(g){if(typeof g!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(g))}function u(g,b){for(var x,k="",I=0,M=-1,N=0,B=0;B<=g.length;++B){if(B<g.length)x=g.charCodeAt(B);else{if(x===47)break;x=47}if(x===47){if(!(M===B-1||N===1))if(M!==B-1&&N===2){if(k.length<2||I!==2||k.charCodeAt(k.length-1)!==46||k.charCodeAt(k.length-2)!==46){if(k.length>2){var W=k.lastIndexOf("/");if(W!==k.length-1){W===-1?(k="",I=0):I=(k=k.slice(0,W)).length-1-k.lastIndexOf("/"),M=B,N=0;continue}}else if(k.length===2||k.length===1){k="",I=0,M=B,N=0;continue}}b&&(k.length>0?k+="/..":k="..",I=2)}else k.length>0?k+="/"+g.slice(M+1,B):k=g.slice(M+1,B),I=B-M-1;M=B,N=0}else x===46&&N!==-1?++N:N=-1}return k}var f={resolve:function(){for(var g,b="",x=!1,k=arguments.length-1;k>=-1&&!x;k--){var I;k>=0?I=arguments[k]:(g===void 0&&(g=process.cwd()),I=g),c(I),I.length!==0&&(b=I+"/"+b,x=I.charCodeAt(0)===47)}return b=u(b,!x),x?b.length>0?"/"+b:"/":b.length>0?b:"."},normalize:function(g){if(c(g),g.length===0)return".";var b=g.charCodeAt(0)===47,x=g.charCodeAt(g.length-1)===47;return(g=u(g,!b)).length!==0||b||(g="."),g.length>0&&x&&(g+="/"),b?"/"+g:g},isAbsolute:function(g){return c(g),g.length>0&&g.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var g,b=0;b<arguments.length;++b){var x=arguments[b];c(x),x.length>0&&(g===void 0?g=x:g+="/"+x)}return g===void 0?".":f.normalize(g)},relative:function(g,b){if(c(g),c(b),g===b||(g=f.resolve(g))===(b=f.resolve(b)))return"";for(var x=1;x<g.length&&g.charCodeAt(x)===47;++x);for(var k=g.length,I=k-x,M=1;M<b.length&&b.charCodeAt(M)===47;++M);for(var N=b.length-M,B=I<N?I:N,W=-1,X=0;X<=B;++X){if(X===B){if(N>B){if(b.charCodeAt(M+X)===47)return b.slice(M+X+1);if(X===0)return b.slice(M+X)}else I>B&&(g.charCodeAt(x+X)===47?W=X:X===0&&(W=0));break}var D=g.charCodeAt(x+X);if(D!==b.charCodeAt(M+X))break;D===47&&(W=X)}var P="";for(X=x+W+1;X<=k;++X)X!==k&&g.charCodeAt(X)!==47||(P.length===0?P+="..":P+="/..");return P.length>0?P+b.slice(M+W):(M+=W,b.charCodeAt(M)===47&&++M,b.slice(M))},_makeLong:function(g){return g},dirname:function(g){if(c(g),g.length===0)return".";for(var b=g.charCodeAt(0),x=b===47,k=-1,I=!0,M=g.length-1;M>=1;--M)if((b=g.charCodeAt(M))===47){if(!I){k=M;break}}else I=!1;return k===-1?x?"/":".":x&&k===1?"//":g.slice(0,k)},basename:function(g,b){if(b!==void 0&&typeof b!="string")throw new TypeError('"ext" argument must be a string');c(g);var x,k=0,I=-1,M=!0;if(b!==void 0&&b.length>0&&b.length<=g.length){if(b.length===g.length&&b===g)return"";var N=b.length-1,B=-1;for(x=g.length-1;x>=0;--x){var W=g.charCodeAt(x);if(W===47){if(!M){k=x+1;break}}else B===-1&&(M=!1,B=x+1),N>=0&&(W===b.charCodeAt(N)?--N==-1&&(I=x):(N=-1,I=B))}return k===I?I=B:I===-1&&(I=g.length),g.slice(k,I)}for(x=g.length-1;x>=0;--x)if(g.charCodeAt(x)===47){if(!M){k=x+1;break}}else I===-1&&(M=!1,I=x+1);return I===-1?"":g.slice(k,I)},extname:function(g){c(g);for(var b=-1,x=0,k=-1,I=!0,M=0,N=g.length-1;N>=0;--N){var B=g.charCodeAt(N);if(B!==47)k===-1&&(I=!1,k=N+1),B===46?b===-1?b=N:M!==1&&(M=1):b!==-1&&(M=-1);else if(!I){x=N+1;break}}return b===-1||k===-1||M===0||M===1&&b===k-1&&b===x+1?"":g.slice(b,k)},format:function(g){if(g===null||typeof g!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof g);return function(b,x){var k=x.dir||x.root,I=x.base||(x.name||"")+(x.ext||"");return k?k===x.root?k+I:k+"/"+I:I}(0,g)},parse:function(g){c(g);var b={root:"",dir:"",base:"",ext:"",name:""};if(g.length===0)return b;var x,k=g.charCodeAt(0),I=k===47;I?(b.root="/",x=1):x=0;for(var M=-1,N=0,B=-1,W=!0,X=g.length-1,D=0;X>=x;--X)if((k=g.charCodeAt(X))!==47)B===-1&&(W=!1,B=X+1),k===46?M===-1?M=X:D!==1&&(D=1):M!==-1&&(D=-1);else if(!W){N=X+1;break}return M===-1||B===-1||D===0||D===1&&M===B-1&&M===N+1?B!==-1&&(b.base=b.name=N===0&&I?g.slice(1,B):g.slice(N,B)):(N===0&&I?(b.name=g.slice(1,M),b.base=g.slice(1,B)):(b.name=g.slice(N,M),b.base=g.slice(N,B)),b.ext=g.slice(M,B)),N>0?b.dir=g.slice(0,N-1):I&&(b.dir="/"),b},sep:"/",delimiter:":",win32:null,posix:null};f.posix=f,o.exports=f}},t={};function n(o){var c=t[o];if(c!==void 0)return c.exports;var u=t[o]={exports:{}};return e[o](u,u.exports,n),u.exports}n.d=(o,c)=>{for(var u in c)n.o(c,u)&&!n.o(o,u)&&Object.defineProperty(o,u,{enumerable:!0,get:c[u]})},n.o=(o,c)=>Object.prototype.hasOwnProperty.call(o,c),n.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var i={};(()=>{let o;n.r(i),n.d(i,{URI:()=>I,Utils:()=>xe}),typeof process=="object"?o=process.platform==="win32":typeof navigator=="object"&&(o=navigator.userAgent.indexOf("Windows")>=0);let c=/^\w[\w\d+.-]*$/,u=/^\//,f=/^\/\//;function g(Y,H){if(!Y.scheme&&H)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${Y.authority}", path: "${Y.path}", query: "${Y.query}", fragment: "${Y.fragment}"}`);if(Y.scheme&&!c.test(Y.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(Y.path){if(Y.authority){if(!u.test(Y.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(f.test(Y.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}let b="",x="/",k=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class I{static isUri(H){return H instanceof I||!!H&&typeof H.authority=="string"&&typeof H.fragment=="string"&&typeof H.path=="string"&&typeof H.query=="string"&&typeof H.scheme=="string"&&typeof H.fsPath=="string"&&typeof H.with=="function"&&typeof H.toString=="function"}scheme;authority;path;query;fragment;constructor(H,ae,ie,ke,ge,pe=!1){typeof H=="object"?(this.scheme=H.scheme||b,this.authority=H.authority||b,this.path=H.path||b,this.query=H.query||b,this.fragment=H.fragment||b):(this.scheme=function(wt,je){return wt||je?wt:"file"}(H,pe),this.authority=ae||b,this.path=function(wt,je){switch(wt){case"https":case"http":case"file":je?je[0]!==x&&(je=x+je):je=x}return je}(this.scheme,ie||b),this.query=ke||b,this.fragment=ge||b,g(this,pe))}get fsPath(){return D(this,!1)}with(H){if(!H)return this;let{scheme:ae,authority:ie,path:ke,query:ge,fragment:pe}=H;return ae===void 0?ae=this.scheme:ae===null&&(ae=b),ie===void 0?ie=this.authority:ie===null&&(ie=b),ke===void 0?ke=this.path:ke===null&&(ke=b),ge===void 0?ge=this.query:ge===null&&(ge=b),pe===void 0?pe=this.fragment:pe===null&&(pe=b),ae===this.scheme&&ie===this.authority&&ke===this.path&&ge===this.query&&pe===this.fragment?this:new N(ae,ie,ke,ge,pe)}static parse(H,ae=!1){let ie=k.exec(H);return ie?new N(ie[2]||b,_e(ie[4]||b),_e(ie[5]||b),_e(ie[7]||b),_e(ie[9]||b),ae):new N(b,b,b,b,b)}static file(H){let ae=b;if(o&&(H=H.replace(/\\/g,x)),H[0]===x&&H[1]===x){let ie=H.indexOf(x,2);ie===-1?(ae=H.substring(2),H=x):(ae=H.substring(2,ie),H=H.substring(ie)||x)}return new N("file",ae,H,b,b)}static from(H){let ae=new N(H.scheme,H.authority,H.path,H.query,H.fragment);return g(ae,!0),ae}toString(H=!1){return P(this,H)}toJSON(){return this}static revive(H){if(H){if(H instanceof I)return H;{let ae=new N(H);return ae._formatted=H.external,ae._fsPath=H._sep===M?H.fsPath:null,ae}}return H}}let M=o?1:void 0;class N extends I{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=D(this,!1)),this._fsPath}toString(H=!1){return H?P(this,!0):(this._formatted||(this._formatted=P(this,!1)),this._formatted)}toJSON(){let H={$mid:1};return this._fsPath&&(H.fsPath=this._fsPath,H._sep=M),this._formatted&&(H.external=this._formatted),this.path&&(H.path=this.path),this.scheme&&(H.scheme=this.scheme),this.authority&&(H.authority=this.authority),this.query&&(H.query=this.query),this.fragment&&(H.fragment=this.fragment),H}}let B={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function W(Y,H,ae){let ie,ke=-1;for(let ge=0;ge<Y.length;ge++){let pe=Y.charCodeAt(ge);if(pe>=97&&pe<=122||pe>=65&&pe<=90||pe>=48&&pe<=57||pe===45||pe===46||pe===95||pe===126||H&&pe===47||ae&&pe===91||ae&&pe===93||ae&&pe===58)ke!==-1&&(ie+=encodeURIComponent(Y.substring(ke,ge)),ke=-1),ie!==void 0&&(ie+=Y.charAt(ge));else{ie===void 0&&(ie=Y.substr(0,ge));let wt=B[pe];wt!==void 0?(ke!==-1&&(ie+=encodeURIComponent(Y.substring(ke,ge)),ke=-1),ie+=wt):ke===-1&&(ke=ge)}}return ke!==-1&&(ie+=encodeURIComponent(Y.substring(ke))),ie!==void 0?ie:Y}function X(Y){let H;for(let ae=0;ae<Y.length;ae++){let ie=Y.charCodeAt(ae);ie===35||ie===63?(H===void 0&&(H=Y.substr(0,ae)),H+=B[ie]):H!==void 0&&(H+=Y[ae])}return H!==void 0?H:Y}function D(Y,H){let ae;return ae=Y.authority&&Y.path.length>1&&Y.scheme==="file"?`//${Y.authority}${Y.path}`:Y.path.charCodeAt(0)===47&&(Y.path.charCodeAt(1)>=65&&Y.path.charCodeAt(1)<=90||Y.path.charCodeAt(1)>=97&&Y.path.charCodeAt(1)<=122)&&Y.path.charCodeAt(2)===58?H?Y.path.substr(1):Y.path[1].toLowerCase()+Y.path.substr(2):Y.path,o&&(ae=ae.replace(/\//g,"\\")),ae}function P(Y,H){let ae=H?X:W,ie="",{scheme:ke,authority:ge,path:pe,query:wt,fragment:je}=Y;if(ke&&(ie+=ke,ie+=":"),(ge||ke==="file")&&(ie+=x,ie+=x),ge){let ze=ge.indexOf("@");if(ze!==-1){let bn=ge.substr(0,ze);ge=ge.substr(ze+1),ze=bn.lastIndexOf(":"),ze===-1?ie+=ae(bn,!1,!1):(ie+=ae(bn.substr(0,ze),!1,!1),ie+=":",ie+=ae(bn.substr(ze+1),!1,!0)),ie+="@"}ge=ge.toLowerCase(),ze=ge.lastIndexOf(":"),ze===-1?ie+=ae(ge,!1,!0):(ie+=ae(ge.substr(0,ze),!1,!0),ie+=ge.substr(ze))}if(pe){if(pe.length>=3&&pe.charCodeAt(0)===47&&pe.charCodeAt(2)===58){let ze=pe.charCodeAt(1);ze>=65&&ze<=90&&(pe=`/${String.fromCharCode(ze+32)}:${pe.substr(3)}`)}else if(pe.length>=2&&pe.charCodeAt(1)===58){let ze=pe.charCodeAt(0);ze>=65&&ze<=90&&(pe=`${String.fromCharCode(ze+32)}:${pe.substr(2)}`)}ie+=ae(pe,!0,!1)}return wt&&(ie+="?",ie+=ae(wt,!1,!1)),je&&(ie+="#",ie+=H?je:W(je,!1,!1)),ie}function U(Y){try{return decodeURIComponent(Y)}catch{return Y.length>3?Y.substr(0,3)+U(Y.substr(3)):Y}}let ne=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function _e(Y){return Y.match(ne)?Y.replace(ne,H=>U(H)):Y}var Ue=n(470);let Ke=Ue.posix||Ue,Dt="/";var xe;(function(Y){Y.joinPath=function(H,...ae){return H.with({path:Ke.join(H.path,...ae)})},Y.resolvePath=function(H,...ae){let ie=H.path,ke=!1;ie[0]!==Dt&&(ie=Dt+ie,ke=!0);let ge=Ke.resolve(ie,...ae);return ke&&ge[0]===Dt&&!H.authority&&(ge=ge.substring(1)),H.with({path:ge})},Y.dirname=function(H){if(H.path.length===0||H.path===Dt)return H;let ae=Ke.dirname(H.path);return ae.length===1&&ae.charCodeAt(0)===46&&(ae=""),H.with({path:ae})},Y.basename=function(H){return Ke.basename(H.path)},Y.extname=function(H){return Ke.extname(H.path)}})(xe||(xe={}))})(),jR=i})();var{URI:Ze,Utils:Tt}=jR;var Ui=kt(require("fs")),rn=kt(require("fs/promises"));function e2(e){return e.isFile()?"File":e.isDirectory()?"Directory":"Other"}function t2(e){return e.isFile()?"File":e.isDirectory()?"Directory":"Other"}function zR(e){return{size:e.size,type:t2(e),mtime:Math.floor(e.mtimeMs)}}async function HR(e){let t=await rn.lstat(e);return zR(t)}function VR(e){try{return Zs(e).type==="File"}catch{return!1}}async function GR(e){try{return(await rn.stat(e)).isDirectory()}catch{return!1}}function Zs(e){let t=Ui.lstatSync(e);return zR(t)}function ea(e){let t=[],n=Ui.readdirSync(e,{withFileTypes:!0});for(let i of n)t.push([i.name,e2(i)]);return t}async function ta(e){await rn.mkdir(e,{recursive:!0})}async function jg(e,t){await rn.rename(e,t)}async function QR(e){return await rn.readFile(e)}async function Vo(e){return await rn.readFile(e,{encoding:"utf8"})}async function Yu(e,t){return await rn.writeFile(e,t,{encoding:"utf8"})}function JR(e){return Ui.readFileSync(e,{encoding:"utf8"})}var Zu=class{constructor(t){this.document=t}get uri(){return Ze.parse(this.document.uri)}get languageId(){return this.document.languageId}get version(){return this.document.version}positionAt(t){return this.document.positionAt(t)}offsetAt(t){return this.document.offsetAt(t)}getText(t){return this.document.getText(t)}},Or=class{dispose;constructor(t){this.dispose=()=>t()}},De=class{nodeEventEmitter;constructor(){this.nodeEventEmitter=new XR.EventEmitter,this.event=(t,n,i)=>{let o=n?t.bind(n):t;this.nodeEventEmitter.on("event",o);let c=new Or(()=>{this.nodeEventEmitter.off("event",o)});return Array.isArray(i)&&i.push(c),c}}event;fire(t){this.nodeEventEmitter.emit("event",t)}dispose(){this.nodeEventEmitter.removeAllListeners("event")}};var Br=class{token;tokenEvent;constructor(){this.tokenEvent=new De,this.token={isCancellationRequested:!1,onCancellationRequested:this.tokenEvent.event}}cancel(){this.token.isCancellationRequested=!0,this.tokenEvent.fire()}dispose(){this.tokenEvent.dispose()}},n2=new De,zg=new De,Vg={onDidChangeConfiguration:n2.event,getConfiguration:e=>e==="augment"?{}:{}},Hg=class{secretsPath;constructor(t){Dn.existsSync(t.fsPath)||Dn.mkdirSync(t.fsPath,{recursive:!0}),this.secretsPath=Tt.joinPath(t,"secrets.json").fsPath,Dn.existsSync(this.secretsPath)||Dn.writeFileSync(this.secretsPath,"{}",{mode:384})}async readSecrets(){try{let t=await Dn.promises.readFile(this.secretsPath,{encoding:"utf8"});return JSON.parse(t)}catch{return{}}}async writeSecrets(t){await Dn.promises.writeFile(this.secretsPath,JSON.stringify(t,null,2),{mode:384,encoding:"utf8"})}async get(t){return(await this.readSecrets())[t]}async store(t,n){let i=await this.readSecrets();i[t]=n,await this.writeSecrets(i),zg.fire({key:t})}async delete(t){let n=await this.readSecrets();t in n&&(delete n[t],await this.writeSecrets(n),zg.fire({key:t}))}onDidChange=zg.event},el=class{inMemoryState=new Map;statePath;constructor(t){Dn.mkdirSync(t.fsPath,{recursive:!0,mode:493}),this.statePath=Tt.joinPath(t,"state.json").fsPath;try{let n=JR(this.statePath),i=JSON.parse(n);this.inMemoryState=new Map(i)}catch{return}}get(t){return this.inMemoryState.get(t)}async update(t,n){this.inMemoryState.set(t,n);let i=JSON.stringify(Array.from(this.inMemoryState.entries()));await Dn.promises.writeFile(this.statePath,i,{encoding:"utf8",mode:420})}},na=class{globalState;workspaceState;storagePath;storageUri;globalStoragePath;globalStorageUri;secrets;constructor(t){Dn.mkdirSync(t.fsPath,{recursive:!0,mode:493}),this.storageUri=Tt.joinPath(t,"workspaceStorage"),this.storagePath=this.storageUri.fsPath,this.globalStorageUri=Tt.joinPath(t,"globalStorage"),this.globalStoragePath=this.globalStorageUri.fsPath,this.secrets=new Hg(t),this.globalState=new el(this.globalStorageUri),this.workspaceState=new el(this.storageUri)}};var r2=128*1024,Qg={gitDiff:!1,gitDiffPollingFrequencyMSec:0,additionalChatModels:"",smallSyncThreshold:15,bigSyncThreshold:1e3,enableWorkspaceManagerUi:!1,enableInstructions:!1,enableSmartPaste:!1,enableSmartPasteMinVersion:"",enableViewTextDocument:!1,bypassLanguageFilter:!1,enableHindsight:!1,maxUploadSizeBytes:r2,vscodeNextEditMinVersion:"",vscodeNextEditUx1MaxVersion:"",vscodeNextEditUx2MaxVersion:"",vscodeFlywheelMinVersion:"",vscodeExternalSourcesInChatMinVersion:"",vscodeShareMinVersion:"",maxTrackableFileCount:25e4,maxTrackableFileCountWithoutPermission:15e4,minUploadedPercentageWithoutPermission:90,vscodeSourcesMinVersion:"",vscodeChatHintDecorationMinVersion:"",nextEditDebounceMs:400,enableCompletionFileEditEvents:!1,vscodeEnableCpuProfile:!1,verifyFolderIsSourceRepo:!1,refuseToSyncHomeDirectories:!1,enableFileLimitsForSyncingPermission:!1,enableChatMermaidDiagrams:!1,enableSummaryTitles:!1,vscodeNewThreadsMenuMinVersion:"",vscodeEditableHistoryMinVersion:"",vscodeEnableChatMermaidDiagramsMinVersion:"",userGuidelinesLengthLimit:2e3,workspaceGuidelinesLengthLimit:2e3,enableGuidelines:!1,useCheckpointManagerContextMinVersion:"",validateCheckpointManagerContext:!1,vscodeDesignSystemRichTextEditorMinVersion:""},Gg=class{constructor(t,n,i){this._watchedFlags=n;this._callback=i;this._currentFlags=(0,KR.default)(t)}_disposed=!1;_currentFlags;get disposed(){return this._disposed}trigger(t){if(this._disposed)return;let n=[];for(let i of this._watchedFlags)t[i]!==this._currentFlags[i]&&n.push(i);n.length>0&&this._callback({previousFlags:this._currentFlags,newFlags:t,changedFlags:n})}dispose(){this._disposed=!0}},tl=class{_subscriptions=[];_refreshTimer;_disposed=!1;_logger=Ie("FeatureFlagManager");_flags;constructor(t){this._flags=new Wo("feature flags",this._logger),this._flags.update(t?.initialFlags??Qg),this._setupRefreshTimer(t)}get currentFlags(){if(this._disposed)throw Error("FeatureFlagManager has been disposed");return this._flags.value}update(t){if(this._disposed)throw Error("FeatureFlagManager has been disposed");this._flags.update(t),this._subscriptions=this._subscriptions.filter(n=>!n.disposed);for(let n of this._subscriptions)n.trigger(t)}subscribe(t,n){if(this._disposed)throw Error("FeatureFlagManager has been disposed");let i=new Gg(this._flags.value,t,n);return this._subscriptions.push(i),i}_setupRefreshTimer(t){if(!t?.fetcher||!t?.refreshIntervalMSec)return;this._cleanupRefreshTimer();let n=new Br().token,i=t.fetcher,o=t.refreshIntervalMSec,c=async()=>{let u=await i(n);u?this.update(u):n.isCancellationRequested&&this._cleanupRefreshTimer()};this._refreshTimer=setInterval(()=>void c(),o)}_cleanupRefreshTimer(){clearInterval(this._refreshTimer),this._refreshTimer=void 0}dispose(){this._disposed||(this._subscriptions.forEach(t=>t.dispose()),this._subscriptions=[],this._cleanupRefreshTimer(),this._disposed=!0)}};var o2=YR(),Jg=[],s2=new Set;for(let e of o2){Jg.push({name:e.name,vscodeName:e.vscodeName,extensions:e.extensions});for(let t of e.extensions)s2.add(t)}function ra(e,t,n){if(!Array.isArray(n))throw new Error(`Value of ${e}.${t} is not Array`)}function pi(e,t,n){let i=typeof n;if(i!=="number")throw new Error(`Value of ${e}.${t} has unexpected type. Expected number, received ${i}`);return n}function on(e,t,n){let i=typeof n;if(i!=="string")throw new Error(`Value of ${e}.${t} has unexpected type. Expected string, received ${i}`);return n}function Go(e,t,n){ra(e,t,n);let i=[];for(let o of n)i.push(on(e,t,o));return i}function Xg(e,t,n,i=!1){if(n===null)return i;let o=typeof n;if(o!=="boolean")throw new Error(`Value of ${e}.${t} has unexpected type. Expected boolean, received ${o}`);return n}function ia(e,t=""){let n=[];if(typeof e!="object"||e===null)return ZR(e);for(let[i,o]of Object.entries(e))if(Array.isArray(o)){n.push(`${t}${i}: (array) ${o.length} (array length) ${JSON.stringify(o).length} (char length)`);let c=20;o.slice(0,c).forEach((u,f)=>{n.push(`${t}  [${f}]: ${ia(u,t+"  ")}`)}),o.length>c&&n.push(`${t}  ${o.length-c} more items...`)}else typeof o=="object"&&o!==null?(n.push(`${t}${i}: (object) ${Object.keys(o).length} (object size) ${JSON.stringify(o).length} (char length)`),n.push(ia(o,t+"  "))):n.push(`${t}${i}: ${ZR(o)}`);return n.join(`
`)}function ZR(e){return typeof e=="string"?`${e.length} (string length)`:typeof e=="boolean"||e===null||typeof e=="number"?"1":"N/A"}var a2={initialMS:100,mult:2,maxMS:3e4};function oa(e){let t;return new Promise(n=>{t=e(i=>{t.dispose(),n(i)})})}function c2(e){return e===0?Promise.resolve():new Promise(t=>{setTimeout(t,e)})}async function yr(e,t,n=a2){let i=0,o=n.maxTotalMs!==void 0?Date.now():void 0,c=n.canRetry?n.canRetry:u=>Nt.isRetriableAPIError(u);for(let u=0;;u++)try{let f=await e();return u>0&&t.info(`Operation succeeded after ${u} transient failures`),f}catch(f){if(!c(f))throw f;let g=u+1;if(n.maxTries!==void 0&&g>=n.maxTries||(i===0?i=n.initialMS:i=Math.min(i*n.mult,n.maxMS),t.info(`Operation failed with error ${f}, retrying in ${i} ms; retries = ${u}`),n.maxTotalMs!==void 0&&o!==void 0&&Date.now()-o+i>n.maxTotalMs))throw f;await c2(i)}}async function Kg(e,t){let n=new Promise((i,o)=>{setTimeout(()=>{o(new Error("Execution aborted due to timeout."))},t)});return await Promise.race([e,n])}function nl(e){return{checkpoint_id:e.checkpointId,added_blobs:e.addedBlobs.sort(),deleted_blobs:e.deletedBlobs.sort()}}var Yg=class extends Error{constructor(t,n){super(`Conversion failure: ${t}. Response = ${n}`)}},rl=class e{constructor(t,n,i,o,c){this._configListener=t;this._auth=n;this.sessionId=i;this._userAgent=o;this._fetchFunction=c}static defaultRequestTimeoutMs=3e4;_sequenceId=new Zg;_logger=Ie("AugmentExtension");getSessionId(){return this.sessionId}createRequestId(){return Ns()}async callApi(t,n,i,o,c,u,f,g){let b=n.apiToken,x=!1;if(this._auth.useOAuth){let U=await this._auth.getSession();U&&(b=U.accessToken,x=!0,u||(u=U.tenantURL))}else u||(u=n.completionURL);if(!u)throw new Error("Please configure Augment API URL");let k;try{k=new URL(i,u)}catch(U){throw this._logger.error("Augment API URL is invalid:",U),new il}if(!k.protocol.startsWith("http"))throw new Error("Augment API URL must start with 'http://' or 'https://'");let I=JSON.stringify(o,(U,ne)=>ne===void 0?null:ne),M=f??e.defaultRequestTimeoutMs,N=AbortSignal.timeout(M),B="POST",W,X,D;try{let U={"Content-Type":"application/json","User-Agent":this._userAgent,"x-request-id":`${t}`,"x-request-session-id":`${this.sessionId}`,"x-api-version":"2"};b&&(U.Authorization=`Bearer ${b}`),X=Date.now(),W=await Kg(this._fetchFunction(k.toString(),{method:B,headers:U,body:I,signal:N}),M),D=Date.now()}catch(U){throw U instanceof Error?(this._logger.error(`API request ${t} to ${k.toString()} failed: ${Ee(U,!0)}`),Nt.transientIssue(U.message)):(this._logger.debug(`API request ${t} to ${k.toString()} failed`),U)}if(g&&(g.rpcStart=X,g.rpcEnd=D),!W.ok)throw W.status===499?Nt.fromResponse(W):(W.status===401&&x&&this._auth.removeSession(),W.status===400&&n.enableDebugFeatures&&this._logger.error(`API request ${t} to ${k.toString()} failed: ${await W.text()}`),this._logger.error(`API request ${t} to ${k.toString()} response ${W.status}: ${W.statusText}`),Nt.fromResponse(W).status===10&&this._logger.debug(`object size is ${ia(o)} `),Nt.fromResponse(W));let P;try{if(W.headers.get("content-length")==="0")return;P=await W.json()}catch(U){throw this._logger.error(`API request ${t} to ${k.toString()} failed to convert response to json: ${U.message}`),U}try{return c?c(P):P}catch(U){throw new Yg(Ee(U),JSON.stringify(P))}}async callApiStream(t,n,i,o,c=b=>b,u,f,g){let b=n.apiToken;if(this._auth.useOAuth){let P=await this._auth.getSession();P&&(b=P.accessToken,u||(u=P.tenantURL))}else u||(u=n.completionURL);if(!u)throw new Error("Please configure Augment API URL");let x;try{x=new URL(i,u)}catch(P){throw this._logger.error("Augment API URL is invalid:",P),new il}if(!x.protocol.startsWith("http"))throw new Error("Augment API URL must start with 'http://' or 'https://'");let k=JSON.stringify(o,(P,U)=>U===void 0?null:U),I=f??e.defaultRequestTimeoutMs,M=AbortSignal.timeout(I),N="POST",B;try{let P={"Content-Type":"application/json","User-Agent":this._userAgent,"x-request-id":`${t}`,"x-request-session-id":`${g??this.sessionId}`};b&&(P.Authorization=`Bearer ${b}`),B=await Kg(this._fetchFunction(x.toString(),{method:N,headers:P,body:k,signal:M}),I)}catch(P){throw P instanceof Error?(this._logger.error(`API request ${t} to ${x.toString()} failed: ${Ee(P,!0)}`),P.stack&&this._logger.error(P.stack),Nt.transientIssue(P.message)):P}if(!B.ok)throw B.status===499?Nt.fromResponse(B):(B.status===401&&this._auth.removeSession(),B.status===400&&n.enableDebugFeatures&&this._logger.error(`API request ${t} to ${x.toString()} failed: ${await B.text()}`),this._logger.error(`API request ${t} to ${x.toString()} response ${B.status}: ${B.statusText}`),Nt.fromResponse(B).status===10&&this._logger.debug(`object size is ${o?ia(o):0} `),Nt.fromResponse(B));let W=B.body.getReader(),X=this._logger;async function*D(P){let U=new TextDecoder,ne="";for(;;){let{value:_e,done:Ue}=await P.read(new Uint8Array);if(Ue)return;for(ne+=U.decode(_e,{stream:!0});ne.includes(`
`);){let Ke=ne.indexOf(`
`),Dt=ne.substring(0,Ke);ne=ne.substring(Ke+1);try{let xe=JSON.parse(Dt);yield c(xe)}catch(xe){X.error(`JSON parse failed for ${Dt}: ${Ee(xe)}`)}}}}return D(W)}_toCompletionItem(t){if(typeof t.text!="string")throw new Error(`Completion item text is not a string: ${JSON.stringify(t)}`);if(t.skipped_suffix!==void 0&&typeof t.skipped_suffix!="string")throw new Error(`Completion item skipped suffix is not a string: ${JSON.stringify(t)}`);if(t.suffix_replacement_text!==void 0&&typeof t.suffix_replacement_text!="string")throw new Error(`Completion item suffix replacement text is not a string: ${JSON.stringify(t)}`);return{text:t.text,suffixReplacementText:t.suffix_replacement_text??"",skippedSuffix:t.skipped_suffix??"",filterScore:t.filter_score??void 0}}_extractCompletions(t){return Array.isArray(t.completion_items)?t.completion_items.map(n=>this._toCompletionItem(n)):Array.isArray(t.completions)?Go("BackCompletionResult","completions",t.completions).map(i=>({text:i,suffixReplacementText:"",skippedSuffix:""})):[{text:on("BackCompletionResult","text",t.text),suffixReplacementText:"",skippedSuffix:""}]}toCompleteResult(t){let n=this._extractCompletions(t),i=Go("BackCompletionResult","unknown_blob_names/unknown_memory_names",t.unknown_blob_names??t.unknown_memory_names),o=t.checkpoint_not_found===void 0?!1:Xg("BackCompletionResult","checkpoint_not_found",t.checkpoint_not_found,!1);return{completionItems:n,unknownBlobNames:i,checkpointNotFound:o,suggestedPrefixCharCount:t.suggested_prefix_char_count,suggestedSuffixCharCount:t.suggested_suffix_char_count,completionTimeoutMs:t.completion_timeout_ms}}toCheckpointBlobsResult(t){return{newCheckpointId:on("BackCheckpointBlobsResult","new_checkpoint_id",t.new_checkpoint_id)}}async complete(t,n,i,o,c,u,f,g,b,x,k,I,M){let N=this._configListener.config,B={recent_changes:b},W={model:N.modelName,prompt:n,suffix:i,path:o,blob_name:c,prefix_begin:u?.prefixBegin,cursor_position:u?.cursorPosition,suffix_end:u?.suffixEnd,lang:f,blobs:nl(g),recency_info:B,probe_only:I,sequence_id:this._sequenceId.next(),filter_threshold:N.completions.filterThreshold,edit_events:this.toFileDiffsPayload(x??[])};return await this.callApi(t,N,"completion",W,X=>this.toCompleteResult(X),void 0,k,M)}async checkpointBlobs(t){let n=this.createRequestId(),i=this._configListener.config,o={blobs:nl(t)},c=await this.callApi(n,i,"checkpoint-blobs",o,u=>this.toCheckpointBlobsResult(u));for(let u of this.getUniqueExtraURLs())(await this.callApi(n,i,"checkpoint-blobs",o,g=>this.toCheckpointBlobsResult(g),u)).newCheckpointId!==c.newCheckpointId&&this._logger.error(`Checkpoint blobs API returned different checkpoint IDs for ${u}`);return c}toVCSChangePayload(t){return{working_directory_changes:t.workingDirectory.map(n=>({before_path:n.beforePath,after_path:n.afterPath,change_type:n.changeType,head_blob_name:n.headBlobName,indexed_blob_name:n.indexedBlobName,current_blob_name:n.currentBlobName}))}}toFileDiffsPayload(t){return[]}getUniqueExtraURLs(){return new Set}toMemorizeResult(t){return{blobName:t.blob_name!==void 0?on("BackMemorizeResult","blob_name",t.blob_name):on("BackMemorizeResult","mem_object_name",t.mem_object_name)}}async memorize(t,n,i,o,c){let u=this.createRequestId(),f=this._configListener.config,g=await this.callApi(u,f,"memorize",{model:f.modelName,path:t,t:n,blob_name:i,metadata:o,timeout_ms:c},b=>this.toMemorizeResult(b));for(let b of this.getUniqueExtraURLs())await this.callApi(u,f,"memorize",{model:f.modelName,path:t,t:n,blob_name:i,metadata:o},x=>this.toMemorizeResult(x),b);return g}toBatchUploadResult(t){return{blobNames:t.blob_names}}async batchUpload(t){let n=this.createRequestId(),i=this._configListener.config;try{let o=await this.callApi(n,i,"batch-upload",{blobs:t.map(c=>({blob_name:c.blobName,path:c.pathName,content:c.text}))},this.toBatchUploadResult.bind(this));for(let c of this.getUniqueExtraURLs())await this.callApi(n,i,"batch-upload",{blobs:t.map(u=>({blob_name:u.blobName,path:u.pathName,content:u.text}))},this.toBatchUploadResult.bind(this),c);return o}catch(o){if(!Nt.isAPIErrorWithStatus(o,4))throw o;let c=[];for(let u of t){let f=await this.memorize(u.pathName,u.text,u.blobName,u.metadata);c.push(f.blobName)}return{blobNames:c}}}toFindMissingResult(t){return{unknownBlobNames:Go("BackFindMissingResult","unknown_memory_names",t.unknown_memory_names),nonindexedBlobNames:Go("BackFindMissingResult","nonindexed_blob_names",t.nonindexed_blob_names)}}async findMissing(t){let n=this._configListener.config,i=this.createRequestId(),o=n.modelName,c=[...t].sort(),u=await this.callApi(i,n,"find-missing",{model:o,mem_object_names:c},f=>this.toFindMissingResult(f));for(let f of this.getUniqueExtraURLs()){let g=await this.callApi(i,n,"find-missing",{model:o,mem_object_names:c},b=>this.toFindMissingResult(b),f);u.unknownBlobNames=u.unknownBlobNames.concat(g.unknownBlobNames),u.nonindexedBlobNames=u.nonindexedBlobNames.concat(g.nonindexedBlobNames)}return u}async resolveCompletions(t){let n=this.createRequestId(),i=this._configListener.config;return await this.callApi(n,i,"resolve-completions",{client_name:"vscode-extension",resolutions:t})}toChatResult(t){let n=on("BackChatResult","text",t.text),i=t.unknown_blob_names===void 0?[]:Go("BackChatResult","unknown_blob_names",t.unknown_blob_names),o=t.checkpoint_not_found===void 0?!1:Xg("BackChatResult","checkpoint_not_found",t.checkpoint_not_found,!1),c=t.workspace_file_chunks===void 0?[]:t.workspace_file_chunks.map(f=>({charStart:pi("BackWorkspaceFileChunk","char_start",f.char_start),charEnd:pi("BackWorkspaceFileChunk","char_end",f.char_end),blobName:on("BackWorkspaceFileChunk","blob_name",f.blob_name)})),u=t.nodes===void 0?[]:t.nodes.map(f=>({id:pi("BackChatResultNode","id",f.id),type:pi("BackChatResultNode","type",f.type),content:on("BackChatResultNode","content",f.content)}));return{text:n,unknownBlobNames:i,checkpointNotFound:o,workspaceFileChunks:c,nodes:u}}async chat(t,n,i,o,c,u,f,g,b,x,k,I,M,N){let B=this._configListener.config,W={model:f??B.chat.model,path:M,prefix:k,selected_code:x,suffix:I,message:n,chat_history:i,lang:N,blobs:nl(o),user_guided_blobs:c,external_source_ids:u,context_code_exchange_request_id:b,vcs_change:{working_directory_changes:[]},recency_info_recent_changes:g,feature_detection_flags:{support_raw_output:!0}};return await this.callApi(t,B,"chat",W,X=>this.toChatResult(X),B.chat.url,12e4)}async chatStream(t,n,i,o,c,u,f,g,b,x,k,I,M,N,B,W,X,D){let P=this._configListener.config,U={model:f??P.chat.model,path:M,prefix:k,selected_code:x,suffix:I,message:n,chat_history:i,lang:N,blobs:nl(o),user_guided_blobs:c,context_code_exchange_request_id:b,vcs_change:{working_directory_changes:[]},recency_info_recent_changes:g,external_source_ids:u,disable_auto_external_sources:W,user_guidelines:X,workspace_guidelines:D,feature_detection_flags:{support_raw_output:!0}};return await yr(()=>this.callApiStream(t,P,"chat-stream",U,this.toChatResult.bind(this),P.chat.url,12e4,B),this._logger,{initialMS:250,mult:2,maxMS:5e3,maxTries:5,maxTotalMs:5e3})}toModel(t){let n=t.completion_timeout_ms!==void 0?pi("BackModelInfo","completion_timeout_ms",t.completion_timeout_ms):void 0;return{name:on("BackModelInfo","name",t.name),suggestedPrefixCharCount:pi("BackModelInfo","suggested_prefix_char_count",t.suggested_prefix_char_count),suggestedSuffixCharCount:pi("BackModelInfo","suggested_suffix_char_count",t.suggested_suffix_char_count),completionTimeoutMs:n,internalName:t.internal_name&&on("BackModelInfo","internal_name",t.internal_name)}}toLanguage(t){let n=on("BackLanguageInfo","name",t.name),i=on("BackLanguageInfo","vscodeName",t.vscode_name);ra("BackLanguageInfo","extensions",t.extensions);let o=[];for(let c of t.extensions)o.push(on("BackLanguageInfo","extensions",c));return{name:n,vscodeName:i,extensions:o}}toGetModelsResult(t){let n=on("BackGetModelsResult","default_model",t.default_model);ra("BackGetModelsResult","models",t.models);let i=[];for(let u of t.models)i.push(this.toModel(u));let o=Qg;if(t.feature_flags!==void 0){let u=t.feature_flags.git_diff_polling_freq_msec;u!==void 0&&u>0&&(o.gitDiff=!0,o.gitDiffPollingFrequencyMSec=u),t.feature_flags.small_sync_threshold!==void 0&&(o.smallSyncThreshold=t.feature_flags.small_sync_threshold),t.feature_flags.big_sync_threshold!==void 0&&(o.bigSyncThreshold=t.feature_flags.big_sync_threshold),t.feature_flags.enable_workspace_manager_ui_launch!==void 0&&(o.enableWorkspaceManagerUi=t.feature_flags.enable_workspace_manager_ui_launch),t.feature_flags.enable_instructions!==void 0&&(o.enableInstructions=t.feature_flags.enable_instructions),t.feature_flags.enable_smart_paste!==void 0&&(o.enableSmartPaste=t.feature_flags.enable_smart_paste),t.feature_flags.enable_smart_paste_min_version!==void 0&&(o.enableSmartPasteMinVersion=t.feature_flags.enable_smart_paste_min_version),t.feature_flags.enable_view_text_document!==void 0&&(o.enableViewTextDocument=t.feature_flags.enable_view_text_document),t.feature_flags.bypass_language_filter!==void 0&&(o.bypassLanguageFilter=t.feature_flags.bypass_language_filter),t.feature_flags.additional_chat_models!==void 0&&(o.additionalChatModels=t.feature_flags.additional_chat_models),t.feature_flags.enable_hindsight!==void 0&&(o.enableHindsight=t.feature_flags.enable_hindsight),t.feature_flags.max_upload_size_bytes!==void 0&&(o.maxUploadSizeBytes=t.feature_flags.max_upload_size_bytes),t.feature_flags.vscode_next_edit_min_version!==void 0&&(o.vscodeNextEditMinVersion=t.feature_flags.vscode_next_edit_min_version),t.feature_flags.vscode_flywheel_min_version!==void 0&&(o.vscodeFlywheelMinVersion=t.feature_flags.vscode_flywheel_min_version),t.feature_flags.vscode_external_sources_in_chat_min_version!==void 0&&(o.vscodeExternalSourcesInChatMinVersion=t.feature_flags.vscode_external_sources_in_chat_min_version),t.feature_flags.vscode_share_min_version!==void 0&&(o.vscodeShareMinVersion=t.feature_flags.vscode_share_min_version),t.feature_flags.max_trackable_file_count!==void 0&&(o.maxTrackableFileCount=t.feature_flags.max_trackable_file_count),t.feature_flags.max_trackable_file_count_without_permission!==void 0&&(o.maxTrackableFileCountWithoutPermission=t.feature_flags.max_trackable_file_count_without_permission),t.feature_flags.min_uploaded_percentage_without_permission!==void 0&&(o.minUploadedPercentageWithoutPermission=t.feature_flags.min_uploaded_percentage_without_permission),t.feature_flags.vscode_sources_min_version!==void 0&&(o.vscodeSourcesMinVersion=t.feature_flags.vscode_sources_min_version),t.feature_flags.vscode_chat_hint_decoration_min_version!==void 0&&(o.vscodeChatHintDecorationMinVersion=t.feature_flags.vscode_chat_hint_decoration_min_version),t.feature_flags.next_edit_debounce_ms!==void 0&&(o.nextEditDebounceMs=t.feature_flags.next_edit_debounce_ms),t.feature_flags.enable_completion_file_edit_events!==void 0&&(o.enableCompletionFileEditEvents=t.feature_flags.enable_completion_file_edit_events),t.feature_flags.vscode_enable_cpu_profile!==void 0&&(o.vscodeEnableCpuProfile=t.feature_flags.vscode_enable_cpu_profile),t.feature_flags.verify_folder_is_source_repo!==void 0&&(o.verifyFolderIsSourceRepo=t.feature_flags.verify_folder_is_source_repo),t.feature_flags.refuse_to_sync_home_directories!==void 0&&(o.refuseToSyncHomeDirectories=t.feature_flags.refuse_to_sync_home_directories),t.feature_flags.enable_file_limits_for_syncing_permission!==void 0&&(o.enableFileLimitsForSyncingPermission=t.feature_flags.enable_file_limits_for_syncing_permission),t.feature_flags.enable_chat_mermaid_diagrams!==void 0&&(o.enableChatMermaidDiagrams=t.feature_flags.enable_chat_mermaid_diagrams),t.feature_flags.enable_summary_titles!==void 0&&(o.enableSummaryTitles=t.feature_flags.enable_summary_titles),t.feature_flags.vscode_new_threads_menu_min_version!==void 0&&(o.vscodeNewThreadsMenuMinVersion=t.feature_flags.vscode_new_threads_menu_min_version),t.feature_flags.vscode_editable_history_min_version!==void 0&&(o.vscodeEditableHistoryMinVersion=t.feature_flags.vscode_editable_history_min_version)}let c=[];if(t.languages===void 0)c=Jg;else{ra("BackGetModelsResult","languages",t.languages),c=[];for(let u of t.languages)c.push(this.toLanguage(u))}return{defaultModel:n,models:i,languages:c,featureFlags:o}}async getModelConfig(){let t=this._configListener.config,n=this.createRequestId();return await this.callApi(n,t,"get-models",{},o=>this.toGetModelsResult(o))}async getAccessToken(t,n,i,o){let c=this._configListener.config,u=this.createRequestId(),f={grant_type:"authorization_code",client_id:c.oauth.clientID,code_verifier:i,redirect_uri:t,code:o};return await this.callApi(u,c,"token",f,g=>g.access_token,n)}async clientMetrics(t){let n=this._configListener.config,i=this.createRequestId();await this.callApi(i,n,"client-metrics",{metrics:t},void 0,void 0,e.defaultRequestTimeoutMs)}async reportClientCompletionTimelines(t){let n=this._configListener.config,i=this.createRequestId();await this.callApi(i,n,"/client-completion-timelines",{timelines:t},void 0,void 0,e.defaultRequestTimeoutMs)}},il=class extends Error{constructor(){super("The completion URL setting is invalid")}},Zg=class{_sequenceId=0;next(){return this._sequenceId++}};var ir=class{_disposables=[];add(t){if(t===void 0)throw new Error("Attempt to add undefined disposable to DisposableCollection");return this._disposables.push(t),t}addAll(...t){t.forEach(n=>this.add(n))}adopt(t){this._disposables.push(...t._disposables),t._disposables.length=0}dispose(){for(let t of this._disposables)t.dispose();this._disposables.length=0}},mt=class{_disposables=new ir;_priorityDisposables=new ir;constructor(t=new ir,n=new ir){this._disposables.adopt(t),this._priorityDisposables.adopt(n)}addDisposable(t,n=!1){return n?this._priorityDisposables.add(t):this._disposables.add(t)}addDisposables(...t){this._disposables.addAll(...t)}dispose(){this._priorityDisposables.dispose(),this._disposables.dispose()}};var u2={Augment:null},l2="augment-vim-extension",ol=class e extends mt{_config;_configChanged=new De;_configMonitor;_logger=Ie("AugmentConfigListener");constructor(){super(),this._configMonitor=new Wo("Config",this._logger),this._refreshConfig(),this.addDisposable(Vg.onDidChangeConfiguration(()=>this._refreshConfig()))}get config(){return this._config}get onDidChange(){return this._configChanged.event}_refreshConfig(){let t=this._config;this._config=e.normalizeConfig(this._getUserConfig()),this._configMonitor.update(this._config)&&this._configChanged.fire({previousConfig:t,newConfig:this._config})}static normalizeConfig(t){return{apiToken:t.advanced.apiToken,completionURL:t.advanced.completionURL,modelName:t.advanced.model,conflictingCodingAssistantCheck:t.conflictingCodingAssistantCheck,codeInstruction:{model:t.advanced.codeInstruction.model||void 0},chat:{url:t.advanced.chat.url||void 0,model:t.advanced.chat.model||void 0,stream:t.advanced.chat.stream??void 0,enableEditableHistory:t.advanced.chat.enableEditableHistory??!1,useRichTextHistory:t.advanced.chat.useRichTextHistory??!0,smartPasteUsePrecomputation:t.advanced.chat.smartPasteUsePrecomputation??!0,experimentalFullFilePaste:t.advanced.chat.experimentalFullFilePaste??!1,modelDisplayNameToId:t.advanced.chat.modelDisplayNameToId||u2,userGuidelines:t.chat.userGuidelines||""},autofix:{enabled:t.advanced.autofix.enabled,locationUrl:t.advanced.autofix.locationUrl||void 0,autofixUrl:t.advanced.autofix.autofixUrl||void 0},oauth:{clientID:t.advanced.oauth.clientID||l2,url:t.advanced.oauth.url||"https://auth.augmentcode.com"},enableUpload:t.advanced.enableWorkspaceUpload,enableShortcutsAboveSelectedText:t.enableShortcutsAboveSelectedText,shortcutsDisplayDelayMS:t.shortcutsDisplayDelayMS,enableEmptyFileHint:t.enableEmptyFileHint,enableBackgroundSuggestions:t.enableBackgroundSuggestions,enableGlobalBackgroundSuggestions:t.enableGlobalBackgroundSuggestions,showAllBackgroundSuggestionLineHighlights:t.showAllBackgroundSuggestionLineHighlights,enableDataCollection:t.advanced.enableDataCollection,enableDebugFeatures:t.advanced.enableDebugFeatures,enableReviewerWorkflows:t.advanced.enableReviewerWorkflows,completions:{enableAutomaticCompletions:t.completions.enableAutomaticCompletions,disableCompletionsByLanguage:new Set(t.completions.disableCompletionsByLanguage),enableQuickSuggestions:t.completions.enableQuickSuggestions,timeoutMs:t.advanced.completions.timeoutMs,maxWaitMs:t.advanced.completions.maxWaitMs,addIntelliSenseSuggestions:t.advanced.completions.addIntelliSenseSuggestions,filterThreshold:t.advanced.completions.filterThreshold},openFileManagerV2:{enabled:t.advanced.openFileManagerV2.enabled},nextEdit:{enabled:t.advanced.nextEdit.enabled,backgroundEnabled:t.advanced.nextEdit.backgroundEnabled,url:t.advanced.nextEdit.url,locationUrl:t.advanced.nextEdit.locationUrl||t.advanced.nextEdit.url,generationUrl:t.advanced.nextEdit.generationUrl||t.advanced.nextEdit.url,showInstructionTextbox:t.advanced.nextEdit.showInstructionTextbox,model:t.advanced.nextEdit.model,useDebounceMs:t.advanced.nextEdit.useDebounceMs,useCursorDecorations:t.advanced.nextEdit.useCursorDecorations,useSmallHover:t.advanced.nextEdit.useSmallHover,noDiffMode:t.advanced.nextEdit.noDiffMode,animateNoDiffMode:t.advanced.nextEdit.animateNoDiffMode,allowDuringDebugging:t.advanced.nextEdit.allowDuringDebugging,useMockResults:t.advanced.nextEdit.useMockResults,noDiffModeUseCodeLens:t.advanced.nextEdit.noDiffModeUseCodeLens,showDiffByDefault:t.advanced.nextEdit.showDiffByDefault},recencySignalManager:t.advanced.recencySignalManager,preferenceCollection:{enable:t.advanced.preferenceCollection.enable,enableRetrievalDataCollection:t.advanced.preferenceCollection.enableRetrievalDataCollection,enableRandomizedMode:t.advanced.preferenceCollection.enableRandomizedMode},vcs:{watcherEnabled:t.advanced.vcs.watcherEnabled},smartPaste:{url:t.advanced.smartPaste?.url,model:t.advanced.smartPaste?.model},instructions:{model:t.advanced.instructions?.model}}}_getUserConfig(){let t=Vg.getConfiguration("augment");return e.normalizeUserConfig(t)}static normalizeUserConfig(t){return{completions:{enableAutomaticCompletions:ft(t.enableAutomaticCompletions??t.completions?.enableAutomaticCompletions,!0),disableCompletionsByLanguage:t.disableCompletionsByLanguage||t.completions?.disableCompletionsByLanguage||[],enableQuickSuggestions:ft(t.completions?.enableQuickSuggestions,!0)},chat:{userGuidelines:t.chat?.userGuidelines||""},enableShortcutsAboveSelectedText:ft(t.enableShortcutsAboveSelectedText,!1),shortcutsDisplayDelayMS:d2(t.shortcutsDisplayDelayMS,2e3),enableEmptyFileHint:ft(t.enableEmptyFileHint,!0),enableBackgroundSuggestions:ft(t.enableBackgroundSuggestions,!0),enableGlobalBackgroundSuggestions:ft(t.enableGlobalBackgroundSuggestions,!1),showAllBackgroundSuggestionLineHighlights:ft(!t.advanced?.nextEdit?.noDiffMode,!t.advanced?.nextEdit?.noDiffMode),conflictingCodingAssistantCheck:ft(t.conflictingCodingAssistantCheck,!0),advanced:{apiToken:(t.advanced?.apiToken||t.apiToken||"").trim().toUpperCase(),completionURL:(t.advanced?.completionURL||t.completionURL||"").trim(),enableWorkspaceUpload:ft(t.advanced?.enableWorkspaceUpload,!0),model:t.advanced?.model||"",enableDebugFeatures:ft(t.advanced?.enableDebugFeatures,!1),enableReviewerWorkflows:ft(t.advanced?.enableReviewerWorkflows,!1),enableDataCollection:ft(t.advanced?.enableDataCollection,!1),codeInstruction:{model:t.advanced?.codeInstruction?.model||void 0},chat:{url:t.advanced?.chat?.url||void 0,model:t.advanced?.chat?.model||void 0,stream:t.advanced?.chat?.stream??void 0,enableEditableHistory:t.advanced?.chat?.enableEditableHistory,useRichTextHistory:t.advanced?.chat?.useRichTextHistory,smartPasteUsePrecomputation:t.advanced?.chat?.smartPasteUsePrecomputation,modelDisplayNameToId:t.advanced?.chat?.modelDisplayNameToId,experimentalFullFilePaste:t.advanced?.chat?.experimentalFullFilePaste},autofix:{enabled:ft(t.advanced?.autofix?.enabled,!1),locationUrl:t.advanced?.autofix?.locationUrl||void 0,autofixUrl:t.advanced?.autofix?.autofixUrl||void 0},oauth:{clientID:t.advanced?.oauth?.clientID,url:t.advanced?.oauth?.url},completions:{timeoutMs:t.advanced?.completions?.timeoutMs??800,maxWaitMs:t.advanced?.completions?.maxWaitMs??1600,addIntelliSenseSuggestions:t.advanced?.completions?.addIntelliSenseSuggestions??!0,filterThreshold:t.advanced?.completions?.filter_threshold??void 0},openFileManagerV2:{enabled:ft(t.advanced?.openFileManager?.useV2,!1)},nextEdit:{enabled:t.advanced?.nextEdit?.enabled,backgroundEnabled:ft(t.advanced?.nextEdit?.backgroundEnabled,!0),url:t.advanced?.nextEdit?.url,locationUrl:t.advanced?.nextEdit?.locationUrl,generationUrl:t.advanced?.nextEdit?.generationUrl,showInstructionTextbox:ft(t.advanced?.nextEdit?.showInstructionTextbox,!1),model:t.advanced?.nextEdit?.model,useDebounceMs:t.advanced?.nextEdit?.useDebounceMs,useCursorDecorations:ft(t.advanced?.nextEdit?.useCursorDecorations,!1),useSmallHover:ft(t.advanced?.nextEdit?.useSmallHover,!0),noDiffMode:t.advanced?.nextEdit?.noDiffMode,animateNoDiffMode:t.advanced?.nextEdit?.animateNoDiffMode,showDiffByDefault:t.advanced?.nextEdit?.showDiffByDefault,allowDuringDebugging:ft(t.advanced?.nextEdit?.allowDuringDebugging,!1),useMockResults:ft(t.advanced?.nextEdit?.useMockResults,!1),noDiffModeUseCodeLens:ft(t.advanced?.nextEdit?.noDiffModeUseCodeLens,!1)},recencySignalManager:{collectTabSwitchEvents:t.advanced?.recencySignalManager?.collectTabSwitchEvents??!1},preferenceCollection:{enable:ft(t.advanced?.preferenceCollection?.enable,!1),enableRetrievalDataCollection:ft(t.advanced?.preferenceCollection?.enableRetrievalDataCollection,!1),enableRandomizedMode:ft(t.advanced?.preferenceCollection?.enableRandomizedMode,!0)},vcs:{watcherEnabled:ft(t.advanced?.vcs?.watcherEnabled,!1)},smartPaste:{url:t.advanced?.smartPaste?.url,model:t.advanced?.smartPaste?.model},instructions:{model:t.advanced?.instructions?.model}}}}};function ft(e,t){return e==null?t:typeof e=="string"?e.toLowerCase()!=="false":!!e}function d2(e,t){return e==null?t:typeof e=="string"?parseInt(e):e}var tT=kt(Vu());var sa="augment.sessions",eT=["email"],sl=class extends mt{constructor(n,i){super();this._context=n;this._config=i;this.addDisposables(this.onDidChangeSession(o=>{this._isLoggedIn=!!o}),this._context.secrets.onDidChange(async o=>{o.key===sa&&this._sessionChangeEmitter.fire(await this.getSession())})),this._ready=this.initState()}_sessionChangeEmitter=new De;_readyEmitter=new De;_isLoggedIn;_ready;get onDidChangeSession(){return this._sessionChangeEmitter.event}get onReady(){return this._readyEmitter.event}get useOAuth(){let n=this._config.config;return!!n.oauth&&!!n.oauth.url&&!!n.oauth.clientID&&!n.apiToken&&!n.completionURL}async initState(){this._isLoggedIn=!!await this.getSession(),this._readyEmitter.fire()}get isLoggedIn(){return this._isLoggedIn}async saveSession(n,i){await this._context.secrets.store(sa,JSON.stringify({accessToken:n,tenantURL:i,scopes:eT}))}async getSession(){let n=await this._context.secrets.get(sa);if(n){let i=JSON.parse(n);if((0,tT.isEqual)(i.scopes,eT))return i}return null}async removeSession(){await this._context.secrets.get(sa)&&await this._context.secrets.delete(sa)}};var Qo=require("crypto"),ep=require("url");var f2=["email"],al="augment.oauth-state",h2=process.env.TEST_HOSTNAME??".augmentcode.com",g2=10,cl=class{constructor(t,n,i,o){this._context=t;this._config=n;this._apiServer=i;this._authSession=o;this.authRedirectURI=Ze.from({scheme:"vscode",authority:"augment.vscode-augment",path:"/auth/result"})}_logger=Ie("OAuthFlow");authRedirectURI;async startFlow(){return this._logger.info("Creating new session..."),(await this.login()).toString(!0)}async createOAuthState(){this._logger.info("Creating OAuth state");let t=nT((0,Qo.randomBytes)(32)),n=nT(p2(Buffer.from(t))),i=(0,Qo.randomUUID)(),o={codeVerifier:t,codeChallenge:n,state:i,creationTime:new Date().getTime()};return await this._context.secrets.store(al,JSON.stringify(o)),this._logger.info("Created OAuth state"),o}async getOAuthState(){this._logger.info("Getting OAuth state");let t=await this._context.secrets.get(al);if(t){let n=JSON.parse(t);if(new Date().getTime()-n.creationTime<g2*60*1e3)return n}return null}async removeOAuthState(){this._logger.info("Removing OAuth state"),await this._context.secrets.get(al)&&await this._context.secrets.delete(al)}async login(){try{let t=await this.createOAuthState();return this.generateAuthorizeURL(t)}catch(t){throw await this.removeOAuthState(),t}}generateAuthorizeURL(t){let n=f2.join(" "),i=new URLSearchParams({response_type:"code",code_challenge:t.codeChallenge,code_challenge_method:"S256",client_id:this._config.oauth.clientID||"",redirect_uri:"",state:t.state,scope:n,prompt:"login"}),o=new ep.URL(`/authorize?${i.toString()}`,this._config.oauth.url);return Ze.parse(o.toString())}async processAuthRedirect(t){let n=new URLSearchParams(t.query),i=n.get("state");if(!i)throw new Error("No state");let o=await this.getOAuthState();if(!o)throw new Error("No OAuth state found");if(await this.removeOAuthState(),o.state!==i)throw new Error("Unknown state");let c=n.get("error");if(c){let g=[`(${c})`],b=n.get("error_description");throw b&&g.push(b),new Error(`OAuth request failed: ${g.join(" ")}`)}let u=n.get("code");if(!u)throw new Error("No code");let f=n.get("tenant_url");if(f){if(!new ep.URL(f).hostname.endsWith(h2))throw new Error("OAuth request failed: invalid OAuth tenant URL")}else throw new Error("No tenant URL");try{this._logger.info("Calling get access token to retrieved access token");let g=await this._apiServer.getAccessToken("",f,o.codeVerifier,u);await this._authSession.saveSession(g,f),this._logger.info("Successfully retrieved access token")}catch(g){throw this._logger.error(`Failed to get and save access token: ${Ee(g)}`),new Error(`If you have a firewall, please add "${f}" to your allowlist.`)}}async handleAuthURI(t){try{await this.processAuthRedirect(t)}catch(n){this._logger.warn("Failed to process auth request:",n)}}async handleAuthJson(t){let n=JSON.parse(t);if(!await this.getOAuthState())throw new Error("No OAuth state found");let o=this.authRedirectURI.with({query:`code=${n.code}&state=${n.state}&tenant_url=${n.tenant_url}`});return await this.processAuthRedirect(o),"success"}};function nT(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function p2(e){return(0,Qo.createHash)("sha256").update(e).digest()}var LT=require("console"),OT=require("crypto");var ul=class e{constructor(t,n,i,o,c=e.chunkSize){this._apiServer=t;this._completionTimeoutMs=n,this._completionParams={prefixSize:i,suffixSize:o,chunkSize:c}}static chunkSize=1024;_completionTimeoutMs;_completionParams;createRequestId(){return this._apiServer.createRequestId()}get completionParams(){return this._completionParams}async complete(t,n,i,o,c,u,f,g,b,x,k,I,M){let N=await this._apiServer.complete(t,n,i,o,c,u,f,g,b,x,k,I,M);return N.completionTimeoutMs!==void 0&&(this._completionTimeoutMs=N.completionTimeoutMs),N.suggestedPrefixCharCount!==void 0&&(this._completionParams.prefixSize=N.suggestedPrefixCharCount),N.suggestedSuffixCharCount!==void 0&&(this._completionParams.suffixSize=N.suggestedSuffixCharCount),N.suggestedPrefixCharCount!==void 0&&(this._completionParams.chunkSize=e.chunkSize),N}};function m2(e,t){return n=>{let i=performance.now()-e;return t(Math.round(i)),n}}function rT(e,t){return(...n)=>{let i=performance.now(),o=m2(i,t),c=e(...n);return c instanceof Promise?c.then(o):o(c)}}function b2(e,t,n,i,o,c,u){return{blob_name:e,path:t,char_start:n,char_end:i,replacement_text:o,present_in_blob:c,expected_blob_name:u}}function iT(e){return e.map(t=>b2(t.blobName,t.pathName,t.origStart,t.origStart+t.origLength,t.text,t.uploaded,t.expectedBlobName))}var ll=class{constructor(t,n,i,o){this.completionText=t;this.suffixReplacementText=n;this.skippedSuffix=i;this.range=o}toString(){return`text: ${this.completionText}
    suffixReplacementText: ${this.suffixReplacementText}
    skippedSuffix: ${this.skippedSuffix}
    start: ${this.range.startOffset}
    end: ${this.range.endOffset}`}};var dl=class{constructor(t,n,i){this._extension=t;this._configListener=n;this._metricsReporter=i;this.generateCompletion=rT(this.generateCompletion.bind(this),o=>{this._metricsReporter.report({client_metric:"generate_completion_latency",value:o})})}_logger=Ie("CompletionsModel");_completionSerial=0;async generateCompletion(t,n,i){let o=this._extension.workspaceManager;if(o===void 0)return;let c=o.completionServer,u=c.createRequestId(),f=o.safeResolvePathName(t.uri);if(f===void 0)return;let[g,b]=[f.rootPath,f.relPath],x=t.offsetAt(n),[k,I,M,N,B]=this._extractPrefixAndSuffix(t,x);x+=B;let W={prefixBegin:M,cursorPosition:x,suffixEnd:N},D=(await this._requestCompletion(o,c,u,t,k,I,W,f,i)).completionItems;if(D.length===0)return{completions:[],document:t,requestId:u,repoRoot:g,pathName:b,prefix:k,suffix:I,occuredAt:new Date,isReused:!1};D.length>1&&this._logger.warn("Multiple completions not supported, ignoring all but the first");let P=[],ne=D[0];return ne.skippedSuffix.includes(`
`)&&(this._logger.debug("Skipped suffix spans multiple lines, dropping it"),ne.skippedSuffix="",ne.suffixReplacementText=""),P.push(new ll(ne.text,ne.suffixReplacementText,ne.skippedSuffix,{startOffset:t.offsetAt(n),endOffset:t.offsetAt(n)})),this._logger.debug(`Returning ${P.length} completion(s)`),{occuredAt:new Date,completions:P,document:t,requestId:u,repoRoot:g,pathName:b,prefix:k,suffix:I,isReused:!1}}async _requestCompletion(t,n,i,o,c,u,f,g,b){let x=o.languageId;if(this._configListener.config.completions.disableCompletionsByLanguage.has(x))throw new Eo(`Language ${x} is disabled.`);let I=this._completionSerial++;this._logger.debug(`Requesting new completion - #${I} submitted; requestId: ${i}`);let M=t.translateRange(g,f.prefixBegin,f.suffixEnd),N=M===void 0?f:{prefixBegin:M.beginOffset,cursorPosition:f.cursorPosition,suffixEnd:M.endOffset},B=t.getContext(),W=B.blobs,X=this._getRecentChanges(B),D=void 0;try{let P=await n.complete(i,c,u,g.relPath,M?.blobName,N,x,W,X,D,void 0,void 0,b);return P.unknownBlobNames.length>0&&t.handleUnknownBlobs(B,P.unknownBlobNames),P.checkpointNotFound&&t.handleUnknownCheckpoint(i,W.checkpointId),v2(P.completionItems,u,this._logger),this._extension.updateModelInfo(P),P.completionItems=P.completionItems.filter(U=>(U.text+U.suffixReplacementText).length>0),P}catch(P){if(Nt.isAPIErrorWithStatus(P,1))throw this._logger.debug(`Completion #${I} cancelled in back end; requestId ${i}`),new Eo("Cancelled in back end");if(Nt.isRetriableAPIError(P))throw this._logger.debug(`Completion #${I} retriable error on back end; requestId ${i}`),new Eo("Retriable error on back end");let U=Ee(P);throw this._logger.warn(`Completion #${I} failed: ${U}; requestId ${i}`),P}}_extractPrefixAndSuffix(t,n){let i=this._extension.modelInfo,o=i.suggestedPrefixCharCount,c=i.suggestedSuffixCharCount,[u,f]=[void 0,0];u!==void 0&&(n+=f);let g=Math.max(0,n-o),b=n+c;if(u!==void 0)throw new Error("Notebook support not implemented");let x=t.positionAt(g),k=t.positionAt(n),I=t.positionAt(n),M=t.positionAt(b),N=dt.create(x,k),B=dt.create(I,M),W=t.getText(N),X=t.getText(B);return[W,X,g,n+X.length,0]}_getRecentChanges(t){let n=t.recentChunks,i=t.lastChatResponse;if(i!==void 0){let o={seq:i.seq,uploaded:!1,repoRoot:"",pathName:"",blobName:"",text:i.text,origStart:0,origLength:0,expectedBlobName:""},c=n.findIndex(u=>u.seq<o.seq);c<0&&(c=n.length),n=n.slice(0,c).concat([o]).concat(n.slice(c))}return iT(n)}};function v2(e,t,n){for(let i of e)t.startsWith(i.skippedSuffix)||(n.warn(`Skipped suffix does not match the actual suffix. Skipped suffix: ${i.skippedSuffix}. First ${i.skippedSuffix.length} characters of suffix: ${t.substring(0,i.skippedSuffix.length)}`),i.suffixReplacementText="",i.skippedSuffix="")}var fl=class{constructor(t){this._maxItems=t;this._items=new Array(t),this._emptySlots=t}_insertCount=0;_emptySlots;_items;get empty(){return this.length===0}get length(){return this._maxItems-this._emptySlots}addItem(t){this._items[this._insertCount%this._maxItems]=t,this._emptySlots=Math.max(this._emptySlots-1,0),this._insertCount++}shiftLeft(t){this._emptySlots=Math.min(this._emptySlots+t,this._maxItems)}shiftRight(t){this._insertCount-=Math.min(t,this.length),this._emptySlots=Math.min(this._emptySlots+t,this._maxItems)}at(t){if(t<0)return t<-this.length?void 0:this._items[(this._insertCount+t)%this._maxItems];if(!(t>=this.length))return this._items[(this._insertCount+this._emptySlots+t)%this._maxItems]}_normalizeSliceIdx(t){return t>=0?Math.min(t,this.length):Math.max(this.length+t,0)}_translateIdx(t){return(this._insertCount+this._emptySlots+t)%this._maxItems}slice(t,n){let i=this._normalizeSliceIdx(t??0),o=this._normalizeSliceIdx(n??this.length);if(i>o)return[];let c=o-i,u=this._translateIdx(i);return u+c<=this._maxItems?this._items.slice(u,u+c):this._items.slice(u).concat(this._items.slice(0,(u+c)%this._maxItems))}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.at(t)}clear(){this._emptySlots=this._maxItems}};var Jo=class{constructor(t,n,i,o){this._uploadMsec=i;this._uploadBatchSize=o;this._store=new fl(n),this._logger=Ie(t)}_logger;_store;_uploadIntervalId=void 0;_currentUploadPromise;report(t){this._store.addItem(t)}get uploadEnabled(){return this._uploadIntervalId!==void 0}enableUpload(){this.uploadEnabled||(this._uploadIntervalId=setInterval(()=>{this._currentUploadPromise===void 0&&(async()=>{try{this._currentUploadPromise=this._doUpload(),await this._currentUploadPromise}finally{this._currentUploadPromise=void 0}})()},this._uploadMsec))}async _doUpload(){if(this._store.length===0)return;let t=this._store.slice();this._store.clear();for(let n=0;n<t.length;n+=this._uploadBatchSize){let i=t.slice(n,n+this._uploadBatchSize);await yr(async()=>{if(this.uploadEnabled)try{return this._logger.debug(`Uploading ${i.length} metric(s)`),await this.performUpload(i)}catch(o){throw this._logger.error(`Error uploading metrics: ${o} ${o instanceof Error?o.stack:""}`),o}},this._logger)}}disableUpload(){clearInterval(this._uploadIntervalId),this._uploadIntervalId=void 0}dispose(){this.disableUpload()}};var hl=class e extends Jo{constructor(n){super("ClientMetricsReporter",e.defaultMaxRecords,e.defaultUploadMsec,e.defaultBatchSize);this._apiServer=n}static defaultMaxRecords=1e4;static defaultBatchSize=500;static defaultUploadMsec=1e4;performUpload(n){return this._apiServer.clientMetrics(n)}};function tp(e){let t=Math.floor(e/1e3),n=e%1e3*1e6;return[t,n]}var gl=class e extends Jo{constructor(n,i,o,c){super("CompletionAcceptanceReporter",i??e.defaultMaxRecords,o??e.defaultUploadMsec,c??e.defaultBatchSize);this._apiServer=n}static defaultMaxRecords=1e4;static defaultBatchSize=1e3;static defaultUploadMsec=1e4;reportResolution(n,i,o,c){let[u,f]=tp(i),[g,b]=tp(o);this.report({request_id:n,emit_time_sec:u,emit_time_nsec:f,resolve_time_sec:g,resolve_time_nsec:b,accepted_idx:c??-1})}performUpload(n){return this._apiServer.resolveCompletions(n)}};var pl=class e{constructor(t){this._extensionContext=t}static storageSubDir="augment-global-state";update(t,n){return this._extensionContext.globalState.update(t,n)}get(t){return this._extensionContext.globalState.get(t)}async save(t,n,i){await this._ensureStorageUriExists(i);let o=this._getFileUri(t,i);return await Yu(o.fsPath,JSON.stringify(n))}async load(t,n){await this._ensureStorageUriExists(n);let i=this._getFileUri(t,n);try{let o=await Vo(i.fsPath);return JSON.parse(o)}catch{return}}async _ensureStorageUriExists(t){let n=this._getStorageUri(t);await GR(n.fsPath)||await ta(n.fsPath)}_getStorageUri(t){return t?.uniquePerWorkspace&&this._extensionContext.storageUri?Tt.joinPath(this._extensionContext.storageUri,e.storageSubDir):Tt.joinPath(this._extensionContext.globalStorageUri,e.storageSubDir)}_getFileUri(t,n){return Tt.joinPath(this._getStorageUri(n),`${t}.json`)}};var NT=kt(Vu());var np=class{async read(t){try{return await QR(t)}catch{return}}stat(t){try{return Zs(t)}catch{return}}};function oT(){return new np}var sT=kt(require("crypto"));function aT(e){let t=sT.createHash("sha256");return t.update(e),t.digest("hex")}var fp=kt(bT());var aa=class{accepted=!0},mi=class{accepted=!1};var st=kt(require("node:path"));var ca=st.posix.sep,L2=new RegExp("/\\/g");function _T(e){return st.isAbsolute(e)}function O2(e){return st.sep==="\\"?e.replace(L2,ca):e}function vT(e){return O2(e)}function yT(e){return e.with({path:st.dirname(e.fsPath)})}function bl(e){let t=st.dirname(e);return t==="."?"":B2(t)}function B2(e){return e.endsWith(ca)?e:e+ca}function Xo(e){for(;;){if(e===st.sep||e===ca||!e.endsWith(ca)&&!e.endsWith(st.sep))return e;e=e.slice(0,-1)}}function ua(e,t){let n=typeof e=="string"?e:e.fsPath,i=typeof t=="string"?t:t.fsPath;return st.relative(n,i)}function $r(e,t){let n=ua(e,t);return n==="."?"":n.length>0&&!n.endsWith(st.sep)?n+st.sep:n}function tt(e,t,n=!1){let i=st.join(e,t);return n&&!i.endsWith(st.sep)&&(i+=st.sep),i}function la(e,t){let n=ua(e,t);if(!(n===".."||n.startsWith(".."+st.sep)||n.startsWith(".."+st.posix.sep)))return n}function or(e,t){return la(e,t)!==void 0}function _l(e,t){let n=ua(e,t);return n===""||n==="."||n==="."+st.sep||n==="."+st.posix.sep}async function vl(e,t,n){let i=typeof e=="string"?Ze.file(e):e;for(;;){try{let c=Tt.joinPath(i,t),u=await HR(c.fsPath);if(n===void 0||u.type===n)return i}catch{}let o=st.dirname(i.fsPath);if(st.relative(o,i.fsPath).length===0)return;i=i.with({path:o})}}function U2(e){return!1}function Yt(e){return Xo(e.fsPath)}function xT(e){return e.fsPath}function Ko(e){if(e.scheme==="file"||e.scheme==="untitled"||U2(e))return Yt(e)}var bi=class extends aa{explicit=!1;format(){return"Tracked"}},cp=class extends aa{constructor(n){super();this.ignoreSourceName=n}explicit=!0;format(){return`Tracked (${this.ignoreSourceName})`}},up=class extends mi{constructor(n){super();this.ignoreSourceName=n}explicit=!0;format(){return`Not tracked (${this.ignoreSourceName})`}},yl=class{constructor(t,n,i,o){this.dirName=t;this.ignoreSource=n;this.rules=i;this.next=o}},lp=class e{constructor(t,n,i){this._rootUri=t;this._ignoreSource=n;this._top=i}static async buildNew(t,n,i){let o=new Array;if($r(i,n)!==""){let u=n;for(;;){u=yT(u);let f=$r(i,u),g=await t.getRules(u);if(g&&o.push([f,t,g]),f==="")break}}let c;for(let u=o.length-1;u>=0;u--){let[f,g,b]=o[u];c=new yl(f,g,b,c)}return new e(i,t,c)}async buildAtop(t,n){let i=await this._ignoreSource.getRules(t,n);if(i===void 0)return this;let o=$r(this._rootUri,t),c=new yl(o,this._ignoreSource,i,this._top);return new e(this._rootUri,this._ignoreSource,c)}getPathInfo(t){for(let n=this._top;n!==void 0;n=n.next){if(!or(n.dirName,t))throw new Error(`candidatePath "${t}" is not below ignore file's parent "${n.dirName}"`);let i=t.slice(n.dirName.length),o=n.rules.test(i);if(o.ignored)return new up(n.ignoreSource.getName(Tt.joinPath(this._rootUri,n.dirName)));if(o.unignored)return new cp(n.ignoreSource.getName(Tt.joinPath(this._rootUri,n.dirName)))}return new bi}},dp=class e{constructor(t,n){this._ignoreSources=t;this._ignoreStacks=n}static async buildNew(t,n,i){let o=new Array;for(let c of t){let u=await lp.buildNew(c,n,i);o.push(u)}return new e(t,o)}async buildAtop(t,n){let i=new Array,o=0;for(let c=0;c<this._ignoreStacks.length;c++){let u=this._ignoreStacks[c],f=await u.buildAtop(t,n);f!==u&&o++,i.push(f)}return o===0?this:new e(this._ignoreSources,i)}getPathInfo(t){for(let n=this._ignoreStacks.length-1;n>=0;n--){let o=this._ignoreStacks[n].getPathInfo(t);if(o.explicit)return o}return new bi}};async function $2(e,t){let n=Tt.joinPath(e,t);try{let i=await Vo(n.fsPath),o=(0,fp.default)({ignorecase:!1});return o.add(i),o}catch{}}var Yo=class{constructor(t=[]){this._ignoreSources=t}async build(t,n){return await dp.buildNew(this._ignoreSources,t,n)}},da=class{constructor(t){this.filename=t}getName(t){return xT(Tt.joinPath(t,this.filename))}async getRules(t,n){if(!(n!==void 0&&!(n.find(([o,c])=>c==="File"&&this.filename===o)!==void 0)))return $2(t,this.filename)}},xl=class{constructor(t){this._sourceFolderRootPath=t}getName(){return"default Augment rules"}getRules(t){return new Promise(n=>{if(Yt(t)!==this._sourceFolderRootPath)n(void 0);else{let i=(0,fp.default)({ignorecase:!1});i.add([".git","*.pem","*.key","*.pfx","*.p12","*.jks","*.keystore","*.pkcs12","*.crt","*.cer","id_rsa","id_ed25519","id_ecdsa","id_dsa",".augment-guidelines"]),n(i)}})}};var wl=class{constructor(t){this.name=t}start=Date.now();increments=[];charge(t){this.increments.push({name:t,end:Date.now()})}*[Symbol.iterator](){let t=this.start;for(let{name:n,end:i}of this.increments)yield[n,i-t],t=i;yield["total",t-this.start]}format(){return(this.name?`${this.name}:
`:"")+Array.from(this).map(([n,i])=>`  - ${n}: ${i} ms`).join(`
`)}},Pl=class{_value=0;_add(t=1){this._value+=t}_invalidate(){this._value=Number.NaN}get value(){return this._value}},hp=class extends Pl{increment(t=1){this._add(t)}},gp=class extends Pl{_start=void 0;start(){this._start=Date.now()}stop(){this._start===void 0?this._invalidate():this._add(Date.now()-this._start)}},Zo=class{constructor(t){this.name=t}counters=new Map;timings=new Map;counterMetric(t){let n=this.counters.get(t);return n===void 0&&(n=new hp,this.counters.set(t,n)),n}timingMetric(t){let n=this.timings.get(t);return n===void 0&&(n=new gp,this.timings.set(t,n)),n}format(){let t=this.name?`${this.name}:`:"",n=Array.from(this.counters.entries()).map(([c,u])=>`  - ${c}: ${u.value}`).join(`
`),i="  - timing stats:",o=Array.from(this.timings.entries()).map(([c,u])=>`    - ${c}: ${u.value} ms`).join(`
`);return t+`
`+n+`
`+i+`
`+o}};var wT=kt(require("os"));function PT(e){let t=wT.default.homedir();return _l(e,t)}var fa=kt(require("node:path"));async function Cl(e,t,n,i){let o=await n.build(e,t),c=new Map;c.set("",o),c.set(".",o);let u=200,f=Date.now(),g=[];g.push([e,o]);let b;for(;(b=g.pop())!==void 0;){Date.now()-f>=u&&(await new Promise(W=>setTimeout(W,0)),f=Date.now());let[k,I]=b,M=$r(t,k),N=ea(k.fsPath),B=await I.buildAtop(k,N);B!==I&&c.set(M,B);for(let[W,X]of N){if(Date.now()-f>=u&&(await new Promise(_e=>setTimeout(_e,0)),f=Date.now()),W==="."||W===".."||X!=="Directory")continue;let P=Tt.joinPath(k,W),U=tt(M,W,!0);B.getPathInfo(U).accepted&&g.push([P,B])}}return new mp(c,i)}var es=class{constructor(t,n,i,o){this._name=t;this._startUri=n;this._rootUri=i;this._pathFilter=o;if(!fa.isAbsolute(n.fsPath))throw new Error(`PathIterator[${this._name}]: startUri ${this._name} must contain an absolute pathname`);if(!fa.isAbsolute(i.fsPath))throw new Error(`PathIterator[${this._name}]: rootUri ${i.toString()} must contain an absolute pathname`);if(!or(Yt(i),Yt(n)))throw new Error(`PathIterator[${this._name}]: startUri ${Yt(this._startUri)} must be inside rootUri ${Yt(this._rootUri)}`);this._logger.verbose(`Created PathIterator for startUri ${this._startUri.fsPath}, rootUri ${this._rootUri.fsPath}`)}stats=new Zo("Path metrics");_logger=Ie("PathIterator");_dirsEmitted=this.stats.counterMetric("directories emitted");_filesEmitted=this.stats.counterMetric("files emitted");_otherEmitted=this.stats.counterMetric("other paths emitted");_totalEmitted=this.stats.counterMetric("total paths emitted");_readDirMs=this.stats.timingMetric("readDir");_filterMs=this.stats.timingMetric("filter");_yieldMs=this.stats.timingMetric("yield");_totalMs=this.stats.timingMetric("total");async*[Symbol.asyncIterator](){this._totalMs.start();let t=200,n=Date.now(),i=new Array;i.push(this._startUri);let o;for(;(o=i.pop())!==void 0;){Date.now()-n>=t&&(await new Promise(b=>setTimeout(b,0)),n=Date.now());let u=$r(this._rootUri,o),f=this._pathFilter.makeLocalPathFilter(u);this._readDirMs.start();let g=ea(o.fsPath);this._readDirMs.stop();for(let[b,x]of g){if(Date.now()-n>=t&&(await new Promise(W=>setTimeout(W,0)),n=Date.now()),b==="."||b==="..")continue;this._filterMs.start();let I=Tt.joinPath(o,b),M=tt(u,b,x==="Directory"),N=f.getPathInfo(M,x);this._filterMs.stop();let B=M;x==="File"?this._filesEmitted.increment():x==="Directory"?(B=Xo(M),this._dirsEmitted.increment()):this._otherEmitted.increment(),this._totalEmitted.increment(),this._yieldMs.start(),yield[I,B,x,N],this._yieldMs.stop(),x==="Directory"&&N.accepted&&i.push(I)}}this._totalMs.stop()}},pp=class extends mi{constructor(n){super();this.extension=n}format(){return`Unsupported file extension (${this.extension})`}},Sl=class{_fileExtensions;constructor(t){if(t){this._fileExtensions=new Set;for(let n of t)this._fileExtensions.add(n.toLowerCase())}else this._fileExtensions=void 0}acceptsPath(t,n="File"){return this.getPathInfo(t,n).accepted}getPathInfo(t,n="File"){if(n==="File"){let o=fa.extname(t);if(this._fileExtensions!==void 0&&!this._fileExtensions.has(o.toLowerCase()))return new pp(o)}else n==="Directory"&&!t.endsWith("/")&&(t+="/");let i=this._getIgnoreStack(bl(t));return i===void 0?new bi:i.getPathInfo(t)}},mp=class extends Sl{constructor(n,i){super(i);this._ignorePathMap=n}makeLocalPathFilter(n){let i=this._getIgnoreStack(n);return new bp(i,this._fileExtensions)}_getIgnoreStack(n){if(_T(n))throw new Error(`Absolute path ${n} passed to PathFilter`);let i=n;for(let o=0;o<1e4;o++){let c=this._ignorePathMap.get(i);if(c)return c;if(bl(i)===i)return;i=bl(i)}throw new Error(`Too-deep or malformed directory name ${n}`)}},bp=class extends Sl{constructor(n,i){super(i);this._ignoreStack=n}_getIgnoreStack(n){return this._ignoreStack}};var kl=class e{static defaultStartSeq=1e4;_next;constructor(t=e.defaultStartSeq){this._next=t}next(){return this._next++}};var _p=class extends Error{constructor(){super("SingletonExecutor has been disposed")}},Rl=class e extends mt{constructor(n){super();this._execute=n;this.addDisposable({dispose:()=>this._stopping=!0})}static _disposedError=new _p;_nextExecutionScheduled=!1;_kickPromise=Promise.resolve();_stopping=!1;kick(){return this._nextExecutionScheduled?this._kickPromise:(this._nextExecutionScheduled=!0,this._kickPromise=this._kickPromise.then(async()=>(this._nextExecutionScheduled=!1,this._stopping?Promise.reject(e._disposedError):this._execute())),this._kickPromise)}};var vp=class{_items=new Map;_inProgress=!1;_stopping=!1;dispose(){this._stopping=!0}get size(){return this._items.size}cancel(t){this._items.delete(t)}_insert(t,n,i=!1){let o=this._items.has(t);return!i&&o?!1:(this._items.set(t,n),!o)}async kick(){if(!(this._inProgress||this._stopping||this._items.size===0)){for(this._inProgress=!0;this._items.size>0&&!this._stopping;){let t=this._items;this._items=new Map;for(let n of t){try{await this._processEntry(n)}catch{}if(this._stopping)break}}this._inProgress=!1,await this._processEntry(void 0)}}};var Hn=class extends vp{constructor(n){super();this._processItem=n}insert(n,i,o=!1){return this._insert(n,i,o)}get(n){return this._items.get(n)}async _processEntry(n){return this._processItem(n)}},Tl=class{constructor(t){this._processItem=t}_keys=new Set;_items=new Array;_inProgress=!1;_stopping=!1;get size(){return this._items.length}dispose(){this._stopping=!0}insert(t){return this._keys.has(t)?!1:(this._keys.add(t),this._items.push(t),!0)}async kick(){if(!(this._inProgress||this._stopping)){for(this._inProgress=!0;this._items.length>0&&!this._stopping;){let t=this._items;this._keys.clear(),this._items=new Array;for(let n of t){try{await this._processItem(n)}catch{}if(this._stopping)break}}this._inProgress=!1,await this._processItem(void 0)}}},_i=class{constructor(t,n){this._toKick=t;this._intervalId=setInterval(this._kick.bind(this),n)}_intervalId;_kick(){this._toKick.kick()}dispose(){this._intervalId!==void 0&&clearInterval(this._intervalId)}};var W2=Object.freeze({git:{name:".git",type:"Directory"}});async function ST(e){for(let[t,n]of Object.entries(W2)){let i=await vl(e,n.name,n.type);if(i!==void 0)return{root:i,toolName:t}}}var ha=class extends Error{constructor(n,i){let o=n instanceof Error?n.message:`${n}`;super(`WorkQueueItemFailed: ${o}, retry = ${i}`);this.toThrow=n;this.retry=i}},yp=class{throwError(t,n){throw new ha(t,n)}},xp=class{progressReporter;completedItems=0;totalItems;constructor(t,n){this.progressReporter=t,this.totalItems=n,this.update(0,this.totalItems)}update(t,n){this.completedItems+=t,this.totalItems=this.completedItems+n,this.progressReporter.update(this.completedItems,this.totalItems)}cancel(){this.progressReporter.cancel()}},wp=class{constructor(t,n){this.item=t;this.process=n}itemCount(){return 1}start(t){return this.process(this.item,t)}},Pp=class{constructor(t,n){this.items=t;this.process=n}itemCount(){return this.items.size}start(t){return this.process(this.items,t)}},Dl=class{queue=new Set;get size(){return this.queue.size}add(t){this.queue.add(t)}delete(t){this.queue.delete(t)}},Sp=class extends Dl{constructor(n){super();this.process=n}dequeue(){let n=this.queue.values().next();if(n.done)throw new Error("Cannot dequeue from empty queue");let i=n.value;return this.queue.delete(i),new wp(i,this.process)}},Cp=class extends Dl{constructor(n,i){super();this.process=n;this._maxBatchSize=i}dequeue(){let n;if(this._maxBatchSize===void 0||this.queue.size<=this._maxBatchSize)n=this.queue,this.queue=new Set;else{n=new Set;let i=this.queue.values();for(let o=0;o<this._maxBatchSize;o++){let c=i.next();if(c.done)break;let u=c.value;this.queue.delete(u),n.add(u)}}return new Pp(n,this.process)}},El=class e{constructor(t,n,i,o){this.name=t;this.shutdownError=i;if("processOne"in n)this.queue=new Sp(n.processOne);else if("processBatch"in n)this.queue=new Cp(n.processBatch,n.maxBatchSize);else throw new Error("Invalid processor type");this.backoffParams=o||e.defaultBackoffParams,this.logger=Ie(`WorkQueue[${t}]`),this.errorHandler=new yp}static queueStatusChanged="QueueStatusChanged";static itemFailed="ItemFailed";static defaultBackoffParams={initialMS:100,mult:2,maxMS:3e4};eventEmitters={[e.queueStatusChanged]:new De,[e.itemFailed]:new De};queue;countReporters=new Set;progressReporters=new Set;errorHandler;backoffParams;itemsInProgress=0;stopping=!1;logger;stop(){this.stopping=!0,this.update(),this.notifyStatusChanged()}add(t){this.stopping||(this.queue.add(t),this.update(),this.kick())}delete(t){this.stopping||(this.queue.delete(t),this.update())}size(){return this.queue.size+this.itemsInProgress}reportQueueSize(t){let n=this.size();t.update(n),this.countReporters.add(t)}awaitEmpty(t,n=!0){if(this.stopping)return Promise.resolve();let i=this.size();return i===0?Promise.resolve():(t&&this.progressReporters.add(new xp(t,i)),new Promise((o,c)=>{let u=[];function f(){for(let g of u)g.dispose()}u.push(this.eventEmitters[e.queueStatusChanged].event(()=>{f(),this.stopping?c(this.shutdownError):o()})),n&&u.push(this.eventEmitters[e.itemFailed].event(g=>{f(),c(g)}))}))}update(t=0){if(this.stopping){for(let n of this.countReporters)n.cancel();for(let n of this.progressReporters)n.cancel()}else{this.itemsInProgress-=t;let n=this.size();for(let i of this.countReporters)i.update(n);for(let i of this.progressReporters)i.update(t,n)}}notifyStatusChanged(){this.eventEmitters[e.queueStatusChanged].fire(null),this.progressReporters.clear()}notifyItemFailed(t){let n=t instanceof ha?t.toThrow:t;this.eventEmitters[e.itemFailed].fire(n)}delay(t){return new Promise(n=>setTimeout(n,t))}async kick(){if(!this.itemsInProgress){for(;!this.stopping&&this.queue.size!==0;){let t=this.queue.dequeue();this.itemsInProgress=t.itemCount();let n=0,i=0;do{try{await t.start(this.errorHandler),i&&this.logger.debug(`item succeeded; retries = ${i}`);break}catch(o){if(this.notifyItemFailed(o),!(o instanceof ha&&o.retry)){this.logger.debug(`item failed, not retrying; retries = ${i}`);break}}this.logger.debug(`item failed, retrying in ${n} ms; retries = ${i}`),await this.delay(n),this.logger.debug("retrying"),n===0?n=this.backoffParams.initialMS:n=Math.min(n*this.backoffParams.mult,this.backoffParams.maxMS),i++}while(!this.stopping);this.stopping||this.update(this.itemsInProgress)}this.notifyStatusChanged()}}};function ts(e,t){let n=new Set(t);return e.filter(i=>!n.has(i))}var Il=class e extends mt{static defaultCheckpointThreshold=1e3;_checkpointId;_checkpointBlobNames=new Map;_toAdd=new Map;_toRemove=new Set;_apiServer;_logger;_checkpointQueue;_checkpointThreshold;_maxCheckpointBatchSize=1e4;_featureFlagManager;_onContextChange=new De;onContextChange=this._onContextChange.event;get _flags(){return this._featureFlagManager.currentFlags}constructor(t,n,i,o){super(),this._logger=Ie("BlobsCheckpointManager"),this._checkpointId=void 0,this._apiServer=t,this._featureFlagManager=n,this._checkpointThreshold=o??e.defaultCheckpointThreshold,this.addDisposable(i(c=>{this.updateBlob(c.absPath,c.prevBlobName,c.newBlobName)})),this._checkpointQueue=new El("checkpoint",{processOne:async(c,u)=>await this._checkpoint(c,u)}),this._logger.info(`BlobsCheckpointManager created. checkpointThreshold: ${this._checkpointThreshold}`)}refBlob(t){let n=this._checkpointBlobNames.get(t);n!==void 0?(this._checkpointBlobNames.set(t,n+1),n===0&&this._toRemove.delete(t)):this._toAdd.set(t,(this._toAdd.get(t)??0)+1)}derefBlob(t){!this.derefFromCheckpoint(t)&&!this.derefFromAdded(t)&&this._logger.error(`derefBlob: blob ${t} not found in checkpoint or toAdd`)}derefFromCheckpoint(t){let n=this._checkpointBlobNames.get(t);return n===void 0||n<=0?(n!==void 0&&this._logger.error(`derefFromCheckpoint: blob ${t} has reference count ${n}. In toRemove? ${this._toRemove.has(t)}`),!1):(this._checkpointBlobNames.set(t,n-1),n===1&&this._toRemove.add(t),!0)}derefFromAdded(t){let n=this._toAdd.get(t);return n===void 0?!1:n<=1?(this._toAdd.delete(t),n===1):(this._toAdd.set(t,n-1),!0)}getCheckpointedBlobNames(){return Array.from(this._checkpointBlobNames.keys())}getContext(){return{checkpointId:this._checkpointId,addedBlobs:Array.from(this._toAdd.keys()),deletedBlobs:Array.from(this._toRemove)}}getContextAdjusted(t,n){let i=new Set(this._toAdd.keys()),o=new Set(this._toRemove);for(let c of t)this._checkpointBlobNames.has(c)||i.add(c),o.delete(c);for(let c of n)this._checkpointBlobNames.has(c)&&o.add(c),i.delete(c);return{checkpointId:this._checkpointId,addedBlobs:Array.from(i),deletedBlobs:Array.from(o)}}blobsPayload(t){let n=this.getCheckpointedBlobNames(),i=ts(t,n),o=ts(n,t);return{checkpointId:this._checkpointId,addedBlobs:i,deletedBlobs:o}}expandBlobs(t){if(t.checkpointId===void 0)return t.addedBlobs;if(t.checkpointId!==this._checkpointId)throw new Error(`expandBlobs: checkpointId mismatch: ${t.checkpointId} != ${this._checkpointId}`);let n=this.getCheckpointedBlobNames();if(n.push(...t.addedBlobs),t.deletedBlobs.length>0){let i=new Set(t.deletedBlobs);return n.filter(o=>!i.has(o))}return n}validateMatching(t,n,i=!1){if(t.checkpointId!==n.checkpointId)return this._logger.error(`checkpointId mismatch: ${t.checkpointId} vs ${n.checkpointId}`),!1;let o=!0,c=ts(t.addedBlobs,n.addedBlobs),u=ts(n.addedBlobs,t.addedBlobs);return(c.length>0||u.length>0)&&(o=!1,this._logger.error(`addedBlobs mismatch: -${c.length}/+${u.length}`),i&&(this._logger.error(`left-added: ${c.slice(0,5).join(",")}`),this._logger.error(`right-added: ${u.slice(0,5).join(",")}`))),c=ts(t.deletedBlobs,n.deletedBlobs),u=ts(n.deletedBlobs,t.deletedBlobs),(c.length>0||u.length>0)&&(o=!1,this._logger.error(`deletedBlobs mismatch: -${c.length}/+${u.length}`),i&&(this._logger.error(`left-deleted: ${c.slice(0,5).join(",")}`),this._logger.error(`right-deleted: ${u.slice(0,5).join(",")}`))),o}updateBlob(t,n,i){this._logger.verbose(`notifyBlobChange ${t}: ${n} to ${i}`),i&&i!==n&&this.refBlob(i),n&&i!==n&&this.derefBlob(n),this._toAdd.size+this._toRemove.size>=this._checkpointThreshold&&this._checkpointQueue.size()===0&&this._queueCheckpoint()}resetCheckpoint(){for(let[t,n]of this._checkpointBlobNames)n>0?this._toAdd.set(t,n):this._toRemove.delete(t)||this._logger.warn(`blob with 0 references was not found in toRemove: ${t}`);for(let t of this._toRemove)this._logger.warn(`blob in toRemove was not found in checkpoint: ${t}`);this._toRemove.clear(),this._checkpointId=void 0,this._checkpointBlobNames.clear(),this._onContextChange.fire(this.getContext())}async awaitEmptyQueue(){await this._checkpointQueue.awaitEmpty(void 0,!1)}async _checkpoint(t,n){let{checkpointId:i,addedBlobs:o,deletedBlobs:c}=t;this._logger.debug(`Begin checkpoint of working set into ${i}`),this._logger.debug(`add ${o.length} blobs, remove ${c.length} blobs into ${i}`);let u={newCheckpointId:""};try{u=await this._apiServer.checkpointBlobs(t)}catch(f){let g=f instanceof Error?f.message:`${f}`,b=this._checkpointId?this._checkpointId:"{initial}";Nt.isAPIErrorWithStatus(f,5)?(this._logger.warn(`checkpoint-blobs from ${b} failed with invalid argument: ${g}. Recreating checkpoint.`),this.resetCheckpoint(),this._queueCheckpoint(),n.throwError(f,!1)):(this._logger.error(`checkpoint-blobs failed with error: ${g}.`),n.throwError(f,!1))}if(i!==this._checkpointId)this._logger.warn(`original checkpointId ${i} does not match current checkpointId ${this._checkpointId}. Abandoning new checkpoint.`);else{this._logger.debug(`checkpointId ${i} advanced to ${u.newCheckpointId}`),this._checkpointId=u.newCheckpointId;for(let f of o){let g=this._toAdd.get(f);g===void 0?(this._checkpointBlobNames.set(f,0),this._toRemove.add(f)):(this._checkpointBlobNames.set(f,g),this._toAdd.delete(f))}for(let f of c){let g=this._checkpointBlobNames.get(f);g===void 0?this._logger.warn(`In _checkpoint: deleted blob ${f} not found in checkpoint`):g>0&&this._toAdd.set(f,g),this._checkpointBlobNames.delete(f),this._toRemove.delete(f)}this._onContextChange.fire(this.getContext())}this._toAdd.size+this._toRemove.size>=this._checkpointThreshold&&(this._logger.debug(`starting a new round of checkpointing due to size ${this._toAdd.size} + ${this._toRemove.size}`),this._queueCheckpoint())}_queueCheckpoint(){this._logger.debug("queue checkpoint");let t=Array.from(this._toAdd.keys()).slice(0,this._maxCheckpointBatchSize),n=Array.from(this._toRemove).slice(0,this._maxCheckpointBatchSize),i={checkpointId:this._checkpointId,addedBlobs:t,deletedBlobs:n};this._logger.debug(`queue checkpoint: version: ${i.checkpointId}, add: ${i.addedBlobs.length} blobs, rm: ${i.deletedBlobs.length} blob`),this._checkpointQueue.add(i)}};function ga(e,t,n,i){let o=0;for(let c of n)if(e.log(t,`  ${c}`),o++,i!==void 0&&o>=i){e.log(t,"  ...");break}}var CT=kt(require("crypto")),ma=2023102300,pa=class extends Error{constructor(t){super(`content exceeds maximum size of ${t}`)}},Fl=class{constructor(t){this.maxBlobSize=t}_textEncoder=new TextEncoder;_hash(t,n){let i=CT.createHash("sha256");return i.update(t),i.update(n),i.digest("hex")}calculateOrThrow(t,n,i=!0){if(typeof n=="string"&&(n=this._textEncoder.encode(n)),i&&n.length>this.maxBlobSize)throw new pa(this.maxBlobSize);return this._hash(t,n)}calculate(t,n){try{return this.calculateOrThrow(t,n,!0)}catch{return}}calculateNoThrow(t,n){return this.calculateOrThrow(t,n,!1)}};var kp=class{constructor(t,n){this.maxItems=t;this.maxByteSize=n}items=new Map;byteSize=0;addItem(t,n){let i=this.items.get(t);if(i===void 0){if(this.items.size>=this.maxItems||this.byteSize+n.byteSize>=this.maxByteSize)return!1;this.items.set(t,[n]),this.byteSize+=n.byteSize}else i.push(n);return!0}},Rp=class{constructor(t){this.maxItemCount=t}items=new Map;get full(){return this.items.size>=this.maxItemCount}addItem(t,n){if(this.items.has(t))return!1;this.items.set(t,n)}},Al=class e extends mt{constructor(n,i,o,c,u){super();this.workspaceName=n;this._apiServer=i;this._pathHandler=o;this._pathMap=c;this._logger=Ie(`DiskFileManager[${n}]`),u===void 0?this._probeBatchSize=e.maxProbeBatchSize:(u<e.minProbeBatchSize?this._logger.verbose(`Rejecting requested probe batch size of ${u} (min = ${e.minProbeBatchSize})`):u>e.maxProbeBatchSize&&this._logger.verbose(`Rejecting requested probe batch size of ${u} (max = ${e.maxProbeBatchSize})`),this._probeBatchSize=Math.max(Math.min(u,e.maxProbeBatchSize),e.minProbeBatchSize)),this._toCalculate=new Hn(this._calculate.bind(this)),this.addDisposable(this._toCalculate),this._toProbe=new Hn(this._probe.bind(this)),this.addDisposable(this._toProbe),this._probeBatch=this._newProbeBatch(),this._toUpload=new Hn(this._upload.bind(this)),this.addDisposable(this._toUpload),this._uploadBatch=this._newUploadBatch(),this._probeRetryWaiters=new Hn(this._enqueueForProbe.bind(this)),this.addDisposable(this._probeRetryWaiters),this._probeRetryKicker=new _i(this._probeRetryWaiters,e.probeRetryPeriodMs),this.addDisposable(this._probeRetryKicker),this._probeRetryBackoffWaiters=new Hn(this._enqueueForProbe.bind(this)),this._probeRetryBackoffKicker=new _i(this._probeRetryBackoffWaiters,e.probeRetryBackoffPeriodMs),this.addDisposable(this._probeRetryBackoffKicker)}static minProbeBatchSize=1;static maxProbeBatchSize=1e3;static maxUploadBatchBlobCount=128;static maxUploadBatchByteSize=1e6;static probeRetryPeriodMs=3*1e3;static probeBackoffAfterMs=60*1e3;static probeRetryBackoffPeriodMs=60*1e3;_notAPlainFile="Not a file";_fileNotAccessible="File not readable";_fileNotText="Binary file";_fileUploadFailure="Upload failed";_onDidChangeInProgressItemCountEmitter=new De;onDidChangeInProgressItemCount=this._onDidChangeInProgressItemCountEmitter.event;_onQuiescedEmitter=new De;_onQuiesced=this._onQuiescedEmitter.event;_textDecoder=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});_toCalculate;_toProbe;_probeBatch;_probeBatchSize;_probeRetryWaiters;_probeRetryKicker;_probeRetryBackoffWaiters;_probeRetryBackoffKicker;_toUpload;_uploadBatch;_itemsInFlight=new Map;_seq=1e3;metrics=new Zo("File metrics");_logger;_stopping=!1;_pathsAccepted=this.metrics.counterMetric("paths accepted");_pathsNotAccessible=this.metrics.counterMetric("paths not accessible");_nonFiles=this.metrics.counterMetric("not plain files");_largeFiles=this.metrics.counterMetric("large files");_blobNameCalculationFails=this.metrics.counterMetric("blob name calculation fails");_encodingErrors=this.metrics.counterMetric("encoding errors");_mtimeCacheHits=this.metrics.counterMetric("mtime cache hits");_mtimeCacheMisses=this.metrics.counterMetric("mtime cache misses");_probeBatches=this.metrics.counterMetric("probe batches");_blobNamesProbed=this.metrics.counterMetric("blob names probed");_filesRead=this.metrics.counterMetric("files read");_blobsUploaded=this.metrics.counterMetric("blobs uploaded");_ingestPathMs=this.metrics.timingMetric("ingestPath");_probeMs=this.metrics.timingMetric("probe");_statMs=this.metrics.timingMetric("stat");_readMs=this.metrics.timingMetric("read");_uploadMs=this.metrics.timingMetric("upload");stop(){this.dispose()}dispose(){this._stopping=!0,super.dispose()}get probeBatchSize(){return this._probeBatchSize}get itemsInFlight(){return this._itemsInFlight.size}ingestPath(n,i){this._ingestPathMs.start(),!this._stopping&&(i=vT(i),this._enqueueForCalculate(n,i),this._ingestPathMs.stop())}async awaitQuiesced(){if(!(this._stopping||this._itemsInFlight.size===0))return oa(this._onQuiesced)}_nextSeq(){return this._seq++}_makeAbsPath(n,i){let o=this._pathMap.getRepoRoot(n);if(o!==void 0)return tt(o,i)}_fileTooLargeString(n){return`File too large (${n} > ${this._pathHandler.maxBlobSize})`}_getMtime(n,i,o,c){this._statMs.start();let u=this._pathHandler.classifyPath(n);switch(this._statMs.stop(),u.type){case"inaccessible":this._pathsNotAccessible.increment(),this._pathMapInvalidate(i,o,c,this._fileNotAccessible);return;case"not a file":this._nonFiles.increment(),this._pathMapInvalidate(i,o,c,this._notAPlainFile);return;case"large file":this._largeFiles.increment(),this._pathMapInvalidate(i,o,c,this._fileTooLargeString(u.size));return;case"accepted":return u.mtime}}async _readAndValidate(n,i,o,c){this._readMs.start();let u=await this._pathHandler.readText(n);switch(this._readMs.stop(),this._filesRead.increment(),u.type){case"inaccessible":this._pathsNotAccessible.increment(),this._pathMapInvalidate(i,o,c,this._fileNotAccessible);return;case"large file":this._largeFiles.increment(),this._pathMapInvalidate(i,o,c,this._fileTooLargeString(u.size));return;case"binary":this._pathMapInvalidate(i,o,c,this._fileNotText);return;case"text":return u.contents}}_calculateBlobName(n,i,o,c){try{return this._pathHandler.calculateBlobName(n,i)}catch(u){if(u instanceof pa){this._largeFiles.increment();let f=this._fileTooLargeString(i.length);this._pathMapInvalidate(o,n,c,f)}else this._blobNameCalculationFails.increment(),this._pathMapInvalidate(o,n,c,Ee(u));return}}async _calculate(n){if(n===void 0)return;let[i,[o,c]]=n;if(!this._pathMapVerify(o,c,i))return;let u=this._makeAbsPath(o,c);if(u===void 0){this._inflightItemRemove(i);return}let f=this._getMtime(u,o,c,i);if(f===void 0)return;let g,b=this._pathMap.getBlobInfo(o,c,f);if(b!==void 0){this._mtimeCacheHits.increment();let[k,I]=b;if(I>0){this._pathMapUpdate(o,c,i,k,f);return}g=k}else{let k=await this._readAndValidate(u,o,c,i);if(k===void 0||(this._mtimeCacheMisses.increment(),g=this._calculateBlobName(c,k,o,i),g===void 0))return}this._pathsAccepted.increment();let x={folderId:o,relPath:c,blobName:g,mtime:f,startTime:Date.now()};this._enqueueForProbeRetry(i,x)}_newProbeBatch(){return new Rp(this._probeBatchSize)}_grabProbeBatch(){if(this._probeBatch.items.size===0)return;let n=this._probeBatch;return this._probeBatch=this._newProbeBatch(),n}async _probe(n){if(n!==void 0){let[u,f]=n;if(!this._pathMapVerify(f.folderId,f.relPath,u)||(this._probeBatch.addItem(u,f),!this._probeBatch.full))return}let i=this._grabProbeBatch();if(i===void 0)return;let o=new Set;for(let[u,f]of i.items)o.add(f.blobName);this._probeBatches.increment(),this._blobNamesProbed.increment(i.items.size),this._logger.verbose(`probe ${o.size} blobs`),this._probeMs.start();let c;try{c=await yr(async()=>this._apiServer.findMissing([...o]),this._logger)}catch{}if(this._probeMs.stop(),c!==void 0){this._logger.verbose(`find-missing reported ${c.unknownBlobNames.length} unknown blob names and ${c.nonindexedBlobNames.length} nonindexed blob names.`),c.unknownBlobNames.length>0&&(this._logger.verbose("unknown blob names:"),ga(this._logger,"verbose",c.unknownBlobNames,5)),c.nonindexedBlobNames.length>0&&(this._logger.verbose("nonindexed blob names:"),ga(this._logger,"verbose",c.nonindexedBlobNames,5));let u=new Set(c.unknownBlobNames),f=new Set(c.nonindexedBlobNames),g=this._beginUploadBatch();for(let[b,x]of i.items)this._pathMapVerify(x.folderId,x.relPath,b)&&(u.has(x.blobName)?this._enqueueForUpload(b,x.folderId,x.relPath,!1):f.has(x.blobName)?this._enqueueForProbeRetry(b,x):this._pathMapUpdate(x.folderId,x.relPath,b,x.blobName,x.mtime));g.dispose()}else for(let[u,f]of i.items)this._enqueueForProbeRetry(u,f)}_newUploadBatch(){return new kp(e.maxUploadBatchBlobCount,e.maxUploadBatchByteSize)}_grabUploadBatch(){if(this._uploadBatch.items.size===0)return;let n=this._uploadBatch;return this._uploadBatch=this._newUploadBatch(),n}async _upload(n){let i;if(n!==void 0){let[f,{seq:g,folderId:b,relPath:x}]=n;if(!this._pathMapVerify(b,x,g))return;let k=this._getMtime(f,b,x,g);if(k===void 0)return;let I=await this._readAndValidate(f,b,x,g);if(I===void 0)return;let M=this._calculateBlobName(x,I,b,g);if(M===void 0)return;let N;try{N=this._textDecoder.decode(I)}catch(W){this._pathMapInvalidate(b,x,g,Ee(W)),this._encodingErrors.increment();return}let B={seq:g,folderId:b,pathName:x,text:N,blobName:M,mtime:k,byteSize:I.length,metadata:[]};if(this._uploadBatch.addItem(M,B))return;i=B}let o=this._grabUploadBatch();if(o===void 0)return;i!==void 0&&this._uploadBatch.addItem(i.blobName,i),this._logger.verbose(`upload ${o.items.size} blobs`);let c=new Array;for(let[f,g]of o.items)c.push(g[0]);this._uploadMs.start();let u=await this._uploadBlobBatch(c);this._uploadMs.stop(),this._blobsUploaded.increment(u.size);for(let[f,g]of o.items){let b=u.get(f);if(b===void 0)for(let x of g)this._pathMapInvalidate(x.folderId,x.pathName,x.seq,this._fileUploadFailure);else for(let x of g){let k={folderId:x.folderId,relPath:x.pathName,blobName:b,mtime:x.mtime,startTime:Date.now()};this._enqueueForProbeRetry(x.seq,k)}}}async _uploadBlobBatch(n){this._logger.verbose(`upload begin: ${n.length} blobs`);for(let c of n)this._logger.verbose(`    - ${c.folderId}:${c.pathName}; expected blob name ${c.blobName}`);let i;try{i=await yr(async()=>await this._apiServer.batchUpload(n),this._logger)}catch(c){this._logger.error(`batch upload failed: ${Ee(c)}`)}let o=new Map;if(i!==void 0)for(let c=0;c<i.blobNames.length;c++)o.set(n[c].blobName,i.blobNames[c]);return await this._uploadBlobsSequentially(n,i?.blobNames.length??0,o),o}async _uploadBlobsSequentially(n,i,o){for(let c=i;c<n.length;c++){let u=n[c];try{this._logger.verbose(`sequential upload of ${u.pathName} -> ${u.blobName}`);let f=await yr(async()=>this._apiServer.memorize(u.pathName,u.text,u.blobName,[]),this._logger);o.set(u.blobName,f.blobName)}catch{}}}_inflightItemAdd(n,i,o){this._itemsInFlight.set(n,[i,o])}_inflightItemRemove(n){this._itemsInFlight.delete(n),this._onDidChangeInProgressItemCountEmitter.fire(this._itemsInFlight.size),this._itemsInFlight.size===0&&(this._logger.verbose("inflight items signaling empty"),this._onQuiescedEmitter.fire())}_pathMapVerify(n,i,o){if(!this._pathMap.shouldTrack(n,i))return this._inflightItemRemove(o),!1;let c=this._pathMap.getContentSeq(n,i);return c!==void 0&&c>=o?(this._inflightItemRemove(o),!1):!0}_pathMapUpdate(n,i,o,c,u){this._inflightItemRemove(o),this._pathMap.update(n,i,o,c,u)}_pathMapInvalidate(n,i,o,c){this._logger.verbose(`path map invalidate: ${n}:${i} (${c})`),this._pathMap.markUntrackable(n,i,o,c),this._inflightItemRemove(o),this._pathMap.markUntrackable(n,i,o,c)}_enqueueForCalculate(n,i){let o=this._nextSeq();this._inflightItemAdd(o,n,i),this._toCalculate.insert(o,[n,i])?this._toCalculate.kick():this._inflightItemRemove(o)}_enqueueForProbe(n){if(n===void 0)this._toProbe.kick();else{let[i,o]=n;this._logger.verbose(`probe enqueue ${o.blobName} -> ${i}, ${o.folderId}:${o.relPath}`),this._toProbe.insert(i,o)}return Promise.resolve()}_beginUploadBatch(){return new Or(()=>this._toUpload.kick())}_enqueueForUpload(n,i,o,c=!0){this._logger.verbose(`upload enqueue ${i}:${o} -> ${n}`);let u=this._makeAbsPath(i,o);if(u===void 0){this._inflightItemRemove(n);return}let f=this._toUpload.get(u);if(f!==void 0){let g=f.seq;if(g>n)this._inflightItemRemove(g);else if(g<n){this._inflightItemRemove(n);return}}this._toUpload.insert(u,{seq:n,folderId:i,relPath:o},!0),c&&this._toUpload.kick()}_enqueueForProbeRetry(n,i){Date.now()-i.startTime<e.probeBackoffAfterMs?(this._logger.verbose(`probe-retry enqueue ${i.blobName} -> ${n}, ${i.folderId}:${i.relPath}`),this._probeRetryWaiters.insert(n,i)):(this._logger.verbose(`probe-retry enqueue backoff ${i.blobName} -> ${n}, ${i.folderId}:${i.relPath}`),this._probeRetryBackoffWaiters.insert(n,i))}};var Wr=class{static cacheFileName="mtime-cache.json";static tmpFileName="mtime-cache.json.tmp"},Tp=class{constructor(t=ma){this.namingVersion=t}entries=new Array};function z2(e){if(!(e.mtime===void 0||typeof e.mtime!="number"||!e.mtime)&&!(e.name===void 0||typeof e.name!="string"||!e.name))return{mtime:e.mtime,name:e.name}}function H2(e){return tt(e,Wr.cacheFileName)}function Nl(e){let t=H2(e);return VR(t)}async function RT(e,t){let n=tt(e,Wr.cacheFileName),i=tt(t,Wr.cacheFileName);await ta(t),await jg(n,i)}async function TT(e,t){let n=new Map,i=Ie(`MtimeCache[${e}]`),o=tt(t,Wr.cacheFileName);i.info(`reading blob name cache from ${o}`);try{let c=0,u=await Vo(o),f=JSON.parse(u);if(f.namingVersion===void 0||f.namingVersion!==ma)i.info(`blob naming version ${f.namingVersion} !== ${ma}`);else if(Array.isArray(f.entries))for(let[g,b]of f.entries){let x=z2(b);x!==void 0&&(n.set(g,{mtime:x.mtime,name:x.name}),c++)}i.info(`read ${c} entries from ${o}`)}catch(c){let u=Ee(c);c instanceof Error&&"code"in c&&c.code==="ENOENT"?i.info(`no blob name cache found at ${o} (probably new source folder); error = ${u}`):i.error(`failed to read blob name cache ${o}: ${u}`)}return n}var Ml=class extends Wr{constructor(n,i){super();this._name=n;this._cacheDirName=i;this._cacheFileName=tt(this._cacheDirName,Wr.cacheFileName),this._tmpFileName=tt(this._cacheDirName,Wr.tmpFileName)}_cacheFileName;_tmpFileName;_logger=Ie("MTimeCacheWriter");get cacheFileName(){return this._cacheFileName}async write(n){this._logger.debug(`persisting to ${this._cacheFileName}`);let i=new Tp;for(let[o,c,u]of n)i.entries.push([o,{mtime:c,name:u}]);await ta(this._cacheDirName),await Yu(this._tmpFileName,JSON.stringify(i,void 0,4)),await jg(this._tmpFileName,this._cacheFileName),this._logger.debug(`persisted ${i.entries.length} entries at naming version ${ma} to ${this._cacheFileName}`)}};var DT=require("node:buffer");var ql=class{constructor(t,n){this._fileReader=n;this._blobNameCalculator=new Fl(t)}_blobNameCalculator;get maxBlobSize(){return this._blobNameCalculator.maxBlobSize}classifyPath(t){let n=this._fileReader.stat(t);return n?n.type!=="File"?{type:"not a file",mtime:n.mtime}:n.size>this._blobNameCalculator.maxBlobSize?{type:"large file",mtime:n.mtime,size:n.size}:{type:"accepted",size:n.size,mtime:n.mtime}:{type:"inaccessible"}}async readText(t){let n;try{if(n=await this._fileReader.read(t),n===void 0)return{type:"inaccessible"}}catch{return{type:"inaccessible"}}return(0,DT.isUtf8)(n)?n.length>this._blobNameCalculator.maxBlobSize?{type:"large file",size:n.length}:{type:"text",contents:n}:{type:"binary"}}calculateBlobName(t,n){return this._blobNameCalculator.calculateOrThrow(t,n)}};var sr=class e{constructor(t,n){this.rootPath=t;this.relPath=n}static from(t){return new e(t.rootPath,t.relPath)}get absPath(){return tt(this.rootPath,this.relPath)}equals(t){return e.equals(this,t)}static equals(t,n){if(t===n)return!0;if(t==null||n==null)return!1;let i=ET(t)?tt(t.rootPath,t.relPath):t.fsPath,o=ET(n)?tt(n.rootPath,n.relPath):n.fsPath;return i===o}};function ET(e){return e!=null&&typeof e=="object"&&("rootPath"in e||"relPath"in e)}var Ll=class{_nextFolderId=100;_sourceFolders=new Map;_blobNameChangedEmitter=new De;_nextEntryTS=1e3;_logger=Ie("PathMap");constructor(){}dispose(){for(let[t,n]of this._sourceFolders)n.dispose()}get nextEntryTS(){return this._nextEntryTS}get onDidChangeBlobName(){return this._blobNameChangedEmitter.event}onDidChangePathStatus(t){return this._sourceFolders.get(t)?.onDidChangePathStatus}openSourceFolder(t,n){for(let[u,f]of this._sourceFolders){if(_l(f.folderRoot,t))throw new Error(`Source folder ${t} is already open`);if(or(t,f.folderRoot))throw new Error(`Source folder ${t} contains ${f.folderRoot}`);if(or(f.folderRoot,t))throw new Error(`Source folder ${f.folderRoot} contains ${t}`)}let i=this._nextFolderId++,o=new Dp(t,n);this._sourceFolders.set(i,o);let c=o.onDidChangeBlobName(this._handleBlobNameChangeEvent.bind(this));return o.addDisposable(c),this._logger.info(`Opened source folder ${t} with id ${i}`),i}closeSourceFolder(t){let n=this._sourceFolders.get(t);if(n===void 0)return;n.clear();let i=n.folderRoot;this._sourceFolders.delete(t),n.dispose(),this._logger.info(`Closed source folder ${i} with id ${t}`)}_handleBlobNameChangeEvent(t){this._blobNameChangedEmitter.fire(t)}getRepoRoot(t){return this._sourceFolders.get(t)?.repoRoot}hasFile(t,n){return this._sourceFolders.get(t)?.hasFile(n)??!1}getBlobName(t,n){return this._sourceFolders.get(t)?.getBlobName(n)}getBlobInfo(t,n,i){return this._sourceFolders.get(t)?.getBlobInfo(n,i)}getAnyPathName(t){for(let n of this._sourceFolders.values()){let i=n.getPathName(t);if(i!==void 0)return this._makeQualifiedPathName(n,i)}}getAllPathNames(t){let n=new Array;for(let i of this._sourceFolders.values()){let o=i.getPathName(t);o!==void 0&&n.push(new sr(i.repoRoot,o))}return n}getUniquePathCount(t){let n=0;for(let i of this._sourceFolders.values())i.getPathName(t)!==void 0&&n++;return n}getAllQualifiedPathNames(t){return this.getAllQualifiedPathInfos(t).map(n=>n.qualifiedPathName)}getAllQualifiedPathInfos(t){let n=new Array;for(let i of this._sourceFolders.values()){let o=i.getPathInfo(t);if(o!==void 0){let[c,u]=o;n.push({qualifiedPathName:new sr(i.repoRoot,t),fileType:c,isAccepted:u.accepted})}}return n}getAllPathInfo(t){let n=new Array;for(let i of this._sourceFolders.values()){let o=i.getPathName(t);o!==void 0&&n.push([i.folderRoot,i.repoRoot,o])}return n}getPathInfo(t,n){return this._sourceFolders.get(t)?.getPathInfo(n)}reportMissing(t){for(let n of this._sourceFolders.values()){let i=n.reportMissing(t);if(i!==void 0)return this._makeQualifiedPathName(n,i)}}insert(t,n,i,o){let c=this._nextEntryTS++;this._sourceFolders.get(t)?.insert(n,c,i,o)}remove(t,n){this._sourceFolders.get(t)?.remove(n)}shouldTrack(t,n){return this._sourceFolders.get(t)?.shouldTrack(n)??!1}getContentSeq(t,n){return this._sourceFolders.get(t)?.getContentSeq(n)}update(t,n,i,o,c){this._sourceFolders.get(t)?.update(n,i,o,c)}markUntrackable(t,n,i,o){this._sourceFolders.get(t)?.markUntrackable(n,i,o)}purge(t,n){this._sourceFolders.get(t)?.purge(n)}*pathsWithBlobNames(){for(let[t,n]of this._sourceFolders)for(let[i,o,c]of n.pathsWithBlobNames())yield[t,n.repoRoot,i,o,c]}*pathsInFolder(t){let n=this._sourceFolders.get(t);n!==void 0&&(yield*n.allPaths())}enablePersist(t,n,i){this._sourceFolders.get(t)?.enablePersist(n,i)}_makeQualifiedPathName(t,n){return new sr(t.repoRoot,n)}trackedFileCount(t){return this._sourceFolders.get(t)?.trackedFileCount??0}getFolderIds(){return Array.from(this._sourceFolders.keys())}},Dp=class extends mt{constructor(n,i){super();this.folderRoot=n;this.repoRoot=i}static defaultPersistThreshold=100;_allPathNames=new Map;_trackableFilePaths=new Set;_blobNameToPathName=new Map;_persistState=void 0;_pathStatusChangedEmitter=new De;_blobNameChangedEmitter=new De;get onDidChangePathStatus(){return this._pathStatusChangedEmitter.event}get onDidChangeBlobName(){return this._blobNameChangedEmitter.event}get trackedFileCount(){return this._trackableFilePaths.size}shouldTrack(n){let i=this._allPathNames.get(n);return i===void 0?!1:i.fileType==="File"&&i.pathAcceptance.accepted}getContentSeq(n){return this._allPathNames.get(n)?.fileInfo?.contentSeq}insert(n,i,o,c){let u=this._allPathNames.get(n),f=u===void 0||u.fileType!==o||u.pathAcceptance.format()!==c.format();if(u===void 0)u={entryTS:i,fileType:o,pathAcceptance:c},this._allPathNames.set(n,u);else{let g=u.fileInfo;u.entryTS=i,u.fileType=o,u.pathAcceptance=c,c.accepted||(u.fileInfo=void 0,g?.trackable&&(this._blobNameToPathName.delete(g.blobName),this._publishBlobNameChange(n,g.blobName,void 0),this._markDirty()))}u.fileType==="File"&&u.pathAcceptance.accepted&&u.fileInfo?.trackable!==!1?this._trackableFilePaths.add(n):this._trackableFilePaths.delete(n),f&&this._pathStatusChangedEmitter.fire({relPath:n})}remove(n){let i=this._allPathNames.get(n);if(i!==void 0){if(this._allPathNames.delete(n),this._trackableFilePaths.delete(n),i.fileInfo!==void 0&&i.fileInfo.trackable){let o=i.fileInfo.blobName;this._blobNameToPathName.delete(o),this._publishBlobNameChange(n,o,void 0),this._markDirty()}this._pathStatusChangedEmitter.fire({relPath:n})}}clear(){for(let[n,i]of this._allPathNames)i.fileInfo!==void 0&&i.fileInfo.trackable&&this._publishBlobNameChange(n,i.fileInfo.blobName,void 0);this._allPathNames.clear(),this._trackableFilePaths.clear(),this._blobNameToPathName.clear(),this._markDirty()}update(n,i,o,c){let u=this._allPathNames.get(n);if(u===void 0||u.fileType!=="File"||!u.pathAcceptance.accepted||u.fileInfo!==void 0&&u.fileInfo.contentSeq>i)return;let f=u.fileInfo===void 0?!0:u.fileInfo.trackable,g;u.fileInfo?.trackable&&(g=u.fileInfo.blobName),u.fileInfo={trackable:!0,contentSeq:i,blobName:o,mtime:c},this._trackableFilePaths.add(n),o!==g&&(g!==void 0&&this._blobNameToPathName.delete(g),this._blobNameToPathName.set(o,n),this._publishBlobNameChange(n,g,o),this._markDirty()),(!f||g===void 0)&&this._pathStatusChangedEmitter.fire({relPath:n})}markUntrackable(n,i,o){let c=this._allPathNames.get(n);if(c===void 0||c.fileType!=="File"||!c.pathAcceptance.accepted||c.fileInfo!==void 0&&c.fileInfo.contentSeq>i)return;let u=c.fileInfo;c.fileInfo={trackable:!1,contentSeq:i,reason:o},this._trackableFilePaths.delete(n);let f=!1;if(u===void 0)f=!0;else if(u.trackable===!0){f=!0;let g=u.blobName;this._blobNameToPathName.delete(g),this._publishBlobNameChange(n,g,void 0),this._markDirty()}else f=o!==u.reason;f&&this._pathStatusChangedEmitter.fire({relPath:n})}_makeAbsPath(n){return tt(this.repoRoot,n)}_publishBlobNameChange(n,i,o){i!==o&&this._blobNameChangedEmitter.fire({absPath:this._makeAbsPath(n),prevBlobName:i,newBlobName:o})}purge(n){let i=new Array;for(let[o,c]of this._allPathNames)c.entryTS<n&&i.push(o);for(let o of i)this.remove(o)}hasFile(n){return this._trackableFilePaths.has(n)}getBlobName(n){let i=this._allPathNames.get(n);if(i?.fileInfo?.trackable)return i.fileInfo?.blobName}getBlobInfo(n,i){let o=this._allPathNames.get(n);if(o?.fileInfo?.trackable&&o.fileInfo.mtime===i)return[o.fileInfo.blobName,o.fileInfo.contentSeq]}getPathName(n){return this._blobNameToPathName.get(n)}getPathInfo(n){let i=this._allPathNames.get(n);if(i!==void 0)return[i.fileType,i.pathAcceptance]}reportMissing(n){let i=this._blobNameToPathName.get(n);if(i===void 0)return;let o=this._allPathNames.get(i);if(o?.fileInfo?.trackable)return o.fileInfo.contentSeq=0,i}*pathsWithBlobNames(){for(let[n,i]of this._allPathNames){let o=i.fileInfo;o?.trackable&&(yield[n,o.mtime,o.blobName,o.contentSeq])}}*allPaths(){for(let[n,i]of this._allPathNames){let o=i.pathAcceptance.accepted,c=!1,u=i.pathAcceptance.format();o&&(i.fileType==="Other"?(o=!1,u="Not a file"):i.fileInfo!==void 0&&(i.fileInfo?.trackable===!0?c=!0:(o=!1,u=i.fileInfo.reason))),yield[n,i.fileType,o,c,u]}}_markDirty(){this._persistState!==void 0&&this._persistState.dirtyCount++}enablePersist(n,i){if(this._persistState)return;this._persistState={dirtyCount:this._trackableFilePaths.size,lastPersistDirtyCount:0,mtimeCacheWriter:n,persisting:!1},this._maybePersist();let o=setInterval(()=>void this._maybePersist(),i);this.addDisposable({dispose:()=>clearInterval(o)})}async _maybePersist(){if(!(this._persistState===void 0||this._persistState.persisting)){this._persistState.persisting=!0;try{this._persistState.dirtyCount>this._persistState.lastPersistDirtyCount&&await this._persist(this._persistState)}finally{this._persistState.persisting=!1}}}async _persist(n){let i=function*(u){for(let[f,g]of u){let b=g.fileInfo;b?.trackable&&(yield[f,b.mtime,b.blobName])}},o=n.dirtyCount;await n.mtimeCacheWriter.write(i(this._allPathNames.entries())),n.lastPersistDirtyCount=o}};var Ol=require("fs");var Ep=class{_onDidCreate=new De;_onDidChange=new De;_onDidDelete=new De;logger=Ie("FileSystemWatcher");workspaceFolder;watcher;onDidCreate=this._onDidCreate.event;onDidChange=this._onDidChange.event;onDidDelete=this._onDidDelete.event;constructor(t){this.workspaceFolder=t;let n={recursive:!0,persistent:!0};this.watcher=(0,Ol.watch)(t,n,(i,o)=>this.listener(i,o)),this.logger.info(`Filesystem watcher initialized with directory ${t}`)}listener(t,n){if(n===null)return;this.logger.info(`Received raw filesystem event: ${t} ${n}`);let i=tt(this.workspaceFolder,n);t==="rename"?this.statThenFire(i):t==="change"&&this.fireEvent(i,"change")}statThenFire(t){(0,Ol.existsSync)(t)?this.fireEvent(t,"create"):this.fireEvent(t,"delete")}fireEvent(t,n){this.logger.info(`Firing filesystem event: ${n} ${t}`),n==="create"?this._onDidCreate.fire(Ze.file(t)):n==="change"?this._onDidChange.fire(Ze.file(t)):n==="delete"&&this._onDidDelete.fire(Ze.file(t))}dispose(){this.watcher.close()}};function IT(e){return new Ep(e)}var Ip=class extends mi{constructor(n){super();this.reason=n}format(){return this.reason}},Bl=class extends mt{constructor(n,i,o,c,u){super();this.folderName=n;this.folderRoot=i;this.repoRoot=o;this._pathFilter=c;this._workspaceFolder=u;this._logger=Ie(`PathNotifier[${i}]`)}_pathFoundEmitter=new De;_pathCreatedEmitter=new De;_pathChangedEmitter=new De;_pathDeletedEmitter=new De;_logger;_filesystemWatcherCreated=!1;_stopping=!1;_deletedPaths=void 0;get onDidFindPath(){return this._pathFoundEmitter.event}get onDidCreatePath(){return this._pathCreatedEmitter.event}get onDidChangePath(){return this._pathChangedEmitter.event}get onDidDeletePath(){return this._pathDeletedEmitter.event}dispose(){this._stopping=!0,super.dispose()}async enumeratePaths(){if(this._stopping)return;this._deletedPaths=new Set,this._workspaceFolder!==void 0&&!this._filesystemWatcherCreated&&(this._createFilesystemWatcher(this._workspaceFolder),this._filesystemWatcherCreated=!0);let n=new es(this.folderName,Ze.file(this.folderRoot),Ze.file(this.repoRoot),this._pathFilter);for await(let[o,c,u,f]of n){if(this._stopping)return;this._pathFoundEmitter.fire({relPath:c,fileType:u,acceptance:f})}if(this._stopping)return;let i=this._deletedPaths;this._deletedPaths=void 0;for(let o of i)this._pathDeletedEmitter.fire(o);return n.stats}_handlePathChanged(n,i){let o=this._getRelPath(n);if(o===void 0)return;let c,u;try{c=Zs(Yt(n)).type,u=this._pathFilter.getPathInfo(o,c)}catch(g){c="Other",u=new Ip(Ee(g))}let f=i?"created":"changed";this._logger.verbose(`${c} ${f}: ${o}, acceptance = ${u.format()}`),this._deletedPaths?.delete(o),i?this._pathCreatedEmitter.fire({relPath:o,fileType:c,acceptance:u}):this._pathChangedEmitter.fire({relPath:o,fileType:c,acceptance:u})}_handlePathDeleted(n){let i=this._getRelPath(n);i!==void 0&&(this._logger.verbose(`Path deleted: ${i}`),this._deletedPaths!==void 0?this._deletedPaths?.add(i):this._pathDeletedEmitter.fire(i))}_getRelPath(n){if(this._stopping)return;let i=Ko(n);if(i!==void 0)return la(this.repoRoot,i)}_createFilesystemWatcher(n){let i=IT(n.uri.fsPath);this.addDisposables(i,i.onDidCreate(o=>this._handlePathChanged(o,!0)),i.onDidChange(o=>this._handlePathChanged(o,!1)),i.onDidDelete(o=>this._handlePathDeleted(o)))}};async function FT(e,t,n,i){let o=Yt(e),c=Yt(t),u=new Array;u.push(o);let f=new Array,g=200,b=Date.now(),x;for(;(x=u.pop())!==void 0&&(i===void 0||f.length<i);){Date.now()-b>=g&&(await new Promise(B=>setTimeout(B,0)),b=Date.now());let I=$r(c,x),M=n.makeLocalPathFilter(I),N=ea(x);for(let[B,W]of N){if(Date.now()-b>=g&&(await new Promise(P=>setTimeout(P,0)),b=Date.now()),B==="."||B==="..")continue;let D=tt(I,B,W==="Directory");M.acceptsPath(D,W)&&(W==="File"?f.push(D):W==="Directory"&&u.push(tt(x,B)))}}return Promise.resolve(f)}var Ul=class e{constructor(t,n,i,o){this._apiServer=t;this._pathHandler=n;this._fileExtensions=i;this._maxTrackedFiles=o}static verifyBatchSize=1e3;async describe(t,n,i){let o=await this._getAllPathNames(t,n,i);if(o.length>this._maxTrackedFiles)return{trackable:!1};let c=o.length,u=await this._chooseBlobNameSample(n,o);if(u.length===0)return{trackable:!0,trackableFiles:0,uploadedFraction:1};let f=await this._apiServer.findMissing(u),g=u.length,b=Math.min(f.unknownBlobNames.length,g);return{trackable:!0,trackableFiles:c,uploadedFraction:(g-b)/g}}async _getAllPathNames(t,n,i){let o=await Cl(Ze.file(t),Ze.file(n),new Yo(i),this._fileExtensions);return await FT(Ze.file(t),Ze.file(n),o,this._maxTrackedFiles+1)}async _chooseBlobNameSample(t,n){let i=new Array;for(;i.length<e.verifyBatchSize&&n.length>0;){let o=Math.floor(Math.random()*n.length),c=n[o];n[o]=n[n.length-1],n.pop();let u=tt(t,c),f=await this._pathHandler.readText(u);if(f.type!=="text")continue;let g=this._pathHandler.calculateBlobName(c,f.contents);i.push(g)}return i}};var $l=class e extends mt{constructor(n,i){super();this._apiServer=n;this._workspaceManager=i;this._logger=Ie("UnknownBlobHandler"),this._toProbe=new Hn(this._probe.bind(this)),this.addDisposable(this._toProbe),this._probeWaiters=new Hn(this._enqueueForProbe.bind(this)),this.addDisposable(this._probeWaiters),this._probeWaitersKicker=new _i(this._probeWaiters,e.probeRetryWaitMs),this.addDisposable(this._probeWaitersKicker),this._longWaiters=new Hn(this._enqueueForProbe.bind(this)),this.addDisposable(this._longWaiters),this._longWaitersKicker=new _i(this._longWaiters,e.longRetryWaitMs),this.addDisposable(this._longWaitersKicker)}static probeBatchSize=1e3;static probeRetryWaitMs=5*1e3;static probePatienceMs=2*60*1e3;static longRetryWaitMs=60*1e3;_toProbe;_currentBatch=new Map;_probeWaiters;_probeWaitersKicker;_longWaiters;_longWaitersKicker;_logger;enqueue(n){for(let[i,o]of n)this._logger.verbose(`enqueue: ${o.rootPath}:${o.relPath}`),this._toProbe.insert(i,{qualifiedPath:o,startTime:Date.now()});this._toProbe.kick()}_grabCurrentBatch(){if(this._currentBatch.size===0)return;let n=this._currentBatch;return this._currentBatch=new Map,n}async _probe(n){if(n!==void 0){let[u,f]=n;if(this._workspaceManager.getBlobName(f.qualifiedPath)!==u||(this._currentBatch.set(u,f),this._currentBatch.size<e.probeBatchSize))return}let i=this._grabCurrentBatch();if(i===void 0)return;let o=[...i.keys()],c;try{c=await yr(async()=>this._apiServer.findMissing(o),this._logger)}catch{}if(c===void 0)for(let[u,f]of i)this._addRetryWaiter(u,f);else{this._logger.verbose(`find-missing reported ${c.nonindexedBlobNames.length} nonindexed blob names`),c.nonindexedBlobNames.length>0&&ga(this._logger,"verbose",c.nonindexedBlobNames,5);let u=new Set(c.unknownBlobNames),f=new Set(c.nonindexedBlobNames);for(let[g,b]of i)u.has(g)?this._workspaceManager.notifyBlobMissing(b.qualifiedPath,g):f.has(g)&&this._addRetryWaiter(g,b)}}_enqueueForProbe(n){if(n===void 0)this._toProbe.kick();else{let[i,o]=n;this._logger.verbose(`probe enqueue: ${o.qualifiedPath.rootPath}:${o.qualifiedPath.relPath}: ${i}`),this._toProbe.insert(i,o)}return Promise.resolve()}_addRetryWaiter(n,i){Date.now()-i.startTime<e.probePatienceMs?(this._logger.verbose(`retry enqueue: ${i.qualifiedPath.rootPath}:${i.qualifiedPath.relPath}: ${n}`),this._probeWaiters.insert(n,i)):(this._logger.verbose(`long retry enqueue: ${i.qualifiedPath.rootPath}:${i.qualifiedPath.relPath}: ${n}`),this._longWaiters.insert(n,i))}};var ns=class e{constructor(t,n,i,o,c){this.blobs=t;this.recentChunks=n;this.trackedPaths=i;this.lastChatResponse=o;this.blobNames=c}static empty(){return new e({checkpointId:void 0,addedBlobs:[],deletedBlobs:[]},new Array,new Map,void 0,[])}};function qT(e){return Xo(Yt(e))}function AT(e){if(e.scheme==="file")return qT(e)}var Fp=class extends mt{constructor(n,i,o,c,u,f,g,b,x,k,I){super(x,k);this.folderName=n;this.folderRoot=i;this.repoRoot=o;this.workspaceFolder=c;this.vcsDetails=u;this.folderId=f;this.diskFileManager=g;this.cacheDirPath=b;this.logger=I;this._operationQueue=new Tl(async M=>await this._runSerializedOperation(M)),this.addDisposables(this._operationQueue,{dispose:()=>this._disposeTracker()})}_operationQueue;_tracker;_newlyTracked=!1;_initialEnumerationComplete=!1;_initialSyncComplete=!1;_stopped=!1;dispose(){this._stopped=!0,super.dispose()}get stopped(){return this._stopped}get type(){return this.workspaceFolder===void 0?1:0}_disposeTracker(){this._tracker?.dispose(),this._tracker=void 0}setTracker(n){if(this.stopped)throw new Error("Source folder has been disposed");this._disposeTracker(),this._tracker=n}get tracker(){return this._tracker}get initialEnumerationComplete(){return this._initialEnumerationComplete}setInitialEnumerationComplete(){this._initialEnumerationComplete=!0}get initialSyncComplete(){return this._initialSyncComplete}setInitialSyncComplete(){this._initialSyncComplete=!0}relativePathName(n){if(or(this.folderRoot,n))return ua(this.repoRoot,n)}acceptsPath(n){return this._tracker===void 0?!1:this._tracker.pathFilter.acceptsPath(n)}async enqueueSerializedOperation(n){this._operationQueue.insert(n),await this._operationQueue.kick()}async _runSerializedOperation(n){n!==void 0&&(!this._initialEnumerationComplete||this._stopped||await n())}},Ap=class extends mt{constructor(n,i,o){super(o);this.pathFilter=n;this.pathNotifier=i}};var V2=new Set(["home directory","too large"]),G2=new Set(["nested"]);function ba(e){return V2.has(e)}function MT(e){return G2.has(e)}function ar(e){return e.containingFolderRoot!==void 0?"nested":e.isHomeDir?"home directory":e.folderQualification!==void 0&&!e.folderQualification.trackable?"too large":e.syncingPermission==="denied"?"permission denied":e.syncingPermission==="granted"?"trackable":e.folderQualification===void 0?"qualifying":"permission needed"}var Wl=class e extends mt{constructor(n,i,o,c,u,f,g=new Array,b){super();this._storageUriProvider=n;this._apiServer=i;this._featureFlagManager=o;this._completionServer=c;this._maxUploadSizeBytes=u;this._workspaceFolders=f;this._enableFileLimitsForSyncingPermission=this._featureFlagManager.currentFlags.enableFileLimitsForSyncingPermission,this._maxTrackableFiles=this._featureFlagManager.currentFlags.maxTrackableFileCount,this._maxTrackableFilesWithoutPermission=Math.min(this._featureFlagManager.currentFlags.maxTrackableFileCountWithoutPermission,this._maxTrackableFiles);let x=Math.min(this._featureFlagManager.currentFlags.minUploadedPercentageWithoutPermission,100);if(this._verifyFolderIsSourceRepo=this._featureFlagManager.currentFlags.verifyFolderIsSourceRepo,this._minUploadedFractionWithoutPermission=x*.01,this._refuseToSyncHomeDirectories=this._featureFlagManager.currentFlags.refuseToSyncHomeDirectories,this._useCheckpointManagerContext=!0,this._validateCheckpointManagerContext=!1,this._folderEnumeratedEmitter=this.addDisposable(new De),this._folderSyncedEmitter=this.addDisposable(new De),this._syncingProgressEmitter=this.addDisposable(new De),this._syncingStateEmitter=this.addDisposable(new De),this._sourceFoldersChangedEmitter=this.addDisposable(new De),this._sourceFolderContentsChangedEmitter=this.addDisposable(new De),this._sourceFolderContentsChangedEmitter=this.addDisposable(new De),this._featureFlagManager.currentFlags.bypassLanguageFilter)this._fileExtensions=void 0;else{let I=new Set;for(let M of g)for(let N of M.extensions)I.add(N);this._fileExtensions=I}this._pathHandler=new ql(this._maxUploadSizeBytes,oT()),this._pathMap=this.addDisposable(new Ll);let k=b?.blobsCheckpointThreshold;this._blobsCheckpointManager=this.addDisposable(new Il(this._apiServer,this._featureFlagManager,this._pathMap.onDidChangeBlobName,k)),this._unknownBlobHandler=this.addDisposable(new $l(this._apiServer,this)),this._sourceFolderReconciler=this.addDisposable(new Rl(()=>this._reconcileSourceFolders())),this._sourceFolderDescriber=new Ul(this._apiServer,this._pathHandler,this._fileExtensions,this._maxTrackableFiles),this.addDisposable(new Or(()=>this._disposeSourceFolders())),this._registerInitialSourceFolders(),this._awaitInitialSourceFolders()}static augmentRootName=".augmentroot";static ignoreSources(n){return[new da(".gitignore"),new xl(n),new da(".augmentignore")]}static pathMapPersistFrequencyMs=6e4;static defaultPathAccept=new bi;static _textEncoder=new TextEncoder;_initialSourceFolders=new Set;_registeredSourceFolders=new Map;_trackedSourceFolders=new Map;_fileExtensions;_pathMap;_sequenceGenerator=new kl;_pathHandler;_blobsCheckpointManager;_unknownBlobHandler;_sourceFolderDescriber;_logger=Ie("WorkspaceManager");_folderEnumeratedEmitter;_folderSyncedEmitter;_syncingProgressEmitter;_syncingPermissionInitialized=!1;_sourceFolderReconciler;_syncingStateEmitter;_sourceFoldersChangedEmitter;_sourceFolderContentsChangedEmitter;_lastChatResponse=void 0;_enableFileLimitsForSyncingPermission;_maxTrackableFiles;_maxTrackableFilesWithoutPermission;_verifyFolderIsSourceRepo;_minUploadedFractionWithoutPermission;_refuseToSyncHomeDirectories;_useCheckpointManagerContext;_validateCheckpointManagerContext;_stopping=!1;dispose(){this._stopping=!0,super.dispose()}get verifyFolderIsSourceRepo(){return this._verifyFolderIsSourceRepo}get minUploadedFractionWithoutPermission(){return this._minUploadedFractionWithoutPermission}get refuseToSyncHomeDirectories(){return this._refuseToSyncHomeDirectories}get initialFoldersEnumerated(){return Array.from(this._initialSourceFolders).every(n=>{let i=this._registeredSourceFolders.get(n);if(i===void 0)return!0;let o=ar(i);return ba(o)||MT(o)||o==="permission denied"?!0:this._trackedSourceFolders.get(n)?.sourceFolder?.initialEnumerationComplete})}async awaitInitialFoldersEnumerated(){for(;!this.initialFoldersEnumerated;)await oa(this._folderEnumeratedEmitter.event)}get initialFoldersSynced(){return Array.from(this._initialSourceFolders).every(n=>{let i=this._registeredSourceFolders.get(n);if(i===void 0)return!0;let o=ar(i);return ba(o)||MT(o)||o==="permission denied"?!0:this._trackedSourceFolders.get(n)?.sourceFolder?.initialSyncComplete})}async awaitInitialFoldersSynced(){for(;!this.initialFoldersSynced;)await oa(this._folderSyncedEmitter.event)}get syncingEnabledState(){if(!this._syncingPermissionInitialized)return"initializing";let n=0;for(let[i,o]of this._registeredSourceFolders){let c=ar(o);if(ba(c)||c==="permission denied")return"disabled";c==="permission needed"&&n++}return n>0?"partial":"enabled"}get onDidChangeSyncingState(){return this._syncingStateEmitter.event}get completionServer(){return this._completionServer}_disposeSourceFolders(){this._registeredSourceFolders.forEach(n=>{n.cancel?.cancel(),n.cancel?.dispose(),n.cancel=void 0}),this._trackedSourceFolders.forEach(n=>n.sourceFolder?.dispose()),this._trackedSourceFolders.clear()}getSyncingProgress(){let n=new Array;return this._trackedSourceFolders.forEach((i,o)=>{n.push(this._getSyncingProgress(o,i.sourceFolder))}),n}_getSyncingProgress(n,i){let o=i?.initialEnumerationComplete?{newlyTracked:i._newlyTracked,trackedFiles:this._pathMap.trackedFileCount(i.folderId),backlogSize:i.diskFileManager.itemsInFlight}:void 0;return{folderRoot:n,progress:o}}_isHomeDir(n){return this._featureFlagManager.currentFlags.refuseToSyncHomeDirectories?PT(n):!1}_registerInitialSourceFolders(){let n=new Array;this._workspaceFolders?.forEach(o=>{let c=AT(o.uri);c!==void 0&&this._mtimeCacheExists(c)&&n.push(c)});let i=new Array;this._workspaceFolders?.forEach(o=>{let c=o.name,u=AT(o.uri);if(u===void 0)return;let f="granted";this._logger.info(`Adding workspace folder ${c}; folderRoot = ${u}; syncingPermission = ${f}`),this._initialSourceFolders.add(u),this._registeredSourceFolders.set(u,{folderName:c,isHomeDir:this._isHomeDir(u),folderType:0,syncingPermission:f,workspaceFolder:o}),f==="granted"&&i.push(u)})}_mtimeCacheExists(n){let i=this._computeCacheDirPath(n);return Nl(i)}async _awaitInitialSourceFolders(){let n=Date.now();this._kickSourceFolderReconciler(),await this.awaitInitialFoldersSynced(),this._reportWorkspaceStartup(Date.now()-n),this._folderSyncedEmitter.fire()}enableSyncing(){this._logger.info("Enabling syncing for all trackable source folders");let n=new Array;this._registeredSourceFolders.forEach((i,o)=>{let c=ar(i);ba(c)||c==="qualifying"||(i.syncingPermission="granted",n.push(o))}),this._kickSourceFolderReconciler()}disableSyncing(){this._logger.info("Disabling syncing for all trackable source folders"),this._registeredSourceFolders.forEach(n=>{let i=ar(n);ba(i)||(n.syncingPermission="denied")}),this._kickSourceFolderReconciler()}requalifyLargeFolders(){this._registeredSourceFolders.forEach(n=>{n.folderQualification=void 0}),this._kickSourceFolderReconciler()}_kickSourceFolderReconciler(){let n=new Set;for(let[i,o]of this._registeredSourceFolders)if(ar(o)==="trackable"){for(let[u,f]of this._registeredSourceFolders)if(ar(f)==="trackable"&&i!==u&&or(u,i)){n.add(i);break}}for(let[i,o]of this._registeredSourceFolders){if(!n.has(i)){o.containingFolderRoot=void 0;continue}for(let c of this._registeredSourceFolders.keys())if(!(i===c||n.has(c))&&or(c,i)){o.containingFolderRoot!==c&&this._logger.info(`Source folder ${i} will not be tracked. Containing folder: ${c}`),o.containingFolderRoot=c;break}}for(let[i,o]of this._registeredSourceFolders)ar(o)==="qualifying"&&o.cancel===void 0&&this._qualifySourceFolder(i,o);this._syncingStateEmitter.fire(this.syncingEnabledState),this._sourceFoldersChangedEmitter.fire(),this._sourceFolderReconciler.kick()}async _qualifySourceFolder(n,i){let[o,c]=await this._findRepoRoot(n),u,f;if(this._enableFileLimitsForSyncingPermission){f="full",this._logger.info(`Beginning ${f} qualification of source folder ${n}`);let b=new Br;if(i.cancel=b,u=await this._sourceFolderDescriber.describe(n,o,e.ignoreSources(n)),b.token.isCancellationRequested){this._logger.info(`Cancelled qualification of source folder ${n}`);return}i.cancel=void 0,b.dispose()}else f="phony",this._logger.info(`Beginning ${f} qualification of source folder ${n} per feature flag`),u={trackable:!0,trackableFiles:0,uploadedFraction:1};let g={...u,repoRoot:o,isRepo:c};i.folderQualification=g,g.trackable?(this._logger.info(`Finished ${f} qualification of source folder ${n}: trackable files: ${g.trackableFiles}, uploaded fraction: ${g.uploadedFraction}, is repo: ${g.isRepo}`),g.trackableFiles>this._maxTrackableFilesWithoutPermission?this._logger.info(`Requesting syncing permission because source folder has more than ${this._maxTrackableFilesWithoutPermission} files`):this._verifyFolderIsSourceRepo&&!g.isRepo?this._logger.info("Requesting syncing permission because source folder does not appear to be a source repo"):g.uploadedFraction<this._minUploadedFractionWithoutPermission?this._logger.info(`Requesting syncing permission because source folder has less than ${this._minUploadedFractionWithoutPermission*100}% of files uploaded`):i.syncingPermission="granted"):this._logger.info(`Finished ${f} qualification of source folder ${n}: folder not trackable; too large`),this._kickSourceFolderReconciler()}async _reconcileSourceFolders(){let n=this.syncingEnabledState==="disabled",i=new Map;for(let[c,u]of this._trackedSourceFolders){let f=this._registeredSourceFolders.get(c),g;if(f===void 0)g="source folder has been removed";else if(n)g="syncing is disabled";else if(f.containingFolderRoot!==void 0)g=`source folder is nested inside folder ${f.containingFolderRoot}`;else if(f.isHomeDir)g="source folder is a home directory";else if(f.folderQualification?.trackable===!1)g="source folder is too large";else{let b=ar(f);b==="permission denied"?g="syncing permission denied for this source folder":b==="permission needed"?g="syncing permission not yet granted for this source folder":b==="qualifying"&&(g="source folder is being qualified")}g!==void 0&&i.set(c,[u,g])}let o=new Map;for(let[c,u]of this._registeredSourceFolders){if(ar(u)!=="trackable")continue;let g=this._trackedSourceFolders.get(c);g===void 0&&(g={folderName:u.folderName,folderSpec:(0,NT.cloneDeep)(u),cancel:new Br,sourceFolder:void 0,logger:Ie(`WorkspaceManager[${u.folderName}]`)},o.set(c,g))}for(let[c,[u,f]]of i)u.logger.info(`Stop tracking: ${f}`),this._trackedSourceFolders.delete(c),this._stopTracking(u);for(let[c,u]of o)u.logger.info("Start tracking"),this._trackedSourceFolders.set(c,u),this._startTracking(c,u);return Promise.resolve()}async _startTracking(n,i){let o=new wl("Startup metrics"),c=i.cancel,u=await this._createSourceFolder(n,i,c.token);if(c.token.isCancellationRequested){i.logger.info("Cancelled in-progress creation of source folder"),u?.dispose();return}if(o.charge("create SourceFolder"),c.dispose(),u===void 0||this._stopping){i.logger.info("Stopped tracking source folder");return}i.sourceFolder=u;let f=i.folderName,g=u.folderId,b=await TT(f,u.cacheDirPath);if(o.charge("read MtimeCache"),u.stopped){i.logger.info("Stopped tracking source folder");return}for(let[k,I]of b)this._pathMap.insert(g,k,"File",e.defaultPathAccept),this._pathMap.update(g,k,0,I.name,I.mtime);o.charge("pre-populate PathMap");let x=new ir;try{u._newlyTracked=b.size===0,x.add({dispose:()=>u._newlyTracked=!1});let k=await this._refreshSourceFolder(u,o);if(k===void 0||u.stopped)return;o.charge("enumerate"),u.setInitialEnumerationComplete(),this._folderEnumeratedEmitter.fire();let I=this._pathMap.onDidChangePathStatus(g);if(I===void 0)return;u.addDisposable(I(N=>{this._sourceFolderContentsChangedEmitter.fire(n)}),!0),this._sourceFoldersChangedEmitter.fire(),await u.diskFileManager.awaitQuiesced(),u.setInitialSyncComplete(),this._folderSyncedEmitter.fire(),o?.charge("await DiskFileManager quiesced");let M=new Ml(f,u.cacheDirPath);this._pathMap.enablePersist(g,M,e.pathMapPersistFrequencyMs),o.charge("enable persist"),this._reportSourceFolderStartup(i.logger,u,o,k)}finally{x.dispose()}}async _createSourceFolder(n,i,o){let c=i.folderName,u=new ir,f=new ir,g=i.folderSpec.folderType===1?void 0:i.folderSpec.workspaceFolder,[b,x]=await this._findRepoRoot(n);if(o.isCancellationRequested)return;let k=this._pathMap.openSourceFolder(n,b);u.add(new Or(()=>this._pathMap.closeSourceFolder(k)));let I=new Al(c,this._apiServer,this._pathHandler,this._pathMap);u.add(I);let M=void 0,N=await this._migrateMtimeCache(n,i);return new Fp(c,n,b,g,M,k,I,N,u,f,i.logger)}async _migrateMtimeCache(n,i){let o=this._computeCacheDirPath(n);if(Nl(o))return o;let c=this._computeCacheDirPath(i.folderName);if(!Nl(c))return o;try{i.logger.info(`Migrating mtime cache for ${i.folderName} from "${c}" to "${o}"`),await RT(c,o)}catch(u){i.logger.error(`Failed to migrate mtime cache for ${i.folderName} from "${c}" to "${o}": ${Ee(u)}`)}return o}_computeCacheDirPath(n){return e.computeCacheDirPath(n,this._storageUriProvider.storageUri)}static computeCacheDirPath(n,i){let o=Yt(i),c=aT(e._textEncoder.encode(n));return tt(o,c)}async refreshSourceFolders(){this.requalifyLargeFolders();let n=Array.from(this._trackedSourceFolders.values()).map(i=>i.sourceFolder).filter(i=>i!==void 0).map(i=>i.enqueueSerializedOperation(async()=>{await this._refreshSourceFolder(i)}));try{await Promise.allSettled(n)}catch(i){this._logger.info(`One or more source folders failed to refresh: ${Ee(i)}`)}}async _refreshSourceFolder(n,i){n.logger.debug(`Refreshing source folder ${n.folderName}`);let o=await this._createSourceFolderTracker(n,i);try{n.setTracker(o)}catch(u){n.logger.info(`Failed to install SourceFolderTracker for ${n.folderName}: ${Ee(u)}`),o.dispose();return}return await this._enumerateSourceFolder(n,i)}async _enumerateSourceFolder(n,i){let o=n.tracker;if(o===void 0)return;let c=this._pathMap.nextEntryTS,u=await o.pathNotifier.enumeratePaths();if(!n.stopped)return i?.charge("enumerate paths"),this._pathMap.purge(n.folderId,c),i?.charge("purge stale PathMap entries"),u}async _createSourceFolderTracker(n,i){let o=new ir,c=await Cl(Ze.file(n.folderRoot),Ze.file(n.repoRoot),new Yo(e.ignoreSources(n.folderRoot)),this._fileExtensions);i?.charge("create PathFilter");let u=this._createPathNotifier(n,c);return o.add(u),i?.charge("create PathNotifier"),new Ap(c,u,o)}_createPathNotifier(n,i){let o=new Bl(n.folderName,n.folderRoot,n.repoRoot,i,n.workspaceFolder);return o.addDisposables(o.onDidFindPath(c=>{this._handlePathFound(n,c.relPath,c.fileType,c.acceptance)}),o.onDidCreatePath(c=>{this._handlePathCreated(n,c.relPath,c.fileType,c.acceptance)}),o.onDidChangePath(c=>{c.fileType==="File"&&this._handleFileChanged(n,c.relPath,c.acceptance)}),o.onDidDeletePath(c=>{this._handlePathDeleted(n,c)})),o}async _findRepoRoot(n){let i;return i=await vl(n,e.augmentRootName),i===void 0&&(i=(await ST(n))?.root),i!==void 0?[qT(i),!0]:[n,!1]}_stopTracking(n){if(n.sourceFolder===void 0){let i=n.cancel;i.cancel(),i.dispose(),n.logger.info("Cancelled in-progress tracking of source folder")}else{let i=n.sourceFolder;n.sourceFolder=void 0,i.dispose(),n.logger.info("Stopped tracking source folder")}this._folderSyncedEmitter.fire(),this._folderEnumeratedEmitter.fire()}translateRange(n,i,o){let c=this._resolveAbsPath(n.absPath);if(c===void 0)return;let[u,f]=c,g={folderId:u.folderId,relPath:f,beginOffset:i,endOffset:o}}getContext(){if(this._pathMap===void 0)return ns.empty();let n={folderMap:new Map,recentChunks:[]},i=new Set,o=new Map,c=new Map;for(let[M,N]of n.folderMap){let B=this._pathMap.getRepoRoot(M);B!==void 0&&c.set(B,N);for(let[W,X]of N){i.add(X);let D=this._pathMap.getBlobName(M,W);D!==void 0&&D!==X&&o.set(D,(o.get(D)??0)+1)}}let u=new Set;for(let[M,N]of o)i.has(M)||N===this._pathMap.getUniquePathCount(M)&&u.add(M);let f=new Array;for(let M of n.recentChunks);let g=this._blobsCheckpointManager,b=g!==void 0&&this._useCheckpointManagerContext,x=b&&this._validateCheckpointManagerContext,k;if(!b||x){let M=new Set(i);for(let[W,X,D,P,U]of this._pathMap.pathsWithBlobNames())n.folderMap.get(W)?.has(D)||M.add(U);let N=Array.from(M),B=this._blobNamesToBlobs(N);if(k=new ns(B,f,c,this._lastChatResponse,N),!b)return k}let I=g.getContextAdjusted(i,u);return k!==void 0&&(g.validateMatching(k.blobs,I)||this._logger.error("blob context mismatch")),new ns(I,f,c,this._lastChatResponse)}getContextWithBlobNames(){let n=this.getContext();return n.blobNames!==void 0?n:{...n,blobNames:this._blobsCheckpointManager.expandBlobs(n.blobs)}}recordChatReponse(n){this._lastChatResponse={seq:this._sequenceGenerator.next(),text:n}}_blobNamesToBlobs(n){return this._blobsCheckpointManager===void 0?{checkpointId:void 0,addedBlobs:n,deletedBlobs:[]}:this._blobsCheckpointManager.blobsPayload(n)}handleUnknownBlobs(n,i){if(i.length===0)return;let o=new Set(i),c=new Array;for(let[u,f]of n.trackedPaths)if(u!==void 0)for(let[g,b]of f)o.has(b)&&(c.push([b,new sr(u,g)]),o.delete(b));for(let u of o){let f=this._pathMap.getAnyPathName(u);f!==void 0&&c.push([u,f])}this._unknownBlobHandler.enqueue(c)}handleUnknownCheckpoint(n,i){this._logger.info(`received checkpoint not found for request id ${n}`),this._blobsCheckpointManager.resetCheckpoint(),this._blobsCheckpointManager.updateBlob("")}notifyBlobMissing(n,i){let o=this._pathMap.reportMissing(i);if(o!==void 0){let u=this._getSourceFolder(o.rootPath);if(u!==void 0){u.diskFileManager.ingestPath(u.folderId,n.relPath);return}}this._getSourceFolder(n.rootPath)}_getSourceFolder(n){return this._trackedSourceFolders.get(n)?.sourceFolder}resolvePathName(n){let i=typeof n=="string"?n:Ko(n);if(i===void 0)return;let o=this._resolveAbsPath(i);if(o===void 0)return;let[c,u]=o;return new sr(c.repoRoot,u)}getFolderRoot(n){let i=typeof n=="string"?n:Ko(n);if(i===void 0)return;let o=this._resolveAbsPath(i);if(o===void 0)return;let[c,u]=o;return c.folderRoot}safeResolvePathName(n){let i=typeof n=="string"?n:Ko(n);if(i===void 0)return;let o=this._resolveAbsPath(i);if(o===void 0)return new sr("",i);let[c,u]=o;return new sr(c.repoRoot,u)}_resolveAbsPath(n){for(let[i,o]of this._trackedSourceFolders){if(o.sourceFolder===void 0)continue;let c=o.sourceFolder.relativePathName(n);if(c!==void 0)return[o.sourceFolder,c]}}hasFile(n){let[i,o]=this._resolveAbsPath(n.absPath)??[void 0,void 0];return i===void 0||o===void 0?!1:this._pathMap.hasFile(i.folderId,n.relPath)}getBlobName(n){let[i,o]=this._resolveAbsPath(n.absPath)??[void 0,void 0];if(!(i===void 0||o===void 0))return this._pathMap.getBlobName(i.folderId,n.relPath)}getAllPathNames(n){return this._pathMap.getAllPathNames(n)}getAllQualifiedPathInfos(n){return this._pathMap.getAllQualifiedPathInfos(n)}getAllQualifiedPathNames(n){return this._pathMap.getAllQualifiedPathNames(n)}getAllPathInfo(n){return this._pathMap.getAllPathInfo(n)}_handlePathFound(n,i,o,c){let u=n.folderId;this._pathMap.insert(u,i,o,c),o==="File"&&c.accepted&&n.diskFileManager.ingestPath(u,i)}_handlePathCreated(n,i,o,c){let u=n.folderId;if(this._pathMap.insert(u,i,o,c),!!c.accepted){if(o==="File")n.diskFileManager.ingestPath(n.folderId,i),this._emitFileNotification(u,i,"disk");else if(o==="Directory"){let f=n.tracker?.pathFilter;if(f===void 0)return;n.enqueueSerializedOperation(()=>this._handleDirectoryCreated(n,i,f))}}}_handleFileChanged(n,i,o){let c=n.folderId;this._pathMap.insert(c,i,"File",o),o.accepted&&(n.diskFileManager.ingestPath(c,i),this._emitFileNotification(c,i,"disk"))}_handlePathDeleted(n,i){let o=n.folderId,c=this._pathMap.getPathInfo(o,i);if(c===void 0)return;this._deletePath(n.folderId,i);let[u,f]=c;f.accepted&&(u==="Directory"?this._handleDirectoryRemoved(n,i):u==="File"&&this._emitFileNotification(o,i,"disk"))}_deletePath(n,i){this._pathMap.remove(n,i)}async _handleDirectoryCreated(n,i,o){n.logger.info(`Directory created: ${i}`);let c=Ze.file(n.repoRoot),u=new es(n.folderName,Tt.joinPath(c,i),c,o);for await(let[f,g,b,x]of u)this._handlePathFound(n,g,b,x)}_handleDirectoryRemoved(n,i){n.logger.info(`Directory removed: ${i}`);let o=n.folderId,c=new Array;for(let[u]of this._pathMap.pathsInFolder(o))la(i,u)!==void 0&&c.push(u);for(let u of c)this._deletePath(o,u)}_emitFileNotification(n,i,o){}_reportSourceFolderStartup(n,i,o,c){let u=i.diskFileManager.metrics;n.info("Tracking enabled"),n.info(c.format()),n.info(u.format()),n.info(o.format())}_reportWorkspaceStartup(n){this._logger.info(`Workspace startup complete in ${n} ms`)}trackedSourceFolderNames(){return Array.from(this._registeredSourceFolders).filter(([n,i])=>ar(i)==="trackable").map(([n,i])=>({folderRoot:n}))}unitTestOnlyGetRepoRoot(n){let i=this._trackedSourceFolders.get(n);if(i!==void 0)return i.sourceFolder?.repoRoot}unitTestOnlySourceFolderBacklog(n){let i=this._trackedSourceFolders.get(n);if(i===void 0)return;let o=i.sourceFolder;if(o!==void 0&&o.initialEnumerationComplete)return o.diskFileManager.itemsInFlight}};var jl=class extends mt{constructor(n,i,o,c,u,f,g){super();this._extensionContext=n;this._augmentConfigListener=i;this._apiServer=o;this._auth=c;this._featureFlagManager=u;this._workspaceFolders=f;this._initialModelConfig=g;this._completionAcceptanceReporter=new gl(o),this._clientMetricsReporter=new hl(o),this._completionsModel=new dl(this,this._augmentConfigListener,this._clientMetricsReporter)}_completionServer=void 0;workspaceManager=void 0;_enableCancel;_modelInfo;get modelInfo(){return this._modelInfo}_completionAcceptanceReporter;_clientMetricsReporter;enabled=!1;disposeOnDisable=[];_completionsModel;_logger=Ie("AugmentExtension");get completionServer(){return this._completionServer}get completionsModel(){return this._completionsModel}get completionReporter(){return this._completionAcceptanceReporter}get enableInProgress(){return this._enableCancel!==void 0}get ready(){return this.enabled&&!this.enableInProgress}async enable(){if(this.enabled||this.enableInProgress)return;let n=new Br;this._enableCancel=n;try{await this._enable(n.token)}catch(i){if(this._logger.info(`Unable to enable extension: ${Ee(i)}`),process.env.JEST_WORKER_ID)throw i}finally{n.dispose(),this._enableCancel=void 0}}async _enable(n){(0,LT.assert)(!this.enabled);let i=this._workspaceFolders.map((u,f)=>({uri:Ze.parse(u.uri),name:u.name,index:f}));if(this._auth.useOAuth){if(!await this._auth.getSession())return}else{if(!this._augmentConfigListener.config.apiToken){this._logger.warn("No API token is configured");return}if(!this._augmentConfigListener.config.completionURL){this._logger.warn("No completion URL is configured");return}}let o;try{if(o=this._initialModelConfig,o.models.length===0)throw new Do;let u=o.defaultModel;if(this._modelInfo=o.models.find(f=>[f.name,f.internalName].includes(u)||f.name===(0,OT.createHash)("sha256").update(u).digest("hex")),this._modelInfo===void 0)throw new To(u)}catch(u){let f=Ee(u);throw this._logger.error(`Failed to get model config: ${f}`),u}this._completionServer=new ul(this._apiServer,this._modelInfo.completionTimeoutMs,this._modelInfo.suggestedPrefixCharCount,this._modelInfo.suggestedSuffixCharCount);let c=this._featureFlagManager.currentFlags.maxUploadSizeBytes;this.workspaceManager=new Wl(this._extensionContext,this._apiServer,this._featureFlagManager,this._completionServer,c,i),this.disposeOnDisable.push(this.workspaceManager);{let u=[this._completionAcceptanceReporter];for(let f of u)f.enableUpload(),this.disposeOnDisable.push(f)}}updateModelInfo(n){if(!this._modelInfo)throw new Error("Model info not set");n.suggestedPrefixCharCount!==void 0&&(this._modelInfo.suggestedPrefixCharCount=n.suggestedPrefixCharCount),n.suggestedSuffixCharCount!==void 0&&(this._modelInfo.suggestedSuffixCharCount=n.suggestedSuffixCharCount),this._modelInfo.completionTimeoutMs=n.completionTimeoutMs}disable(){for(this.enabled=!1;this.disposeOnDisable.length;)this.disposeOnDisable.pop().dispose();this.reset()}reset(){this._enableCancel?.cancel(),this._enableCancel?.dispose(),this._enableCancel=void 0,this.workspaceManager?.dispose(),this.workspaceManager=void 0}};function BT(e){let t=e.get("sessionId");return(t===void 0||!rg(t))&&(t=Ns(),e.update("sessionId",t)),t}var En=(0,Ne.createConnection)(),Mp=new Ne.TextDocuments(hc),jT,Q2=".config/augment/api_token",J2="https://staging-shard-0.api.augmentcode.com/",X2={clientID:"augment-vim-extension",url:process.env.AUGMENT_AUTH_URL??"https://auth.augmentcode.com"},K2=process.env.TEST_TMPDIR?_a.join(process.env.TEST_TMPDIR,"data"):process.env.XDG_DATA_HOME||_a.join(WT.default.homedir(),".local","share"),zT=_a.join(K2,"vim-augment"),UT=_a.join(process.env.HOME||"~",Q2),Y2=Hl.existsSync(UT)?Hl.readFileSync(UT,"utf8").trim():"",me=Ie("server"),rs,Np,cr,$T=new tl,zt,zl=new ol;async function HT(e,t){if(await cr.initState(),!cr.isLoggedIn)throw new Error("Not logged in. Please login first.");let n=await rs.getModelConfig();if(n.models.length===0)throw new Do;me.debug(`Received modelConfig: ${JSON.stringify(n,null,2)}`);let i=n.defaultModel,o=n.models.find(c=>c.name===n.defaultModel);if(o===void 0)throw new To(i);return o.name=i,$T.update(n.featureFlags),new jl(e,zl,rs,cr,$T,t,n)}En.onInitialize(async e=>{me.info("Initializing Language Server"),jT=e;let t=e.initializationOptions?.editor??"unknown",n=e.initializationOptions?.pluginVersion??"unknown",i=e.initializationOptions?.vimVersion??"unknown",o=`Augment.vim/${n} ${t}/${i}`;me.info(`User agent: ${o}`);let c=e.workspaceFolders??[];me.info(`Roots: ${JSON.stringify(c)}`);for(let k of c)me.info(`Root name, URI: ${k.name}, ${k.uri}`);let u;try{u=new na(Ze.file(zT))}catch(k){throw me.error(`Error initializing server context storage: ${Ee(k)}`),k}cr=new sl(u,zl);let f=new pl(u),g=BT(f);me.info(`Session ID: ${g}`);let b={...zl.config,oauth:X2,apiToken:Y2};rs=new rl(zl,cr,g,o,global.fetch),Np=new cl(u,b,rs,cr);let x={capabilities:{completionProvider:{resolveProvider:!1},textDocumentSync:Ne.TextDocumentSyncKind.Incremental}};try{zt=await HT(u,c),await zt.enable(),me.info("Initialized completion server")}catch(k){me.error(`Error initializing completion server: ${Ee(k)}`)}return x});En.onInitialized(()=>{me.info("Language server initialized")});En.onCompletion(async e=>{let t=Mp.get(e.textDocument.uri);if(!t)return me.warn(`Not tracking the document ${e.textDocument.uri}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,`Not tracking the document ${e.textDocument.uri}`);if(zt?.completionServer===void 0)return me.warn("Completion server is not initialized."),new Ne.ResponseError(Ne.ErrorCodes.InternalError,"Completion server is not initialized");if(!cr.isLoggedIn)return me.warn("Not logged in. Please login first."),new Ne.ResponseError(Ne.ErrorCodes.InternalError,"Not logged in. Please login first.");try{let n=new Zu(t),i=await zt.completionsModel.generateCompletion(n,e.position);return me.info(`Completion: ${i?.requestId}`),me.debug(`Completion result: ${JSON.stringify(i)}`),[{label:i?.requestId??"",insertText:i?.completions[0]?.completionText??""}]}catch(n){return me.error(`Error getting completion: ${Ee(n)}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,`Error getting completion: ${Ee(n)}`)}});En.onRequest("augment/login",async()=>{try{return cr.isLoggedIn?(me.info("Already logged in"),{loggedIn:!0,url:""}):(me.info("Logging in..."),{loggedIn:!1,url:await Np.startFlow()})}catch(e){let t=e instanceof Error?e.stack:"No stack trace available",n=Ee(e);return me.error(`Error handling augment/login: ${n}`),me.error(`Stack trace: ${t}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,"Failed to process request. See server log for details.")}});En.onRequest("augment/logout",async()=>{try{return await cr.removeSession(),zt?.disable(),me.info("Logged out."),{success:!0}}catch(e){let t=e instanceof Error?e.stack:"No stack trace available",n=Ee(e);return me.error(`Error handling augment/logout: ${n}`),me.error(`Stack trace: ${t}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,"Failed to process request. See server log for details.")}});En.onRequest("augment/token",async e=>{try{if(await Np.handleAuthJson(e.code),!zt){let t=new na(Ze.file(zT)),n=jT?.workspaceFolders??[];zt=await HT(t,n),me.info("Initialized completion server")}return await zt.enable(),me.info("Logged in."),{success:!0}}catch(t){let n=t instanceof Error?t.stack:"No stack trace available",i=Ee(t);return me.error(`Error creating completion server: ${i}`),me.error(`Stack trace: ${n}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,"Failed to process request. See server log for details.")}});En.onRequest("augment/status",()=>{let e=!!cr.isLoggedIn,t;if(zt?.workspaceManager){let n=0,i=0,o=zt.workspaceManager.getSyncingProgress();for(let c of o)c.progress&&c.progress.newlyTracked&&(me.info(`New folder ${c.folderRoot} sync progress: tracked=${c.progress.trackedFiles}, backlog=${c.progress.backlogSize}`),n+=c.progress.trackedFiles,i+=c.progress.trackedFiles-c.progress.backlogSize);t=n>0?Math.floor(i/n*100):100}return{loggedIn:e,syncPercentage:t}});En.onRequest("augment/chat",async e=>{let t=e.textDocumentPosition.textDocument.uri,n=Mp.get(t);if(n||me.warn(`Not tracking the document ${t}`),zt?.completionServer===void 0)return me.warn("Completion server is not initialized."),new Ne.ResponseError(Ne.ErrorCodes.InternalError,"Completion server is not initialized");if(!cr.isLoggedIn)return me.warn("Not logged in. Please login first."),new Ne.ResponseError(Ne.ErrorCodes.InternalError,"Not logged in. Please login first.");let i=e.textDocumentPosition.position,o=n?.offsetAt(i)||0,c=n?.getText()||"",u=o,f=c.length-o,g=c.slice(Math.max(0,o-u),o),b=c.slice(o,o+f),x=zt.completionServer.createRequestId();me.info(`Chat (${x}) requested`),n&&(me.debug(`Document URI: ${n.uri}`),me.debug(`Language ID: ${n.languageId}`)),e.selectedText!==void 0&&me.debug(`Selected text: ${e.selectedText}`);let I=zt?.workspaceManager?.getContext()?.blobs??{checkpointId:void 0,addedBlobs:[],deletedBlobs:[]};if(e.partialResultToken===void 0){me.info("No partialResultToken provided. Sending full response.");try{let N=await rs.chat(x,e.message,[],I,[],[],void 0,[],void 0,e.selectedText,g,b,n?.uri,n?.languageId);return me.debug(`Chat result: ${JSON.stringify(N)}`),zt.workspaceManager?.recordChatReponse(N.text),{label:x,text:N.text}}catch(N){return me.error(`Error getting chat: ${Ee(N)}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,`Error getting chat: ${Ee(N)}`)}}me.debug(`PartialResultToken provided: ${e.partialResultToken}`);let M="";try{let N=await rs.chatStream(x,e.message,[],I,[],[],void 0,[],void 0,e.selectedText,g,b,n?.uri,n?.languageId,void 0,!1,void 0,void 0);for await(let B of N)me.debug(`Chat chunk for ${x}: ${B.text}`),await En.sendNotification("augment/chatChunk",{token:e.partialResultToken,value:{label:x,text:B.text}}),M+=B.text}catch(N){return me.error(`Error streaming chat: ${Ee(N)}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,`Error streaming chat: ${Ee(N)}`)}return zt.workspaceManager?.recordChatReponse(M),{label:x,text:""}});var Z2="https://api.github.com/repos/augmentcode/augment.vim/tags?per_page=1";En.onRequest("augment/pluginVersion",async()=>{try{let e=await fetch(Z2);if(!e.ok)return me.error(`Failed to fetch version: ${e.statusText}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,`Failed to fetch plugin version: ${e.statusText}`);let t=await e.json();return Array.isArray(t)&&t.length>0&&typeof t[0].name=="string"?{version:t[0].name}:new Ne.ResponseError(Ne.ErrorCodes.InternalError,"No version tags found for plugin")}catch(e){return me.error(`Error fetching version: ${Ee(e)}`),new Ne.ResponseError(Ne.ErrorCodes.InternalError,`Failed to fetch plugin version: ${Ee(e)}`)}});En.onNotification("augment/resolveCompletion",e=>{if(me.info(`Completion (${e.requestId}) resolved with accept=${e.accept}`),zt?.completionReporter===void 0){me.warn("Completion reporter is not yet initialized.");return}zt.completionReporter.reportResolution(e.requestId,Date.now(),Date.now(),e.accept?0:void 0)});Mp.listen(En);En.listen();me.info("Language server started");0&&(module.exports={API_ENDPOINT});
/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
